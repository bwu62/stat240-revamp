<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Data Visualization | STAT 240 Revamp</title>
<meta name="author" content="Bi Cheng Wu, with help from Bret Larget and Cameron Jones">
<meta name="description" content="\(   \def\e{\operatorname{E}}   \def\p{\operatorname{P}}   \def\var{\operatorname{Var}}   \def\sd{\operatorname{SD}}   \def\bin{\operatorname{Bin}}   \def\n{\operatorname{N}}  \)  Descriptive...">
<meta name="generator" content="bookdown 0.45 with bs4_book()">
<meta property="og:title" content="Chapter 6 Data Visualization | STAT 240 Revamp">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bwu62.github.io/stat240-revamp/data-visualization.html">
<meta property="og:description" content="\(   \def\e{\operatorname{E}}   \def\p{\operatorname{P}}   \def\var{\operatorname{Var}}   \def\sd{\operatorname{SD}}   \def\bin{\operatorname{Bin}}   \def\n{\operatorname{N}}  \)  Descriptive...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Data Visualization | STAT 240 Revamp">
<meta name="twitter:description" content="\(   \def\e{\operatorname{E}}   \def\p{\operatorname{P}}   \def\var{\operatorname{Var}}   \def\sd{\operatorname{SD}}   \def\bin{\operatorname{Bin}}   \def\n{\operatorname{N}}  \)  Descriptive...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Roboto_Mono-0.4.10/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.11.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.2/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-E0YDB40HWY"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-E0YDB40HWY');
    </script><link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
<link rel="manifest" href="icons/site.webmanifest">
<link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<!-- https://www.bryanbraun.com/anchorjs/ --><script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script><script>
      // Add anchors on DOMContentLoaded
    document.addEventListener('DOMContentLoaded', function(event) {
      anchors.add('h1');
      anchors.add();
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">STAT 240 Revamp</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome!</a></li>
<li><a class="" href="setup.html"><span class="header-section-number">1</span> Setup</a></li>
<li class="book-part">R Crash Course</li>
<li><a class="" href="rstudio-intro.html"><span class="header-section-number">2</span> Intro to R/Rstudio</a></li>
<li><a class="" href="data-vectors.html"><span class="header-section-number">3</span> Data Vectors</a></li>
<li><a class="" href="data-frames.html"><span class="header-section-number">4</span> Data Frames</a></li>
<li><a class="" href="data-exploration.html">Data Exploration</a></li>
<li><a class="" href="descriptive.html"><span class="header-section-number">5</span> Descriptive Statistics</a></li>
<li><a class="active" href="data-visualization.html"><span class="header-section-number">6</span> Data Visualization</a></li>
<li><a class="" href="data-transformation.html">Data Transformation</a></li>
<li><a class="" href="intro-to-dplyr.html"><span class="header-section-number">7</span> Intro to dplyr</a></li>
<li><a class="" href="advanced-operations.html"><span class="header-section-number">8</span> Advanced Operations</a></li>
<li><a class="" href="data-modeling.html">Data Modeling</a></li>
<li><a class="" href="overview.html"><span class="header-section-number">9</span> Overview</a></li>
<li><a class="" href="intro-to-probability.html"><span class="header-section-number">10</span> Intro to Probability</a></li>
<li><a class="" href="sampling-inference.html"><span class="header-section-number">11</span> Sampling &amp; Inference</a></li>
<li><a class="" href="inference-types.html">Inference Types</a></li>
<li><a class="" href="proportions.html"><span class="header-section-number">12</span> Proportions</a></li>
<li><a class="" href="means.html"><span class="header-section-number">13</span> Means</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">14</span> Regression</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="datasets.html"><span class="header-section-number">A</span> Datasets</a></li>
<li><a class="" href="cheat-sheets.html"><span class="header-section-number">B</span> Cheat Sheets</a></li>
<li><a class="" href="additional-resources.html"><span class="header-section-number">C</span> Additional Resources</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/bwu62/stat240-revamp">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><span style="display:none">
  \(
    \def\e{\operatorname{E}}
    \def\p{\operatorname{P}}
    \def\var{\operatorname{Var}}
    \def\sd{\operatorname{SD}}
    \def\bin{\operatorname{Bin}}
    \def\n{\operatorname{N}}
  \)
</span>
<div id="data-visualization" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Data Visualization<a class="anchor" aria-label="anchor" href="#data-visualization"><i class="fas fa-link"></i></a>
</h1>
<p>Descriptive statistics are a good place to start, but usually plotting your data visually is the best way to fully understand your dataset down to its core. In this next chapter, we will cover a variety of common plot types that are most useful for exploratory analysis.</p>
<p>When studying each plot type, it’s important to keep the following questions in mind:</p>
<ol style="list-style-type: decimal">
<li>What kind of data is appropriate for this plot?</li>
<li>How to create this plot?</li>
<li>How to interpret this plot?</li>
</ol>
<div id="ggplot2" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> ggplot2<a class="anchor" aria-label="anchor" href="#ggplot2"><i class="fas fa-link"></i></a>
</h2>
<p>We will be making all plots using the <a href="https://ggplot2.tidyverse.org">ggplot2</a> package which is also a core Tidyverse package. It offers a robust syntax for easily creating and modifying plots (<a href="https://rstudio.github.io/cheatsheets/data-visualization.pdf">link to cheat sheet</a>).</p>
<p>When making a ggplot2 plot, it’s important to remember <strong>everything is a layer</strong> that you <strong>add onto the base object using <code>+</code></strong> just like adding numbers. Whether you’re adding a plot, a faceting structure, changing the axes, adding annotations (e.g. title/labels), etc. they’re all layers that are added. This may seem strange at first, but you’ll quickly grasp it in the examples that follow.</p>
<p>Let’s first import the necessary packages. We will need both <code>readr</code> and <code>ggplot2</code> for reading and plotting data. For convenience, I’ll just load all core Tidyverse packages.</p>
<div class="sourceCode" id="cb532"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if you need to, reimport all core tidyverse packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># optional: disable showing col_types by default in readr import functions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>readr.show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># optional: set a prettier theme and colorblind-friendly palette for plots</span></span>
<span><span class="co">#           (also looks better if printed with most printers, even in b/w)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>ggplot2.discrete.fill <span class="op">=</span> \<span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span><span class="va">...</span>, palette <span class="op">=</span> <span class="st">"Set2"</span><span class="op">)</span>,</span>
<span>        ggplot2.discrete.colour <span class="op">=</span> \<span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op">(</span><span class="va">...</span>, palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="palmer-penguins" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Palmer penguins<a class="anchor" aria-label="anchor" href="#palmer-penguins"><i class="fas fa-link"></i></a>
</h2>
<p>To properly demonstrate some of these plots, we need a slightly more feature-rich dataset. Let’s import the <a href="https://allisonhorst.github.io/palmerpenguins">Palmer penguins</a> dataset which is readily usable and has a good set of variables.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Thanks to Hadley Wickham’s excellent &lt;a href="https://r4ds.hadley.nz/data-visualize"&gt;R4DS&lt;/a&gt; for the inspiration!&lt;/p&gt;'><sup>22</sup></a> I’ve removed a few rows with NAs for our convenience, here’s a link to the file: <a href="data/penguins.csv"><code>penguins.csv</code></a>.</p>
<p><a href="https://allisonhorst.github.io/palmerpenguins/articles/art.html"><img src="https://allisonhorst.github.io/palmerpenguins/reference/figures/lter_penguins.png" class="i6"></a></p>
<div class="sourceCode" id="cb533"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load in the penguins dataset</span></span>
<span><span class="co"># (note: a few rows with NAs have been removed for simplicity)</span></span>
<span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://bwu62.github.io/stat240-revamp/data/penguins.csv"</span><span class="op">)</span></span>
<span><span class="co"># print the first few rows of the data frame to check;</span></span>
<span><span class="co"># this data frame is now too wide for our screen,</span></span>
<span><span class="co"># you can see some columns are cut off</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">penguins</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 8
  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Adelie  Torgersen           39.1          18.7               181        3750 male  
2 Adelie  Torgersen           39.5          17.4               186        3800 female
3 Adelie  Torgersen           40.3          18                 195        3250 female
4 Adelie  Torgersen           36.7          19.3               193        3450 female
5 Adelie  Torgersen           39.3          20.6               190        3650 male  
# ℹ 328 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb535"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># let's temporarily increase the width and reprint,</span></span>
<span><span class="co"># so you can see all columns in the data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">92</span><span class="op">)</span></span>
<span><span class="va">penguins</span></span></code></pre></div>
<pre><code># A tibble: 333 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year
   &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007
 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007
 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007
 4 Adelie  Torgersen           36.7          19.3               193        3450 female  2007
 5 Adelie  Torgersen           39.3          20.6               190        3650 male    2007
 6 Adelie  Torgersen           38.9          17.8               181        3625 female  2007
 7 Adelie  Torgersen           39.2          19.6               195        4675 male    2007
 8 Adelie  Torgersen           41.1          17.6               182        3200 female  2007
 9 Adelie  Torgersen           38.6          21.2               191        3800 male    2007
10 Adelie  Torgersen           34.6          21.1               198        4400 male    2007
# ℹ 323 more rows</code></pre>
<div class="sourceCode" id="cb537"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># reset width to its original value</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">85</span><span class="op">)</span></span>
<span><span class="co"># another option is the glimpse() function which prints sideways,</span></span>
<span><span class="co"># avoiding the hidden columns due to insufficient width issue</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre></div>
<pre><code>Rows: 333
Columns: 8
$ species           &lt;chr&gt; "Adelie", "Adelie", "Adelie", "Adelie", "Adelie", "Adelie…
$ island            &lt;chr&gt; "Torgersen", "Torgersen", "Torgersen", "Torgersen", "Torg…
$ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, 36.7, 39.3, 38.9, 39.2, 41.1, 38.6, 34.…
$ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, 19.3, 20.6, 17.8, 19.6, 17.6, 21.2, 21.…
$ flipper_length_mm &lt;dbl&gt; 181, 186, 195, 193, 190, 181, 195, 182, 191, 198, 185, 19…
$ body_mass_g       &lt;dbl&gt; 3750, 3800, 3250, 3450, 3650, 3625, 4675, 3200, 3800, 440…
$ sex               &lt;chr&gt; "male", "female", "female", "female", "male", "female", "…
$ year              &lt;dbl&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 200…</code></pre>
<p>The column variables are intuitively named so you should be able to guess their meaning; see the <a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html"><code>penguins</code></a> help page for more info on the variables as well as papers detailing the data gathering process.</p>
</div>
<div id="one-variable-plots" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> One-variable plots<a class="anchor" aria-label="anchor" href="#one-variable-plots"><i class="fas fa-link"></i></a>
</h2>
<p>Ok, now we’re finally ready to learn some plots. We will start with simple one-variable plots, i.e. plots that <strong>can be made with a single column</strong> in a data frame. Depending on the type of that variable, you may decide to end up choosing between several different plot types. Note these plot types can also all be enhanced to visualize two variables, as we will soon demonstrate.</p>
<div id="histogram" class="section level3" number="6.3.1">
<h3>
<span class="header-section-number">6.3.1</span> Histogram<a class="anchor" aria-label="anchor" href="#histogram"><i class="fas fa-link"></i></a>
</h3>
<p>Histograms are plots where <strong>numeric values are grouped into “bins” (i.e. intervals) and the count of each bin plotted as a bar</strong>. They are extremely effective at visualizing the distribution of a single numeric column, allowing you to easily see the shape, spread, and even skewness of a dataset. Histograms are one of the most common plots for numeric data.</p>
<p>The following code makes a basic histogram in R using ggplot.</p>
<div class="sourceCode" id="cb539"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/histogram-1.svg" width="672" style="display: block; margin: auto;"></div>
<div id="interpretation" class="section level4" number="6.3.1.1">
<h4>
<span class="header-section-number">6.3.1.1</span> Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"><i class="fas fa-link"></i></a>
</h4>
<p>Looking at this plot, we can make a few key observations:</p>
<ul>
<li>The distribution of flipper length is <a href="descriptive.html#modality">bimodal</a>, i.e. there are 2 peaks: around 190mm and 215mm.</li>
<li>The peak around 190mm is higher (i.e. more numerous) than the peak around 215mm, but they have comparable spreads.
<ul>
<li>This can mean either this group of observations is more prominent in the population studied, or was perhaps the result of some kind of selection or sampling bias.</li>
</ul>
</li>
<li>Between the two modes, between 200-205mm, there’s a noticeable “gap” with comparatively much fewer observations.</li>
<li>The vast majority of observations are around 180-220mm, with a few extremes almost as low as 170mm or just slightly above 230mm.</li>
</ul>
</div>
<div id="explanation-of-syntax" class="section level4" number="6.3.1.2">
<h4>
<span class="header-section-number">6.3.1.2</span> Explanation of syntax:<a class="anchor" aria-label="anchor" href="#explanation-of-syntax"><i class="fas fa-link"></i></a>
</h4>
<p>The code may seem strange at first, but here’s a quick explanation:</p>
<ol style="list-style-type: decimal">
<li>The <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> function creates the base “plot object”, kind of like setting up a canvas in preparation for painting. <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> takes 2 arguments in order:
<ol style="list-style-type: lower-roman">
<li>The first argument <code>penguins</code> is the data frame which will be used for the plot. As a general rule, <strong>always put all data you want to plot into a SINGLE data frame</strong> to pass to <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>.</li>
<li>The second argument is an aesthetic mapping. Think of <strong>aesthetics as choosing how to display each column of variables in your data frame</strong>. Here’s a <em>brief</em> list of some common aesthetics you can map:
<ul>
<li>
<code>x</code> controls the horizontal axis,</li>
<li>
<code>y</code> controls the vertical axis,</li>
<li>
<code>color</code> and <code>fill</code> control the point/line/boundary color and inside/fill colors respectively,</li>
<li>
<code>shape</code> and <code>size</code> control point shapes and sizes respectively,</li>
<li>
<code>linetype</code> controls the type of line (i.e. solid, dashed, dotted, etc.)</li>
</ul>
</li>
</ol>
</li>
<li>Once the base plot object is setup with a data frame and aesthetic mapping, you simply need to “add on” a plot layer like <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> that specifies the type of plot you want and it will be drawn!
<ul>
<li>You can also specify the aesthetic mapping in the plot layer (e.g. inside <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code>), which will override the aesthetic mapping that it inherits from the base <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> object. Otherwise, the aesthetic mapping in the base <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> object will be used. For example, these will make the exact same plot:
<ul>
<li><code>ggplot(penguins, aes(x = flipper_length_mm)) + geom_histogram()</code></li>
<li><code>ggplot(penguins) + geom_histogram(aes(x = flipper_length_mm))</code></li>
</ul>
</li>
</ul>
</li>
</ol>
<div class="note">
<p>Due to the slightly unusual nature of this syntax, there are a number of common failure modes we have observed. Make sure you take note of the following:</p>
<ol style="list-style-type: decimal">
<li><p>Plot layers are ALWAYS added with <code>+</code> like numbers. This is just the design of the syntax. Attempting to use anything else will give errors!</p></li>
<li><p>You also MUST execute each layer like a function with <code>()</code>. If you try to just add <code>+ geom_histogram</code> without the <code>()</code>, the layer will not generate correctly and give errors!</p></li>
<li>
<p>If you have many layers, it’s recommended to break them into multiple lines, but each incomplete line MUST have either an unclosed parenthetical <code>(</code> OR end in an unfinished addition <code>+</code>, for example:</p>
<div class="sourceCode" id="cb540"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this is ok; R sees the incomplete lines</span></span>
<span><span class="co"># and continues reading the next line</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>,                       <span class="co"># unclosed ( parenthetical</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>   <span class="co"># unfinished + addition</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb541"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># but this will error, since the first line is NOT incomplete!!</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>Error in `+.gg`:
! Cannot use `+` with a single argument.
ℹ Did you accidentally put `+` on a new line?</code></pre>
</li>
</ol>
<p>Don’t forget if you have an incomplete <code>(</code> somewhere, or didn’t finish a <code>+</code> statement, R will patiently wait for you by replacing the normal <code>&gt;</code> prompt with a <code>+</code> prompt. Finish your line or hit <span class="k">ESC</span> to quit.</p>
</div>
</div>
<div id="adding-aesthetics" class="section level4" number="6.3.1.3">
<h4>
<span class="header-section-number">6.3.1.3</span> Adding aesthetics<a class="anchor" aria-label="anchor" href="#adding-aesthetics"><i class="fas fa-link"></i></a>
</h4>
<p>With ggplot2, you can easily <strong>add additional aesthetics to a plot, turning one-variable plots into two-variable plots</strong>, allowing you to visualize how they vary together. Remember how the histogram shows bimodality? It turns out these represent different species of penguins. Let’s use the <code>fill</code> aesthetic to differentiate between species.</p>
<div class="sourceCode" id="cb543"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/adding-aesthetics-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>By default, ggplot will stack bars with the same position along the horizontal axis. Let’s unstack them by setting <a href="https://ggplot2.tidyverse.org/reference/layer_positions.html"><code>position = "identity"</code></a> and make the bars only 50% opaque by setting <code>alpha = 0.5</code> so we can better see each group. Both these are set in the plot layer <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code>.</p>
<div class="sourceCode" id="cb544"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"identity"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/position-identity-unstack-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>This is already starting to look pretty good! We can now start to easily make a few interesting observations:</p>
<ol style="list-style-type: decimal">
<li>Each species of penguin has a different average<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;I’m being intentionally vague here since we’re not yet doing specific statistical analysis on this data; you can substitute with either mean or median to your preference.&lt;/p&gt;"><sup>23</sup></a> flipper length, with Gentoo penguins having the largest, Adelie penguins having the smallest, and Chinstrap penguins somewhere in between.</li>
<li>There seems to be far more Adelie and Gentoo penguins in the dataset than Chinstrap penguins. We can investigate this further later.</li>
</ol>
<div class="note">
<p>Aesthetics should always be mapped to <strong>columns in the data frame</strong>. Also note when columns have proper names (i.e. have ONLY letters, numbers, periods, and underscores and NO spaces or other symbols) they do not need quotes <code>" "</code> when used inside ggplot (as well as most other Tidyverse functions).</p>
</div>
<div class="tip">
<p>All plots can be flipped (i.e. changed from horizontal to vertical or vice versa) by swapping the <code>x</code> and <code>y</code> aesthetics, i.e. using <code>y = ...</code> instead of <code>x = ...</code> or vice versa. In some cases this may be preferred (e.g. when a dataset has <a href="https://www.andrewheiss.com/blog/2022/06/23/long-labels-ggplot/#option-b-swap-the-x--and-y-axes">long labels</a>) but generally it’s a matter of personal preference/style. Feel free to experiment with this yourself!</p>
</div>
</div>
<div id="title-labels" class="section level4" number="6.3.1.4">
<h4>
<span class="header-section-number">6.3.1.4</span> Title &amp; labels<a class="anchor" aria-label="anchor" href="#title-labels"><i class="fas fa-link"></i></a>
</h4>
<p>We should do one final thing before we are done with this plot: title and label it! This is something you should do for EVERY plot you make, not just in this class but throughout your data science career.</p>
<p>All plot annotations (e.g. titles, axes/data labels, legends, etc.) should meet the following criteria:</p>
<ol style="list-style-type: decimal">
<li>Accuracy: all annotations should contain accurate information.</li>
<li>Precision: strive to be precise (e.g. instead of “average”, specify mean, median, mode, or something else).</li>
<li>Concision: strive to use as few words as necessary to convey only the most important information in the given context.</li>
<li>Grammar/spelling: proper grammar and spelling should be used (abbreviations, if needed, should be standard and intuitive).</li>
<li>Units: unless it’s extremely obvious (or unitless), the data units should also be specified!</li>
</ol>
<div class="note">
<p>Any plots submitted in this class without annotations or with annotations not meeting these criteria may be penalized!</p>
</div>
<p>Annotations are hard to get right sometimes; practice adding them to every plot, and think critically as you write them or as you read other peoples’ plots and you’ll get good fast.</p>
<p>You can add titles/labels by adding the <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code> layer. Inside <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code>, you can simultaneously set some/all of the following:</p>
<ul>
<li>
<code>x = "..."</code> or <code>y = "..."</code> sets axes labels for <code>x</code> or <code>y</code>
</li>
<li>
<code>title</code> sets the plot title</li>
<li>labels for other aesthetics can also be set using the aesthetic name
<ul>
<li>for example, if you used <code>fill</code>, set its legend label with <code>fill = "..."</code>
</li>
</ul>
</li>
<li>other less frequently used labels include <code>subtitle</code>, <code>caption</code>, and <code>alt</code> for alt-text</li>
</ul>
<p>For example:</p>
<div class="sourceCode" id="cb545"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"identity"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>, y <span class="op">=</span> <span class="st">"Count"</span>, fill <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Flipper length histograms of species in Palmer penguins sample"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/title-labels-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>This plot is now ready for use!</p>
</div>
<div id="extra-options" class="section level4" number="6.3.1.5">
<h4>
<span class="header-section-number">6.3.1.5</span> Extra options<a class="anchor" aria-label="anchor" href="#extra-options"><i class="fas fa-link"></i></a>
</h4>
<p>90% of the time, the steps we went through above is all you need to completely prepare a plot for use. The other 10% of the time, you may need to configure the plot further. Each plot layer function has additional specific options you can set, so as usual <strong>check the help page or search online</strong> for more!</p>
<p>We will NOT cover every option for every plot type, but occasionally, we may highlight a few important options for you to experiment with and explore further on your own. For <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code>, besides unstacking bars with <code>position = "identity"</code> argument as we showed above, you may also want to control how and where the bins are set. There’s several ways of doing this briefly outlined below—note you can only choose ONE method!</p>
<ul>
<li>You can set the <code>bins</code> argument to set that many total bins, which will be used to evenly divide up the range of the data. E.g. by default, <code>bins = 30</code> is used to draw 30 bins, which is generally agreed to be a sensible default, even though it can create bins with strange decimal bounds (like in this example, where the bins are (170.98,173.02], (173.02,175.05], …, (229.98,232.02]).
<ul>
<li>If your data is integer-valued (like flipper length is here), this default method can actually cause problems, where some bins contain more whole numbers than others, creating strange artifacts in your data. For example, if we had two consecutive bins (1.8,3.2] and (3.2,4.6], even though they are both 1.4 units wide, the first covers 2 whole numbers (2 and 3) whereas the second only covers 1 whole number (just 4) which will distort the histogram shape.</li>
</ul>
</li>
<li>Alternatively, you can also set the <code>binwidth</code> and <code>boundary</code> arguments which will start at the given boundary and count up and down by the given binwidth to create all bins.
<ul>
<li>For example, if you want to make bins of (170,175], (175,180], …, (230,235], you can set <code>binwidth = 5</code> and <code>boundary = 170</code> (or any other whole number divisible by 5).</li>
</ul>
</li>
<li>For maximum control, you can also set <code>breaks</code> equal to any numeric vector to use for the bin boundaries.
<ul>
<li>For example, the same breaks (170,175], (175,180], …, (230,235] can be chosen by setting <code>breaks = seq(170, 235, by = 5)</code>.</li>
</ul>
</li>
</ul>
<p>Generally, you want to choose bins that are easy to visually interpret, so try using whole numbers that work well with our base-10 decimal system. You also want to avoid using <a href="https://miro.medium.com/v2/resize:fit:1400/1*ciVNPBMo-Jvqo_k7pmDbqg.png">too few or too many bins</a> which can both cause problems.</p>
<p>Let’s improve the plot one final time by setting these more sensible bin widths:</p>
<div class="sourceCode" id="cb546"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"identity"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                 binwidth <span class="op">=</span> <span class="fl">5</span>, boundary <span class="op">=</span> <span class="fl">170</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>, y <span class="op">=</span> <span class="st">"Count"</span>, fill <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Flipper length histograms of species in Palmer penguins sample"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/histogram-better-bins-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>This is now even easier to interpret, and the artifacts from the previous plots are gone. We can easily identify the average<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Again, I’m being intentionally ambiguous here.&lt;/p&gt;"><sup>24</sup></a> in each group, and even identify specific counts for specific bins (e.g. I can tell for example 39 penguins Adelie penguins were observed in the (190,195] bin).</p>
</div>
</div>
<div id="density-plots" class="section level3" number="6.3.2">
<h3>
<span class="header-section-number">6.3.2</span> Density plots<a class="anchor" aria-label="anchor" href="#density-plots"><i class="fas fa-link"></i></a>
</h3>
<p>A common variation on the histogram is the density plot, which can be thought of as like a <strong>smoothed-curve version of a histogram, but with the area under the curve normalized to 1</strong>. It represents a guess of what the entire population distribution looks like based on a sample drawn. It can be created by adding <code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code> as a plot layer.</p>
<div class="sourceCode" id="cb547"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/density-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>Similar to the histogram, we can also add additional aesthetics to differentiate by species:</p>
<div class="sourceCode" id="cb548"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>, y <span class="op">=</span> <span class="st">"Density"</span>, fill <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Flipper length densities of species in Palmer penguins sample"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/density-more-aesthetics-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>Note that this looks similar to the previously made histogram, but the Chinstrap distribution is no longer overshadowed by the other species, since the area normalization process effectively removes the effect sample size has on the height of the distribution of each species.</p>
<p>We will learn a lot more about density plots later in the inference portion of this course, but for now we will move on.</p>
<div class="tip">
<p>You can make the above plot even more accessible to readers with certain vision impairments by adding certain additional aesthetics. For example, try adding <code>linetype = species</code> to the aesthetic mapping (don’t forget to add a label for it inside <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code>), as well as increasing border thickness by adding <code>linewidth = 1</code> inside <code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code> and observe the output!</p>
</div>
</div>
<div id="box-plots" class="section level3" number="6.3.3">
<h3>
<span class="header-section-number">6.3.3</span> Box plots<a class="anchor" aria-label="anchor" href="#box-plots"><i class="fas fa-link"></i></a>
</h3>
<p>Another common plot for numeric values is the box plot. Box plots are simply a way of <strong>showing the following 5 summary statistics on a number line</strong>:</p>
<ol style="list-style-type: decimal">
<li>The <strong>minimum</strong> of the sample,</li>
<li>The <strong>first quartile</strong> <span class="math inline">\(Q_1\)</span>, i.e. the 25<sup>th</sup> percentile,</li>
<li>The <strong>median</strong>,</li>
<li>The <strong>third quartile</strong> <span class="math inline">\(Q_3\)</span>, i.e. the 75<sup>th</sup> percentile, and</li>
<li>The <strong>maximum</strong> of the sample.</li>
</ol>
<p><span class="math inline">\(Q_1\)</span> and <span class="math inline">\(Q_3\)</span> form the ends of the “box”, with the median shown as a line in between, while the min and max form the “whiskers” that stretch out on either end. Note the width of the box (i.e. <span class="math inline">\(Q_3-Q_1\)</span>) is the <a href="descriptive.html#iqr">IQR</a>.</p>
<p>Compared to the histogram and density plot, there are a few key advantages and drawbacks:</p>
<ol style="list-style-type: decimal">
<li>It’s easier to compare specific summary statistics like the median and quartiles using box plots,</li>
<li>However it’s often less effective at communicating more complex features like modality and skew.</li>
<li>Its simplicity sometimes works better for comparing many groups without appearing overly complex.</li>
</ol>
<p>Let’s show both the five number summary with <code><a href="https://rdrr.io/r/stats/fivenum.html">fivenum()</a></code> as well as the corresponding box plot for the flipper length variable:</p>
<div class="sourceCode" id="cb549"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the min, q1, median, q3, and max:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/fivenum.html">fivenum</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">flipper_length_mm</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 172 190 197 213 231</code></pre>
<div class="sourceCode" id="cb551"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># turn these into a box plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/fivenum-boxplot-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>Note that even though we can easily identify the median, quartiles, and min/max, we can <strong>no longer observe bimodality</strong> like we previously did in the histogram or density plot. This is a tradeoff that is sometimes worth making and sometimes not.</p>
<p>The boxplot can also be easily adapted to highlight the difference between species, this time by adding a <code>y</code> aesthetic:</p>
<div class="sourceCode" id="cb552"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, y <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>, y <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Flipper length box plots of species in Palmer penguins sample"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/boxploy-by-group-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>This plot sacrifices the distributional complexity of the density plot, but in return we can very easily compare the summary statistics of each group, and overall arguably just “looks nicer” in my opinion.</p>
<p>Note 2 Adelie penguins were plotted as points instead, this is due to a common “rule of thumb” for box plots to label points more than 1.5×IQR away from each quartile as “outliers”. Again, this is simply a default convention. See the help page for more details, as well as how to disable this.</p>
</div>
<div id="bar-plots" class="section level3" number="6.3.4">
<h3>
<span class="header-section-number">6.3.4</span> Bar plots<a class="anchor" aria-label="anchor" href="#bar-plots"><i class="fas fa-link"></i></a>
</h3>
<p>So far, we have only discussed visualizing 1 numeric variable, for which there are several interesting options as shown in the sections above, each with their own pros/cons.</p>
<p>For 1 categorical variable, bar plots where <strong>bars of varying heights are plotted for each category</strong> are the only real option. Generally, the most common thing to plot (without involving other columns) is either the count or proportion of each category observed in the sample. Note that for proportion, pie charts are also often used, but these have fallen out of fashion and <a href="https://www.data-to-viz.com/caveat/pie.html">are no longer recommended</a>.</p>
<p>Confusingly, ggplot2 offers 2 different functions for making bar plots <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code> which appear similar but are NOT the same!</p>
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> by default only accepts <strong>one aesthetic</strong> (either <code>x</code> or <code>y</code> but NOT both) and will <strong>tally a given column</strong>, counting the number of rows for each category and plotting the total counts. This is generally used with the full original dataset.</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code> by default demands <strong>two aesthetics</strong> (both <code>x</code> AND <code>y</code>) and performs <strong>no further computation</strong> and simply plots one against the other. This is generally used only with summaries of the dataset, NOT the full original dataset.</li>
</ul>
<p>For example, we can use <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> to compute AND plot the total count of each species in the sample:</p>
<div class="sourceCode" id="cb553"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Species"</span>, y <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Count of each species in Palmer penguins sample"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/geom-bar-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>If we wanted to make the same plot using <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code>, we must FIRST summarize the dataset by computing the counts manually, then passing both the species and computed values in as <code>x</code> and <code>y</code> aesthetics, like this:</p>
<div class="sourceCode" id="cb554"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we will learn later how to do this more efficiently with tidyverse,</span></span>
<span><span class="co"># but for now we can summarize the counts using base R syntax</span></span>
<span><span class="va">penguins_species_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Adelie"</span>, <span class="st">"Chinstrap"</span>, <span class="st">"Gentoo"</span><span class="op">)</span>, </span>
<span>  count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Adelie"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Chinstrap"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Gentoo"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># check the result</span></span>
<span><span class="va">penguins_species_counts</span></span></code></pre></div>
<pre><code># A tibble: 3 × 2
  species   count
  &lt;chr&gt;     &lt;int&gt;
1 Adelie      146
2 Chinstrap    68
3 Gentoo      119</code></pre>
<div class="sourceCode" id="cb556"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># now, make the same plot using the summary data frame and geom_col()</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins_species_counts</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Species"</span>, y <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Count of each species in Palmer penguins sample"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/geom-col-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>In the next chapter, we will learn how to more efficiently summarize datasets into similar “summary” data frames like above, which will allow us to fully appreciate the versatility of <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code>.</p>
<div id="extra-options-1" class="section level4" number="6.3.4.1">
<h4>
<span class="header-section-number">6.3.4.1</span> Extra options<a class="anchor" aria-label="anchor" href="#extra-options-1"><i class="fas fa-link"></i></a>
</h4>
<p><code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> has two important arguments that significantly improve its utility. You can set <code>stat = "summary"</code> and <code>fun = "..."</code> where <code>...</code> is the name of some summary function (e.g. mean, median, sd, var, IQR, range, or any other “summary” function, i.e. something that ingests a vector and outputs a single value). This will allow you to set the other axis aesthetic as well (e.g. <code>y = ...</code>) to another column which will be summarized using the given function.</p>
<p>For example, supposed we want to use a bar plot to compare the median flipper length for each species. We can set <code>stat = "summary"</code>, <code>fun = "median"</code>, and map <code>y = flipper_length_mm</code> to make the following plot:</p>
<div class="sourceCode" id="cb557"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"summary"</span>, fun <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Species"</span>, y <span class="op">=</span> <span class="st">"Median flipper length (mm)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Median flipper length by species in Palmer penguins sample"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/geom-bar-median-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="adding-aesthetics-1" class="section level4" number="6.3.4.2">
<h4>
<span class="header-section-number">6.3.4.2</span> Adding aesthetics<a class="anchor" aria-label="anchor" href="#adding-aesthetics-1"><i class="fas fa-link"></i></a>
</h4>
<p>Bar plots are also often good candidates for adding additional aesthetics like <code>fill</code>. I’ll show 2 examples of this: a stacked and unstacked bar version.</p>
<p>By default, adding <code>fill</code> creates a stacked bar plot, which is good for showing proportions of each bar with respect to a second categorical variable. For example, suppose we want to show which island each species came from. We can do this by adding <code>fill = island</code> to the aesthetic mapping:</p>
<div class="sourceCode" id="cb558"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, fill <span class="op">=</span> <span class="va">island</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Species"</span>, y <span class="op">=</span> <span class="st">"Count"</span>, fill <span class="op">=</span> <span class="st">"Island"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Count of each species (by island) in Palmer penguins sample"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/geom-bar-more-aesthetics-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>We can also unstack the bars by setting <code>position = "dodge"</code> inside <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>, making the bars appear side by side. For example, suppose we want to compare median flipper length not only by species but also by sex. We can easily do this by adding <code>fill = sex</code> to our aesthetic mapping, as well as setting <code>position</code> as mentioned above:</p>
<div class="sourceCode" id="cb559"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">flipper_length_mm</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"summary"</span>, fun <span class="op">=</span> <span class="st">"median"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Species"</span>, y <span class="op">=</span> <span class="st">"Median flipper length (mm)"</span>, fill <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Median flipper length by species &amp; sex in Palmer penguins sample"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/geom-bar-more-aesthetics-unstacked-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
</div>
<div id="two-variable-plots" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Two-variable plots<a class="anchor" aria-label="anchor" href="#two-variable-plots"><i class="fas fa-link"></i></a>
</h2>
<p>In contrast with the previous types, the plot types below MUST be made with at least two variables; they are not possible with a single column.</p>
<div id="scatter-plot" class="section level3" number="6.4.1">
<h3>
<span class="header-section-number">6.4.1</span> Scatter plot<a class="anchor" aria-label="anchor" href="#scatter-plot"><i class="fas fa-link"></i></a>
</h3>
<p>Scatter plots are perhaps the most famous plot type, and one most people are well familiar with. Scatter plots are your classic <strong>y vs x plot of two numeric variables as Cartesian coordinates</strong> on a 2-dimensional grid. To make a scatter plot with ggplot2, you just need to map the <code>x</code> and <code>y</code> aesthetics to two columns, then add <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> as a layer.</p>
<p>For example, suppose we want to make a scatter plot of flipper length vs bill depth to see if there is any correlation between the two. Note we always say <strong>y vs x</strong>, never x vs y. This would be the code:</p>
<div class="sourceCode" id="cb560"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">flipper_length_mm</span>, x <span class="op">=</span> <span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bill depth (mm)"</span>, y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Flipper length vs bill depth for Palmer penguins sample"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/scatter-plot-1.svg" width="672" style="display: block; margin: auto;"></div>
<div id="adding-aesthetics-2" class="section level4" number="6.4.1.1">
<h4>
<span class="header-section-number">6.4.1.1</span> Adding aesthetics<a class="anchor" aria-label="anchor" href="#adding-aesthetics-2"><i class="fas fa-link"></i></a>
</h4>
<p>It may surprise you to see that these two are negatively correlated, i.e. that an increase in bill depth seems to correlate with a decrease in flipper length, or vice versa. However, if we again add species to the plot, you will see an interesting pattern emerge.</p>
<p>To improve readability, we can set both the <code>color</code> and <code>shape</code> aesthetics to be controlled by the species column, as well as slightly increase the size of the points by setting <code>size = 2</code> inside <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>, like this:</p>
<div class="sourceCode" id="cb561"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">flipper_length_mm</span>, x <span class="op">=</span> <span class="va">bill_depth_mm</span>,</span>
<span>                     color <span class="op">=</span> <span class="va">species</span>, shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bill depth (mm)"</span>, y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Species"</span>, shape <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Flipper length vs bill depth by species for Palmer penguins sample"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/scatter-plot-more-aesthetics-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>Now we can clearly see bill depth and flipper length are in fact positively correlated within each species, as we might expect. This is an effect called <a href="https://en.wikipedia.org/wiki/Simpson%27s_paradox">Simpson’s paradox</a> and arises surprisingly often in datasets, most notably in 1973 when <a href="https://www.brookings.edu/articles/when-average-isnt-good-enough-simpsons-paradox-in-education-and-earnings">UC Berkeley was accused of gender discrimination</a> and almost sued.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Apparently &lt;a href="https://www.refsmmat.com/posts/2016-05-08-simpsons-paradox-berkeley.html"&gt;no lawsuit was actually ever filed&lt;/a&gt;, though many sources wrongly claim otherwise. This incident has become rather infamous in the annals of statistics.&lt;/p&gt;'><sup>25</sup></a></p>
<p>When making scatter plots, it’s important to remember that <strong>correlation does NOT necessarily imply causation</strong>. Do flippers grow longer BECAUSE they have long bills or vice versa? Obviously probably not, some penguins just grow bigger than others in their species by winning the genetic lottery and have bigger features overall.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://xkcd.com/552"&gt;Relevant XKCD&lt;/a&gt;.&lt;/p&gt;'><sup>26</sup></a></p>
</div>
</div>
<div id="smoothed-trend-curveslines" class="section level3" number="6.4.2">
<h3>
<span class="header-section-number">6.4.2</span> Smoothed trend curves/lines<a class="anchor" aria-label="anchor" href="#smoothed-trend-curveslines"><i class="fas fa-link"></i></a>
</h3>
<p>We can also add a smoothed trend curve/line (depending on context) to this plot to highlight the direction of correlation within each species group. We do this by adding an additional <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> layer to the plot. By default, this will plot a smoothed trend curve (using <a href="https://towardsdatascience.com/loess-373d43b03564">LOESS smoothing</a>) through each group:</p>
<div class="sourceCode" id="cb562"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">flipper_length_mm</span>, x <span class="op">=</span> <span class="va">bill_depth_mm</span>,</span>
<span>                     color <span class="op">=</span> <span class="va">species</span>, shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bill depth (mm)"</span>, y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Species"</span>, shape <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Flipper length vs bill depth by species for Palmer penguins sample"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/smoothed-curve-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>This is clearly not right here; the data shows strong signs of linearity. We can force <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> to fit and plot linear regression models to each species by setting <code>method = lm</code>. We can also turn off the unnecessarily cluttering gray error margins with <code>se = FALSE</code> and get this much improved plot:</p>
<div class="sourceCode" id="cb563"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">flipper_length_mm</span>, x <span class="op">=</span> <span class="va">bill_depth_mm</span>,</span>
<span>                     color <span class="op">=</span> <span class="va">species</span>, shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bill depth (mm)"</span>, y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Species"</span>, shape <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Flipper length vs bill depth by species for Palmer penguins sample"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/smoothed-line-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>Note that since <code>x</code>, <code>y</code>, and <code>color</code> are set in the base <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> object, all subsequent layers automagically inherit those aesthetics; this is how both <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> know to use those aesthetic mappings to construct their own plot layers. Trend curves don’t make use of the <code>shape</code> aesthetic which only applies to the scatter plot layer, so that’s simply ignored by <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code>.</p>
<div class="note">
<p>This is a good time to point out the difference between mapping an aesthetic in the base object vs mapping it in a plot layer.</p>
<p>In the last example code chunk above, note we set the <code>x</code>, <code>y</code>, <code>color</code>, and <code>shape</code> aesthetics all in the base <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> object, which is inherited by both the <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> layers. If instead we don’t want one of these to inherit certain aesthetics, we can set it directly in the other layer instead.</p>
<p>For example, suppose we each species to have points of differing color and shape, but we don’t want a different trend line for each species, but rather 1 single trend line across all points. We can easily achieve this by setting <code>color</code> and <code>shape</code> inside <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> instead of <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. This will cause <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> to inherit only <code>x</code> and <code>y</code> from <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> and a single trend line will be made for all species:</p>
<div class="sourceCode" id="cb564"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">flipper_length_mm</span>, x <span class="op">=</span> <span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">species</span>, shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Bill depth (mm)"</span>, y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Species"</span>, shape <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Flipper length vs bill depth by species for Palmer penguins"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/smoothed-line-overall-aesthetic-disinheritance-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="line-plots" class="section level3" number="6.4.3">
<h3>
<span class="header-section-number">6.4.3</span> Line plots<a class="anchor" aria-label="anchor" href="#line-plots"><i class="fas fa-link"></i></a>
</h3>
<p>For some specific datasets, especially chronological datasets where some variable is plotted against time, it may make sense to <strong>directly connect each individual data point with the points before and after it to form a line (or trace) plot</strong>. Note this is NOT the same as the smoothed trend plot shown above since for a line plot there is <strong>no smoothing performed</strong>!</p>
<p>Unfortunately, the Palmer penguins dataset isn’t the best example for this last plot type, so I’m temporarily borrowing another dataset for this example. The chunk below imports <a href="https://bwu62.github.io/stat240-revamp/data/enrollment.csv"><code>enrollment.csv</code></a> which contains historic U.S. college enrollment data by each sex.</p>
<div class="sourceCode" id="cb565"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">enrollment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://bwu62.github.io/stat240-revamp/data/enrollment.csv"</span><span class="op">)</span></span>
<span><span class="co"># show a glimpse of the dataset</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">enrollment</span><span class="op">)</span></span></code></pre></div>
<pre><code>Rows: 148
Columns: 3
$ year              &lt;dbl&gt; 1947, 1947, 1948, 1948, 1949, 1949, 1950, 1950, 1951, 195…
$ sex               &lt;chr&gt; "male", "female", "male", "female", "male", "female", "ma…
$ enrolled_millions &lt;dbl&gt; 1.659249, 0.678977, 1.709367, 0.694029, 1.721572, 0.72332…</code></pre>
<p>Here, each row is a pair of male and female college enrollment counts (in millions) for a specific year. We can obviously just make a scatter plot of enrollment vs year, with additional aesthetics differentiating between male and female data points, like this:</p>
<div class="sourceCode" id="cb567"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">enrollment</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">enrolled_millions</span>,</span>
<span>                       color <span class="op">=</span> <span class="va">sex</span>, shape <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time"</span>, y <span class="op">=</span> <span class="st">"Enrolled (millions)"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Sex"</span>, shape <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"U.S. College enrollment by sex"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/line-plot1-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>However, the chronological nature of this data means <strong>each data point has a specific predecessor and successor</strong>, i.e. for each point (except the end points) there are specific points that comes before and after it in chronological order. Thus, it makes more sense to connect these points with a single continuous line for each sex. This can be done by using <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> instead. We can also drop the <code>shape</code> aesthetic since it doesn’t apply to lines:</p>
<div class="sourceCode" id="cb568"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">enrollment</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">enrolled_millions</span>, color <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time"</span>, y <span class="op">=</span> <span class="st">"Enrolled (millions)"</span>, color <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"U.S. College enrollment by sex"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/line-plot2-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>By default the line appears very thin and may be hard to read for some people. We can add <code>linewidth = 1.2</code> to <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> to increase the thickness. We can also add another aesthetic <code>linetype = sex</code> for additional disambiguation so it’s extremely clear which line corresponds to which sex:</p>
<div class="sourceCode" id="cb569"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">enrollment</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">enrolled_millions</span>,</span>
<span>                       color <span class="op">=</span> <span class="va">sex</span>, linetype <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time"</span>, y <span class="op">=</span> <span class="st">"Enrolled (millions)"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Sex"</span>, linetype <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"U.S. College enrollment by sex"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/line-plot3-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>We can see that since the late 70’s, college enrollment of female students has consistently outpaced that of male students.</p>
<div class="note">
<p>For the purposes of this course, “line plot” or “trace plot” refer to <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>, and “smoothed line” or “trend line” or “straight line” refer to <code>geom_smooth(method = lm)</code>. Take care not to mix these up!</p>
</div>
</div>
<div id="bonus-area-plots" class="section level3" number="6.4.4">
<h3>
<span class="header-section-number">6.4.4</span> Bonus: area plots<a class="anchor" aria-label="anchor" href="#bonus-area-plots"><i class="fas fa-link"></i></a>
</h3>
<p>I wanted to throw in a bonus plot type here. This kind of composition-over-time data is also VERY commonly shown as a <a href="https://r-graph-gallery.com/136-stacked-area-chart.html">stacked area plot</a> which can be made with <code><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area()</a></code>. I’ve also added a <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual()</a></code> configuration layer to manually specify a color palette to use more intuitive colors for each category.</p>
<div class="sourceCode" id="cb570"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">enrollment</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">enrolled_millions</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#fb9a99"</span>, <span class="st">"#a6cee3"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time"</span>, y <span class="op">=</span> <span class="st">"Enrolled (millions)"</span>, fill <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"U.S. College enrollment by sex"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/area-plot-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>Compared to line plots with one line per category, the stacked area plot has the advantage of easily showing both relative proportions of categories as well as total sum of all categories, but this comes at a cost of being able to easily compare individual categories to each other. So a tradeoff, as usual.</p>
</div>
<div id="aside-time-axis" class="section level3" number="6.4.5">
<h3>
<span class="header-section-number">6.4.5</span> Aside: time axis<a class="anchor" aria-label="anchor" href="#aside-time-axis"><i class="fas fa-link"></i></a>
</h3>
<p>Note the previous example used just the year number on the horizontal axis (since the data was already summarized as annual totals) but you can of course also use dates on an axis. For a quick example, we can load the <a href="https://fred.stlouisfed.org/series/UNRATE">FRED U.S. unemployment rate</a> dataset and plot it.</p>
<div class="sourceCode" id="cb571"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unemployment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://fred.stlouisfed.org/graph/fredgraph.csv?id=UNRATE"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">unemployment</span><span class="op">)</span></span></code></pre></div>
<pre><code>Rows: 932
Columns: 2
$ observation_date &lt;date&gt; 1948-01-01, 1948-02-01, 1948-03-01, 1948-04-01, 1948-05-0…
$ UNRATE           &lt;dbl&gt; 3.4, 3.8, 4.0, 3.9, 3.5, 3.6, 3.6, 3.9, 3.8, 3.7, 3.8, 4.0…</code></pre>
<div class="sourceCode" id="cb573"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">unemployment</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">observation_date</span>, y <span class="op">=</span> <span class="va">UNRATE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time"</span>, y <span class="op">=</span> <span class="st">"Unemployment rate (%)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"U.S. Unemployment rate"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/time-axis1-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>The superficially look the same as the previous plot, however if we zoom in and plot just the last year of data, we can see the horizontal axis is in fact a special date type of axis:</p>
<div class="sourceCode" id="cb574"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot just the last 12 months of data</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">unemployment</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">unemployment</span><span class="op">[</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">11</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">observation_date</span>, y <span class="op">=</span> <span class="va">UNRATE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time"</span>, y <span class="op">=</span> <span class="st">"Unemployment rate (%)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"U.S. Unemployment rate"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/time-axis2-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>The choppiness is because the data is only summarized monthly.</p>
</div>
</div>
<div id="facet-subplots" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Facet subplots<a class="anchor" aria-label="anchor" href="#facet-subplots"><i class="fas fa-link"></i></a>
</h2>
<p>Another way to incorporate additional aesthetics is to use facets, i.e. instead of having everything on one plot, <strong>breaking off into multiple subplots</strong> to visualize extra dimensions of your dataset.</p>
<p>There are two primary functions for this:</p>
<ul>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> creates a <strong>series of subplots along ONE additional categorical column</strong> with one panel for each category, then allows the plots to <strong>wrap onto multiple rows</strong>, the same way a sentence can wrap onto multiple lines. This is best for when you want to incorporate a single additional variable with many levels that wouldn’t all fit onto one row.</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid()</a></code> creates a <strong>grid of subplots along one or two additional categorical column(s)</strong>. You can make either a row of subplots, or a column of subplots, or even a matrix of them, incorporating two additional columns into your visualizations.</li>
</ul>
<p>Let’s demonstrate each of these briefly.</p>
<div id="facet_wrap" class="section level3" number="6.5.1">
<h3>
<span class="header-section-number">6.5.1</span> <code>facet_wrap()</code><a class="anchor" aria-label="anchor" href="#facet_wrap"><i class="fas fa-link"></i></a>
</h3>
<p>Going back to the penguins dataset, suppose you wanted to look at the relationship between body mass and flipper length. You start by making this plot:</p>
<div class="sourceCode" id="cb575"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_mass_g</span>, y <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/facet-wrap-progression1-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>Maybe you decide to also incorporate species as a variable, so you can see if there are differences between the different species:</p>
<div class="sourceCode" id="cb576"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_mass_g</span>, y <span class="op">=</span> <span class="va">flipper_length_mm</span>,</span>
<span>                     color <span class="op">=</span> <span class="va">species</span>, shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/facet-wrap-progression2-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>Some interesting patterns start to emerge. Suppose you want to take this a step further and also incorporate sex, to see if that adds anything interesting to the picture. You could change for example the mapping to set <code>shape = sex</code>, but I think this results in a plot that’s a little too complicated and hard to read:</p>
<div class="sourceCode" id="cb577"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_mass_g</span>, y <span class="op">=</span> <span class="va">flipper_length_mm</span>,</span>
<span>                     color <span class="op">=</span> <span class="va">species</span>, shape <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Body mass (g)"</span>, y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Flipper length vs body mass (by species &amp; sex) for Palmer penguins"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/facet-wrap-progression3-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>A better way may be to <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> the species variable, and switch to using both <code>color</code> and <code>shape</code> to differentiate sex. The syntax for this is to add the faceting layer <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> with the argument <code>~species</code> which will automagically split each species into its own facet subplot. You can also set <code>ncol = 2</code> to control how/when to wrap the plots:</p>
<div class="sourceCode" id="cb578"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_mass_g</span>, y <span class="op">=</span> <span class="va">flipper_length_mm</span>,</span>
<span>                     color <span class="op">=</span> <span class="va">sex</span>, shape <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">species</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Body mass (g)"</span>, y <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>, color <span class="op">=</span> <span class="st">"Sex"</span>, shape <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Flipper length vs body mass (by species &amp; sex) for Palmer penguins"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/facet-wrap-progression4-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="facet_grid" class="section level3" number="6.5.2">
<h3>
<span class="header-section-number">6.5.2</span> <code>facet_grid()</code><a class="anchor" aria-label="anchor" href="#facet_grid"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose we wanted to look more closely again at the distribution of flipper lengths by both species and sex. We can start with the plot we made previously in section <a href="data-visualization.html#density-plots">6.3.2</a>:</p>
<div class="sourceCode" id="cb579"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>, y <span class="op">=</span> <span class="st">"Density"</span>, fill <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Flipper length densities of species in Palmer penguins"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/facet-grid-progression1-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>Suppose we want to also add sex in as a variable of interest, but we also want to more closely scrutinize the distributions. One way this can be done is to add the faceting layer <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid()</a></code> with the argument <code>sex ~ species</code> which will construct a matrix of plots with one row for each sex and one column for each species:</p>
<div class="sourceCode" id="cb580"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">~</span> <span class="va">species</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>, y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Flipper length densities (by species &amp; sex) in Palmer penguins"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/facet-grid-progression2-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>You can also replace one side of the <code>a ~ b</code> syntax with a period <code>.</code> which will not facet in that direction. For example, <code>sex ~ .</code> will make a matrix of plots with one row for each sex, but only a single column all together, whereas <code>. ~ species</code> will make a matrix of plots with one column for each species, but only one row all together.</p>
<p>We can demonstrate both of these. Each time we can reassign the variable not faceted on (i.e. the one replaced with <code>.</code>) back to the <code>fill</code> aesthetic. For the second plot, we also flipped <code>x</code> and <code>y</code> to make better use of the tall-orientation of the available plot space.</p>
<div class="sourceCode" id="cb581"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>, y <span class="op">=</span> <span class="st">"Density"</span>, fill <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Flipper length densities (by species &amp; sex) in Palmer penguins"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/facet-grid-progression3-1.svg" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb582"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">flipper_length_mm</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">species</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Flipper length (mm)"</span>, y <span class="op">=</span> <span class="st">"Density"</span>, fill <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Flipper length densities (by species &amp; sex) in Palmer penguins"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/facet-grid-progression3-2.svg" width="672" style="display: block; margin: auto;"></div>
<div class="tip">
<p>By default, both <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid()</a></code> will match <code>x</code> and <code>y</code> axes across subplots. You can turn off either or both by setting the <code>scales</code> argument in your faceting function to either <code>free_x</code> or <code>free_y</code> to free one axis, or <code>free</code> to free both axes.</p>
</div>
</div>
</div>
<div id="scales" class="section level2" number="6.6">
<h2>
<span class="header-section-number">6.6</span> Scales<a class="anchor" aria-label="anchor" href="#scales"><i class="fas fa-link"></i></a>
</h2>
<p>Generally, the default axes are fine, but if you need to you can modify them with scale layers. <strong>Scales control how every aesthetic is displayed</strong> on a plot, and there are scales for every aesthetic. Aesthetics added to a plot automatically come with a scale layer with default settings, but you can replace this with a custom-tuned scale with your own settings by adding another scale on.</p>
<p>Every scale layer has the following name pattern: <code>scale_aes_type</code> where <code>aes</code> and <code>type</code> are the name of the aesthetic and type of scale used. For example, if you’re making a density plot and set <code>x = flipper_length_mm</code> this is controlled by <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous()</a></code> because the <code>flipper_length_mm</code> column is a continuous, numeric type variable. However if you are making a bar plot and set <code>x = species</code> this is controlled by <code><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete()</a></code> since <code>species</code> is a discrete, categorical type variable.</p>
<p>These also apply to other aesthetics. If you set <code>fill = species</code> and <code>color = sex</code> by default these are controlled by <code><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_fill_discrete()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete()</a></code> since these are both discrete. There are automatic color choosing functions like <code><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer()</a></code> which use the excellent <a href="https://www.datanovia.com/en/blog/the-a-z-of-rcolorbrewer-palette">Brewer color palettes</a>, but you can also set your own with <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual()</a></code>.</p>
<div class="tip">
<p>With tidyverse loaded, try typing <code>scale_</code> into the console and use the autocomplete popup (if it doesn’t appear automatically, use <span class="k">TAB</span> to trigger it) to explore the different scale layers available. Hover over each scale function and read the short summary as well as scan the available arguments. If you need more details, check the help page!</p>
</div>
<p>We don’t have time to go into detail about every possible scale function; see <a href="https://ggplot2-book.org/scales-guides">this page on scales</a> or read the help pages for a particular function for more info! Here’s an example of some of these scale layers being used to modify the last plot we made just above where we faceted by species:</p>
<div class="sourceCode" id="cb583"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">flipper_length_mm</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">species</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Flipper length densities (by species &amp; sex) in Palmer penguins sample"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Flipper length (mm)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span>,              <span class="co"># set limits</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.08</span>, <span class="fl">0.02</span><span class="op">)</span>,     <span class="co"># set breaks</span></span>
<span>    expand <span class="op">=</span> <span class="fl">0</span>                       <span class="co"># remove padding (extra spacing at either end)</span></span>
<span>    <span class="co"># if you need to transform x, you can also set transform = something (see help!)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">170</span>, <span class="fl">230</span>, <span class="fl">2</span><span class="op">)</span>, <span class="co"># set minor breaks</span></span>
<span>    expand <span class="op">=</span> <span class="fl">0</span>                       <span class="co"># remove padding here as well</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>        <span class="co"># set custom colors, full list of possible names:</span></span>
<span>  <span class="op">)</span>                                  <span class="co"># www.stat.columbia.edu/~tzheng/files/Rcolor.pdf</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/scales-1.svg" width="672" style="display: block; margin: auto;"></div>
<!--
<details>
<summary>*Bonus bar plot*</summary>
What do you think the following code will produce?

:::{.fold .o}

``` r
df <- tibble(
  x = c("a", "a", "a", "b", "b", "b", "c", "c", "c", "d", "d", "e", "e"),
  y = c(20, 20, 25, 40, 20, 40, 15, 15, 18, 28, 15, 18, 11),
  z = c("a", "b", "c", "d", "c", "e", "f", "g", "c", "h", "c", "i", "c")
)
ggplot(df, aes(x = x, y = y, fill = z)) +
  geom_col() +
  scale_fill_manual(
    values = c(
      "#4F76DF", "#FFFFFF", "#FFD90F", "#83C33F", "#2359F1",
      "#6686C7", "#E65120", "#DA6901", "#72C7E7"
    )
  )
```

<img src="06-data-visualization_files/figure-html/unnamed-chunk-1-1.svg" width="528" style="display: block; margin: auto;" />
([*credit*](https://www.r-bloggers.com/2016/03/the-simpsons-as-a-chart-2/))
:::

</details>
-->
</div>
<div id="other-geoms" class="section level2" number="6.7">
<h2>
<span class="header-section-number">6.7</span> Other geoms<a class="anchor" aria-label="anchor" href="#other-geoms"><i class="fas fa-link"></i></a>
</h2>
<p>Many other geoms exist (see the <a href="misc/data-visualization.pdf">ggplot2 cheat sheet</a> for a full list). Here are just a <em>few</em> other extremely useful ones you should know about.</p>
<!--original:
https://rstudio.github.io/cheatsheets/data-visualization.pdf
-->
<div id="straight-lines" class="section level3" number="6.7.1">
<h3>
<span class="header-section-number">6.7.1</span> Straight lines<a class="anchor" aria-label="anchor" href="#straight-lines"><i class="fas fa-link"></i></a>
</h3>
<p>Sometimes you may want to draw specific lines to annotate your plot. You can use <a href="https://ggplot2.tidyverse.org/reference/geom_abline.html"><code class="sourceCode r"><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> ...)</code></a>, <a href="https://ggplot2.tidyverse.org/reference/geom_abline.html"><code class="sourceCode r"><span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ...)</code></a>, and <a href="https://ggplot2.tidyverse.org/reference/geom_abline.html"><code class="sourceCode r"><span class="fu">geom_abline</span>(<span class="at">slope =</span> ..., <span class="at">intercept =</span> ...)</code></a> to manually draw horizontal, vertical, and arbitrary lines on top of another plot. You can also directly set things like <code>color</code>, <code>alpha</code>, <code>linetype</code>, or <code>linewidth</code> inside each function to control the style. If you need multiple lines, you can use a vector of inputs, or add multiple layers. For example:</p>
<div class="sourceCode" id="cb584"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_mass_g</span>, y <span class="op">=</span> <span class="va">flipper_length_mm</span>,</span>
<span>                     color <span class="op">=</span> <span class="va">species</span>, shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">190</span>, <span class="fl">210</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"navyblue"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">4500</span>, linewidth <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">0.015</span>, intercept <span class="op">=</span> <span class="fl">140</span>, color <span class="op">=</span> <span class="st">"magenta"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/geom-straight-lines-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="functions" class="section level3" number="6.7.2">
<h3>
<span class="header-section-number">6.7.2</span> Functions<a class="anchor" aria-label="anchor" href="#functions"><i class="fas fa-link"></i></a>
</h3>
<p>Functions can be easily plotted with <a href="https://ggplot2.tidyverse.org/reference/geom_function.html"><code class="sourceCode r"><span class="fu">geom_function</span>(<span class="at">fun =</span> ...)</code></a> where <code>...</code> is the target function. This can be added either on top of an existing plot as another layer, or plotted by itself as a new plot, in which case the base object <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> requires no additional arguments.</p>
<p>If the function isn’t predefined, you can easily define it with <code>\(x) ...</code> for example:</p>
<div class="sourceCode" id="cb585"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span></span>
<span>  fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">1</span>,      <span class="co"># define x²+1</span></span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,         <span class="co"># set limits</span></span>
<span>  n <span class="op">=</span> <span class="fl">1e3</span>                  <span class="co"># increase number of points used in drawing</span></span>
<span><span class="op">)</span>                          <span class="co"># (improves smoothness of resulting curve)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/geom-function1-1.svg" width="672" style="display: block; margin: auto;"></div>
<p>If the function exists, but you need to modify the arguments, you can use <code>args = list(...)</code> any arguments specified inside will be directly passed to the chose function, for example:</p>
<div class="sourceCode" id="cb586"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot the normal distribution with mean 10 sd 2</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span></span>
<span>  fun <span class="op">=</span> <span class="va">dnorm</span>,                     <span class="co"># dnorm() is the normal distribution function</span></span>
<span>  args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,  <span class="co"># set mean and sd arguments inside dnorm()</span></span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">16</span><span class="op">)</span>,                 <span class="co"># set limits</span></span>
<span>  n <span class="op">=</span> <span class="fl">1e3</span>                          <span class="co"># increase number of points</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/geom-function2-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="bonus-pairs-plot" class="section level2" number="6.8">
<h2>
<span class="header-section-number">6.8</span> Bonus: pairs plot<a class="anchor" aria-label="anchor" href="#bonus-pairs-plot"><i class="fas fa-link"></i></a>
</h2>
<p>I didn’t know where to put this so I’m inserting it at the end of the chapter here. Here’s a bonus plot type for you called a pairs plot, where every variable in a data frame is plotted against every other variable. The primary purpose of this plot is to rapidly orient you to a new dataset you’re just starting to explore. It’s usually recommended to limit yourself to 5-6 variables max in a pairs plot, lest it become too chaotic.</p>
<p>There are many different implementations of this, but one of the best is <a href="https://ggobi.github.io/ggally/reference/ggpairs.html"><code class="sourceCode r">GGally<span class="sc">::</span><span class="fu">ggpairs</span>()</code></a>. The plot type is automatically determined based on variable types and can be density, histogram, point, bar, box, or more, and additionally some summary statistics like correlations are given where appropriate.</p>
<div class="i96">
<div class="sourceCode" id="cb587"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to run this chunk, you need to have the package GGally installed</span></span>
<span><span class="co"># first, we subset out just a few columns (otherwise it gets too crazy)</span></span>
<span><span class="co"># aes(color = species) is optional but improves the plot greatly</span></span>
<span><span class="va">penguins_subset</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="st">"body_mass_g"</span>, <span class="st">"bill_length_mm"</span>, <span class="st">"bill_depth_mm"</span>, <span class="st">"flipper_length_mm"</span><span class="op">)</span></span>
<span><span class="op">]</span></span>
<span><span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">penguins_subset</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-data-visualization_files/figure-html/pairs-plot-1.svg" width="768" style="display: block; margin: auto;"></div>
</div>
<p>This plot is recommended ONLY as an initial exploratory plot; it should NOT be used in a more purposeful setting like a report since it lacks direction/focus.</p>
</div>
<div id="further-readings" class="section level2" number="6.9">
<h2>
<span class="header-section-number">6.9</span> Further readings<a class="anchor" aria-label="anchor" href="#further-readings"><i class="fas fa-link"></i></a>
</h2>
<p>These are beyond the scope of this course, but here’s a few other links if you want to learn more:</p>
<ul>
<li>If you haven’t already, make sure to check out the <a href="misc/data-visualization.pdf">ggplot2 cheat sheet</a>.</li>
<li>If you need help picking a plot, <a href="https://www.data-to-viz.com">Data to Viz</a> has a nice flow chart with links to example R code.</li>
<li>I also recommend scanning the Data to Viz <a href="https://www.data-to-viz.com/caveats.html">page on caveats</a>, i.e. common pitfalls in data science.</li>
<li>You can add additional <a href="https://ggplot2.tidyverse.org/reference/geom_text.html">text annotations</a> to your plots if necessary.</li>
<li>You can also <a href="https://ggplot2-book.org/coord">modify the coordinate systems</a>, for example to make polar plots which are especially effective for cyclical or directional data.</li>
<li>There are also other <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">plot themes</a> you can try out.</li>
<li>Here’s a <a href="https://r-graph-gallery.com">gallery of R plots</a> if you want to learn more advanced types of plots and see examples of how to make them.</li>
</ul>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@xiee/utils/js/external-link.min.js" defer></script><script>
  $(function(){
    $(".note").addClass("alert alert-warning");
  });
  $(function(){
    $(".tip").addClass("alert alert-success");
  });
  $(function(){
    $(".def").addClass("alert alert-info");
  });
  $(function(){
    $(".eg").addClass("alert alert-secondary");
  });
  $(function(){
    $(".col-lg-3").addClass("col-lg-2").removeClass("col-lg-3");
  });
  $(function(){
    $(".col-lg-7").addClass("col-lg-8").removeClass("col-lg-7");
  });
</script><!-- https://stackoverflow.com/a/37839683/25278020 --><script>
  $(document).ready(function() {

  $chunks = $('.fold');

  $chunks.each(function () {

    // add button to source code chunks
    if ( $(this).hasClass('s') ) {
      $('pre.r', this).prepend("<div class=\"showopt\">Show Source</div><br style=\"line-height:22px;\"/>");
      $('pre.r', this).children('code').attr('class', 'folded');
    }

    // add button to output chunks
    if ( $(this).hasClass('o') ) {
      $('pre:not(.r)', this).has('code').prepend("<div class=\"showopt\">Show Output</div><br style=\"line-height:22px;\"/>");
      $('pre:not(.r)', this).children('code:not(r)').addClass('folded');

      // add button to plots
      $(this).find('img').wrap('<pre class=\"plot\"></pre>');
      $('pre.plot', this).prepend("<div class=\"showopt\">Show Plot</div><br style=\"line-height:22px;\"/>");
      $('pre.plot', this).children('img').addClass('folded');

    }
  });

  // hide all chunks when document is loaded
  $('.folded').css('display', 'none')

  // function to toggle the visibility
  $('.showopt').click(function() {
    var label = $(this).html();
    if (label.indexOf("Show") >= 0) {
      $(this).html(label.replace("Show", "Hide"));
    } else {
      $(this).html(label.replace("Hide", "Show"));
    }
    $(this).siblings('code, img').slideToggle('fast', 'swing');
  });
});

</script><!-- https://www.tutorialrepublic.com/faq/how-to-change-href-attribute-of-a-hyperlink-using-jquery.php--><script>
  $(document).ready(function(){
    $("a.anchorjs-link").each(function(){
      var oldUrl = $(this).attr("href"); // Get current url
      var newUrl = oldUrl.replace(/^#(\d+-)+/,"#"); // Create new url
      $(this).attr("href", "#" + $(this).closest("div").attr("id"));  // Set href value
      $(this).attr("title", location.protocol + "//" + location.host + location.pathname + $(this).attr("href")); // Set title value
    });
  });
</script><!-- https://stackoverflow.com/a/10415599/25278020 --><script>
  var observer = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
        if (mutation.addedNodes && mutation.addedNodes.length > 0) {
            // element added to DOM
            var hasClass = [].some.call(mutation.addedNodes, function(el) {
                return el.classList.contains('bs-popover-top')
            });
            if (hasClass) {
              $("div.bs-popover-top a").each(function(){
                $(this).attr("target", "_blank");
              });
          }
        }
    });
});

var config = {
    attributes: true,
    childList: true,
    characterData: true
};

observer.observe(document.body, config);
</script><!--https://stackoverflow.com/a/49025957--><script>
  $(function() {
  $('a[class="footnote-ref"][data-toggle="popover"]').popover()
})

$('body')
  .on('mousedown', '.popover', function(e) {
    console.log("clicked inside popover")
    e.preventDefault()
  });
</script><div class="chapter-nav">
<div class="prev"><a href="descriptive.html"><span class="header-section-number">5</span> Descriptive Statistics</a></div>
<div class="next"><a href="data-transformation.html">Data Transformation</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-visualization"><span class="header-section-number">6</span> Data Visualization</a></li>
<li><a class="nav-link" href="#ggplot2"><span class="header-section-number">6.1</span> ggplot2</a></li>
<li><a class="nav-link" href="#palmer-penguins"><span class="header-section-number">6.2</span> Palmer penguins</a></li>
<li>
<a class="nav-link" href="#one-variable-plots"><span class="header-section-number">6.3</span> One-variable plots</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#histogram"><span class="header-section-number">6.3.1</span> Histogram</a></li>
<li><a class="nav-link" href="#density-plots"><span class="header-section-number">6.3.2</span> Density plots</a></li>
<li><a class="nav-link" href="#box-plots"><span class="header-section-number">6.3.3</span> Box plots</a></li>
<li><a class="nav-link" href="#bar-plots"><span class="header-section-number">6.3.4</span> Bar plots</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#two-variable-plots"><span class="header-section-number">6.4</span> Two-variable plots</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#scatter-plot"><span class="header-section-number">6.4.1</span> Scatter plot</a></li>
<li><a class="nav-link" href="#smoothed-trend-curveslines"><span class="header-section-number">6.4.2</span> Smoothed trend curves/lines</a></li>
<li><a class="nav-link" href="#line-plots"><span class="header-section-number">6.4.3</span> Line plots</a></li>
<li><a class="nav-link" href="#bonus-area-plots"><span class="header-section-number">6.4.4</span> Bonus: area plots</a></li>
<li><a class="nav-link" href="#aside-time-axis"><span class="header-section-number">6.4.5</span> Aside: time axis</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#facet-subplots"><span class="header-section-number">6.5</span> Facet subplots</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#facet_wrap"><span class="header-section-number">6.5.1</span> facet_wrap()</a></li>
<li><a class="nav-link" href="#facet_grid"><span class="header-section-number">6.5.2</span> facet_grid()</a></li>
</ul>
</li>
<li><a class="nav-link" href="#scales"><span class="header-section-number">6.6</span> Scales</a></li>
<li>
<a class="nav-link" href="#other-geoms"><span class="header-section-number">6.7</span> Other geoms</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#straight-lines"><span class="header-section-number">6.7.1</span> Straight lines</a></li>
<li><a class="nav-link" href="#functions"><span class="header-section-number">6.7.2</span> Functions</a></li>
</ul>
</li>
<li><a class="nav-link" href="#bonus-pairs-plot"><span class="header-section-number">6.8</span> Bonus: pairs plot</a></li>
<li><a class="nav-link" href="#further-readings"><span class="header-section-number">6.9</span> Further readings</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/bwu62/stat240-revamp/blob/master/06-data-visualization.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/bwu62/stat240-revamp/edit/master/06-data-visualization.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>STAT 240 Revamp</strong>" was written by Bi Cheng Wu, with help from Bret Larget and Cameron Jones. It was last built on 2025-10-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
