<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 10 Intro to Probability | STAT 240 Revamp</title>
<meta name="author" content="Bi Cheng Wu, with help from Bret Larget and Cameron Jones">
<meta name="description" content="\(   \def\e{\operatorname{E}}   \def\p{\operatorname{P}}   \def\var{\operatorname{Var}}   \def\sd{\operatorname{SD}}   \def\bin{\operatorname{Bin}}   \def\n{\operatorname{N}}  ...">
<meta name="generator" content="bookdown 0.45 with bs4_book()">
<meta property="og:title" content="Chapter 10 Intro to Probability | STAT 240 Revamp">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bwu62.github.io/stat240-revamp/intro-to-probability.html">
<meta property="og:description" content="\(   \def\e{\operatorname{E}}   \def\p{\operatorname{P}}   \def\var{\operatorname{Var}}   \def\sd{\operatorname{SD}}   \def\bin{\operatorname{Bin}}   \def\n{\operatorname{N}}  ...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 10 Intro to Probability | STAT 240 Revamp">
<meta name="twitter:description" content="\(   \def\e{\operatorname{E}}   \def\p{\operatorname{P}}   \def\var{\operatorname{Var}}   \def\sd{\operatorname{SD}}   \def\bin{\operatorname{Bin}}   \def\n{\operatorname{N}}  ...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Roboto_Mono-0.4.10/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.11.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.2/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-E0YDB40HWY"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-E0YDB40HWY');
    </script><link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
<link rel="manifest" href="icons/site.webmanifest">
<link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<!-- https://www.bryanbraun.com/anchorjs/ --><script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script><script>
      // Add anchors on DOMContentLoaded
    document.addEventListener('DOMContentLoaded', function(event) {
      anchors.add('h1');
      anchors.add();
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">STAT 240 Revamp</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome!</a></li>
<li><a class="" href="setup.html"><span class="header-section-number">1</span> Setup</a></li>
<li class="book-part">R Crash Course</li>
<li><a class="" href="rstudio-intro.html"><span class="header-section-number">2</span> Intro to R/Rstudio</a></li>
<li><a class="" href="data-vectors.html"><span class="header-section-number">3</span> Data Vectors</a></li>
<li><a class="" href="data-frames.html"><span class="header-section-number">4</span> Data Frames</a></li>
<li><a class="" href="data-exploration.html">Data Exploration</a></li>
<li><a class="" href="descriptive.html"><span class="header-section-number">5</span> Descriptive Statistics</a></li>
<li><a class="" href="data-visualization.html"><span class="header-section-number">6</span> Data Visualization</a></li>
<li><a class="" href="data-transformation.html">Data Transformation</a></li>
<li><a class="" href="intro-to-dplyr.html"><span class="header-section-number">7</span> Intro to dplyr</a></li>
<li><a class="" href="advanced-operations.html"><span class="header-section-number">8</span> Advanced Operations</a></li>
<li><a class="" href="data-modeling.html">Data Modeling</a></li>
<li><a class="" href="overview.html"><span class="header-section-number">9</span> Overview</a></li>
<li><a class="active" href="intro-to-probability.html"><span class="header-section-number">10</span> Intro to Probability</a></li>
<li><a class="" href="sampling-inference.html"><span class="header-section-number">11</span> Sampling &amp; Inference</a></li>
<li><a class="" href="inference-types.html">Inference Types</a></li>
<li><a class="" href="proportions.html"><span class="header-section-number">12</span> Proportions</a></li>
<li><a class="" href="means.html"><span class="header-section-number">13</span> Means</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">14</span> Regression</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="datasets.html"><span class="header-section-number">A</span> Datasets</a></li>
<li><a class="" href="cheat-sheets.html"><span class="header-section-number">B</span> Cheat Sheets</a></li>
<li><a class="" href="additional-resources.html"><span class="header-section-number">C</span> Additional Resources</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/bwu62/stat240-revamp">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><span style="display:none">
  \(
    \def\e{\operatorname{E}}
    \def\p{\operatorname{P}}
    \def\var{\operatorname{Var}}
    \def\sd{\operatorname{SD}}
    \def\bin{\operatorname{Bin}}
    \def\n{\operatorname{N}}
    \def\se{\operatorname{SE}}
  \)
</span>
<div id="intro-to-probability" class="section level1" number="10">
<h1>
<span class="header-section-number">10</span> Intro to Probability<a class="anchor" aria-label="anchor" href="#intro-to-probability"><i class="fas fa-link"></i></a>
</h1>
<p>In this section, we’ll introduce you to some foundational probability theory that will be necessary for later models. We will do this in a way that is only semi-rigorous, with an emphasis on teaching the materials in an intuitive fashion.</p>
<div id="random-variables-rvs" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> Random variables (RVs)<a class="anchor" aria-label="anchor" href="#random-variables-rvs"><i class="fas fa-link"></i></a>
</h2>
<p>Suppose we have an <strong>experiment</strong> that produces an <strong>outcome</strong> each time it’s observed. This is modeled by a <strong>random variable</strong>, often denoted with a capital letter, e.g. <span class="math inline">\(X\)</span> or <span class="math inline">\(Y\)</span>. The set of all possible outcomes is called the <strong>sample space</strong> and often denoted <span class="math inline">\(\Omega\)</span>.</p>
<p>Sets of possible outcomes are called <strong>events</strong>. Each event has some <strong>probability</strong> associated with it. The probability of some event is often denoted <span class="math inline">\(\p(\text{event})\)</span>.</p>
<p>A <strong>distribution</strong> is any specification of both the outcomes and the associated probabilities of a random variable.</p>
<div class="eg">
<p>Let <span class="math inline">\(X\)</span> be the result of rolling a standard 6-sided die that is <strong>fair</strong>, i.e. the outcomes 1, 2, 3, 4, 5, and 6 all have equal probability. Here are few examples of events and their corresponding probabilities:</p>
<ul>
<li>Probability of getting a 1: <span class="math inline">\(\p(X=1)=\frac16\)</span>
</li>
<li>Probability of getting more than 4: <span class="math inline">\(\p(X&gt;4)=\frac13\)</span>
</li>
<li>Probability of getting an even number: <span class="math inline">\(\p(X=2,4,\text{or }6)=\frac12\)</span>
</li>
<li>Probability of getting a 7: <span class="math inline">\(\p(X=7)=0\)</span>
</li>
</ul>
</div>
</div>
<div id="axioms-of-probability" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Axioms of probability<a class="anchor" aria-label="anchor" href="#axioms-of-probability"><i class="fas fa-link"></i></a>
</h2>
<p>In math, <strong>axioms</strong> are basic rules which formally define an object and which are assumed to be true without proof. These form the basis on which everything else rests. These are the axioms of probability:</p>
<ol style="list-style-type: decimal">
<li>The probability of an event is always non-negative.
<ul>
<li>Mathematically, <span class="math inline">\(\p(E)\ge0\)</span> for any event <span class="math inline">\(E\)</span> of some random variable.</li>
</ul>
</li>
<li>The probability of the entire sample space is always 1.
<ul>
<li>Mathematically, <span class="math inline">\(\p(\Omega)=1\)</span> for any random variable. Note 1 is equivalent to 100%.</li>
</ul>
</li>
<li>The probability of the <strong>union</strong> of <strong>mutually exclusive</strong> events is equal to the sum of the probabilities of each event.
<ul>
<li>Mathematically, if <span class="math inline">\(A\cap B\)</span> is empty, then <span class="math inline">\(\p(A\cup B)=\p(A)+\p(B)\)</span>
</li>
</ul>
</li>
</ol>
<div class="def">
<p>Let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be two events for some random variable.</p>
<p>The <strong>union</strong> of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, denoted <span class="math inline">\(A\cup B\)</span>, is the event of observing <span class="math inline">\(A\)</span> OR <span class="math inline">\(B\)</span>.</p>
<p>The <strong>intersection</strong> of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, denoted <span class="math inline">\(A\cap B\)</span>, is the event of observing <span class="math inline">\(A\)</span> AND <span class="math inline">\(B\)</span>.</p>
<p><span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> are called <strong>mutually exclusive</strong> if they don’t intersect, i.e. they have no outcomes in common.</p>
</div>
<div class="eg">
<p>Let’s see these in an example. Let <span class="math inline">\(X\)</span> again be the result of rolling a fair, 6-sided die with outcomes <span class="math inline">\(1,2,\ldots,6\)</span>.</p>
<p>Let <span class="math inline">\(A\)</span> be the event of observing <span class="math inline">\(X\)</span> to be more than 4, and let <span class="math inline">\(B\)</span> be the event of observing <span class="math inline">\(X\)</span> to be an even number. Then, <span class="math inline">\(A\cap B=\{6\}\)</span> and <span class="math inline">\(A\cup B=\{2,4,5,6\}\)</span>. Note that <span class="math inline">\(1,3\)</span> are in neither <span class="math inline">\(A\)</span> nor <span class="math inline">\(B\)</span>.</p>
<p>Since <span class="math inline">\(A\cap B=\{6\}\)</span> which is NOT empty, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are NOT mutually exclusive. Suppose we define a third event <span class="math inline">\(C\)</span> as observing <span class="math inline">\(X\)</span> to be either <span class="math inline">\(1\)</span> or <span class="math inline">\(3\)</span>. Then, <span class="math inline">\(C\)</span> is mutually exclusive with both <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, since both <span class="math inline">\(A\cap C\)</span> and <span class="math inline">\(B\cap C\)</span> are empty.</p>
</div>
<div id="corollaries" class="section level3" number="10.2.1">
<h3>
<span class="header-section-number">10.2.1</span> Corollaries<a class="anchor" aria-label="anchor" href="#corollaries"><i class="fas fa-link"></i></a>
</h3>
<p>From these axioms, we have a few important corollaries (i.e. derived statements) that are also true:</p>
<ol style="list-style-type: decimal">
<li>Probabilities are always between 0 and 1.
<ul>
<li>Mathematically, for any event <span class="math inline">\(E\)</span>, we have <span class="math inline">\(0\le \p(E)\le1\)</span>
</li>
</ul>
</li>
<li>To get the probability of the “opposite” event, subtract from 1.
<ul>
<li>Mathematically, for any event <span class="math inline">\(E\)</span>, we have <span class="math inline">\(\p(\text{not }E)=1-\p(E)\)</span>.</li>
</ul>
</li>
<li>In general, for any <span class="math inline">\(A,B\)</span>, the probability of <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span> is the probability of <span class="math inline">\(A\)</span> plus <span class="math inline">\(B\)</span> minus the intersection of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. This is the generalized form of the 3<sup>rd</sup> axiom.
<ul>
<li>Mathematically, <span class="math inline">\(\p(A\cup B)=\p(A)+\p(B)-\p(A\cap B)\)</span>.</li>
</ul>
</li>
</ol>
<p>These are not difficult to derive from the axioms, but we omit the proofs for brevity.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;See &lt;a href="https://en.wikipedia.org/wiki/Probability_axioms#Consequences"&gt;here&lt;/a&gt; for details.&lt;/p&gt;'><sup>34</sup></a></p>
<div class="eg">
<p>Here’s an example of how to use these axioms. Suppose in Nice Town, on an average day, there’s a 70% chance it’s sunny, and a 40% chance of a light breeze. Suppose there’s a 20% chance of being neither sunny nor breezy. What’s the probability it’s both sunny and breezy?</p>
<p>Let <span class="math inline">\(S\)</span> represent sunny, and <span class="math inline">\(B\)</span> represent breezy. Then, from the information given, we know <span class="math inline">\(\p(S)=0.7\)</span>, <span class="math inline">\(\p(B)=0.4\)</span>, and <span class="math inline">\(\p(\text{neither \(S\) nor \(B\)})=0.2\)</span>.</p>
<p>By corollary 2, <span class="math inline">\(\p(\text{neither \(S\) nor \(B\)})=1-\p(S\cup B)\)</span>, so we have <span class="math inline">\(\p(S\cup B)=0.8\)</span>.</p>
<p>By corollary 3, <span class="math inline">\(\p(S\cup B)=\p(S)+\p(B)-\p(S\cap B)\)</span>. Rearranging the terms, we get <span class="math inline">\(\p(S\cap B)=\p(S)+\p(B)-\p(S\cup B)=0.7+0.4-0.8=0.3\)</span>. Thus, there’s a 30% chance of it being both sunny and breezy.</p>
</div>
</div>
</div>
<div id="discrete-vs-continuous-rvs" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Discrete vs Continuous RVs<a class="anchor" aria-label="anchor" href="#discrete-vs-continuous-rvs"><i class="fas fa-link"></i></a>
</h2>
<p>Generally, random variables are either <strong>discrete</strong> or <strong>continuous</strong>.</p>
<div class="def">
<p>A <strong>discrete</strong> RV is one whose <strong>outcomes can be listed out one-by-one</strong>. The list is allowed to be infinite.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Formally, &lt;span class="math inline"&gt;\(\Omega\)&lt;/span&gt; must be &lt;a href="https://en.wikipedia.org/wiki/Countable_set"&gt;countable&lt;/a&gt;.&lt;/p&gt;'><sup>35</sup></a></p>
<p>A <strong>continuous</strong> RV is the opposite, where <strong>outcomes are in a continuous range</strong> and not listable.</p>
</div>
<p>In practice, we usually use <strong>discrete RVs to model integer valued outcomes</strong>, e.g. counts of something; and <strong>continuous RVs to model real number valued outcomes</strong>, e.g. lengths/weights/durations. These require slightly different mathematical notations/treatments.</p>
<div id="discrete-pmfs" class="section level3" number="10.3.1">
<h3>
<span class="header-section-number">10.3.1</span> Discrete (PMFs)<a class="anchor" aria-label="anchor" href="#discrete-pmfs"><i class="fas fa-link"></i></a>
</h3>
<p>For discrete RVs, the distribution of outcomes and probabilities is specified with a <strong>probability mass function</strong> (PMF). Note the PMF must satisfy all rules of probability. In particular, all probabilities must be in <span class="math inline">\([0,1]\)</span>, and <span class="math inline">\(\p(\Omega)=\sum_\text{k}\p(k)=1\)</span> where <span class="math inline">\(k\)</span> represents each possible outcome.</p>
<div class="def">
<p>Let <span class="math inline">\(X\)</span> be a discrete RV. The <strong>probability mass function (PMF)</strong> of <span class="math inline">\(X\)</span> is a function <span class="math inline">\(P\)</span> which, for each possible outcome <span class="math inline">\(k\)</span> in the sample space, specifies the probability that <span class="math inline">\(X\)</span> is observed to be <span class="math inline">\(k\)</span>, denoted <span class="math inline">\(\p(X\! =\!k)\)</span>, or sometimes <span class="math inline">\(\p(k)\)</span> for short.</p>
<p>To be a valid PMF, <span class="math inline">\(P\)</span> must satisfy the probability axioms, namely it must always be <strong>non-negative</strong> and <strong>sum to 1</strong> across all possible outcomes in the sample space.</p>
</div>
<p>PMFs can be specified using either a table, function, or plot.</p>
<div id="casino-example" class="eg">
<p>Let <span class="math inline">\(X\)</span> be the number of dollars you win from a new casino game where there’s only 4 possible outcomes: you either win nothing with 40% chance, or you win $1 with 30% chance, or you win $2 with 20% chance, or you win $3 with 10% chance.</p>
<p>First, it’s easy to see the axioms are satisfied, since all probabilities are in <span class="math inline">\([0,1]\)</span> and <span class="math inline">\(0.1+0.2+0.3+0.4=1\)</span>. Thus, this is a valid PMF. We can specify the PMF in any of the following equivalent ways:</p>
<div id="table" class="section level4 unnumbered">
<h4>Table:<a class="anchor" aria-label="anchor" href="#table"><i class="fas fa-link"></i></a>
</h4>
<center>
<pre><code> k | p(k)
---+-----
 0 | 0.4 
 1 | 0.3 
 2 | 0.2 
 3 | 0.1 </code></pre>
</center>
</div>
<div id="function" class="section level4 unnumbered">
<h4>Function:<a class="anchor" aria-label="anchor" href="#function"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[\p(X\! =\!k)=\begin{cases}\frac1{10}\big(4-k\big) &amp; k=0,1,2,3 \\ 0 &amp; \text{otherwise}\end{cases}\]</span></p>
</div>
<div id="plot" class="section level4 unnumbered">
<h4>Plot:<a class="anchor" aria-label="anchor" href="#plot"><i class="fas fa-link"></i></a>
</h4>
<div class="fold s">
<div class="sourceCode" id="cb827"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remember to import tidyverse (and optionally, update theme options)</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">3</span>, p <span class="op">=</span> <span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of X (winnings from made-up casino game)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-1-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
</div>
<div class="eg">
<p>For another example, let <span class="math inline">\(X\)</span> be the sum of rolling 2 ordinary, fair 6-sided dice (independently)<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://www.probabilitycourse.com/chapter1/1_4_1_independence.php"&gt;Independence&lt;/a&gt; has a formal probabilistic definition that’s beyond the scope of 240. You can simply think of it as rolling the dice in a way that doesn’t affect each other.&lt;/p&gt;'><sup>36</sup></a>. What is the PMF of <span class="math inline">\(X\)</span>?</p>
<p>First, note the possible outcomes <span class="math inline">\(k\)</span> in the sample space are the integers <span class="math inline">\(k=2,3,\ldots,12\)</span>. Next, since the dice are fair, we can find the probability of each outcome <span class="math inline">\(k\)</span> by counting the number of combinations that add to <span class="math inline">\(k\)</span>. For example, for <span class="math inline">\(k=5\)</span> the outcomes are 14, 23, 32, and 41. Each outcome has probability 1/36 so summing them we get <span class="math inline">\(\p(X=5)=4\cdot\frac1{36}=\frac19\)</span></p>
<p>From this, you can show the probability for each <span class="math inline">\(k=2,3,\ldots,12\)</span> is <span class="math inline">\(\p(X=k)=(6-|k-7|)/36\)</span>. Thus we can write the PMF as:</p>
<p><span class="math display">\[\p(X\! =\!k)=\begin{cases}\frac1{36}\big(6-|k-7|\big)&amp;k=2,3,\ldots,12\\0&amp;\text{otherwise}\end{cases}\]</span></p>
<p>You can easily check this PMF satisfies the probability axioms. Here’s a plot of this PMF:</p>
<div class="fold s">
<div class="sourceCode" id="cb828"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">12</span>, p <span class="op">=</span> <span class="op">(</span><span class="fl">6</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">k</span><span class="op">-</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">36</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of X (sum of rolling two fair 6-sided dice)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.2</span>,<span class="fl">.02</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-2-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
</div>
<div id="continuous-pdfs" class="section level3" number="10.3.2">
<h3>
<span class="header-section-number">10.3.2</span> Continuous (PDFs)<a class="anchor" aria-label="anchor" href="#continuous-pdfs"><i class="fas fa-link"></i></a>
</h3>
<p>For continuous RVs, distributions are specified with a <strong>probability density function</strong> (PDF). They are similar to PMFs but with a key distinction: <strong>PDFs do NOT output probability of an outcome</strong>, rather it denotes “density” which can be thought of as the rate of change of probability.</p>
<div class="def">
<p>Let <span class="math inline">\(X\)</span> be a continuous RV. The <strong>probability density function (PDF)</strong> of <span class="math inline">\(X\)</span> is a function <span class="math inline">\(P\)</span> which, for each outcome <span class="math inline">\(x\)</span> in the sample space, specifies the density of probability around <span class="math inline">\(x\)</span>.</p>
<p>To be a valid PDF, <span class="math inline">\(P\)</span> must also satisfy the probability axioms, i.e. <span class="math inline">\(P\)</span> must always be <strong>non-negative</strong> and <strong>integrate to 1</strong> across the sample space.</p>
</div>
<div class="note">
<p>This is important enough to warrant repeating: a continuous <strong>PDF does NOT output a probability</strong>! For continuous PDFs, <strong>probabilities ALWAYS correspond to areas under the PDF</strong>.</p>
<p>Also note it’s customary to use <span class="math inline">\(k\)</span> to represent possible outcomes of discrete PMFs, and <span class="math inline">\(x\)</span> to represent possible outcomes of continuous PDFs.</p>
</div>
<p>PDFs are the continuous analog of PMFs, so whenever you might use PMFs in a summation <span class="math inline">\(\sum\)</span> expression, you would switch to a definite integral <span class="math inline">\(\int\)</span> for a PDF. In STAT 240, <strong>we will NOT require you to evaluate these integrals</strong> but we may occasionally show them to familiarize you with the notation. Computations with simple PMFs may be asked however.</p>
<div class="eg">
<p>PDFs can feel strange at first, so here’s an easy example to start. According to the <a href="https://wwwn.cdc.gov/Nchs/Nhanes/2011-2012/BMX_G.htm">2011-12 National Health and Nutrition Examination Survey</a> (NHANES) by the CDC, US adult human height has an approximately normal distribution with mean 65.8 inches and standard deviation 3.98 inches. Below is a plot of the distribution:</p>
<div class="fold s">
<div class="sourceCode" id="cb829"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use geom_function to plot dnorm (the normal PDF function)</span></span>
<span><span class="co"># also plot the mean ± up to 3 standard deviations</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>SDs <span class="op">=</span> <span class="fl">65.8</span> <span class="op">+</span> <span class="op">(</span><span class="op">-</span><span class="fl">3</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">*</span><span class="fl">3.98</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">65.8</span>, <span class="fl">3.98</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">52</span>, <span class="fl">80</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1e3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SDs</span>, xend <span class="op">=</span> <span class="va">SDs</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">SDs</span>, <span class="fl">65.8</span>, <span class="fl">3.98</span><span class="op">)</span><span class="op">)</span>,</span>
<span>               color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, linewidth <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">52</span>, <span class="fl">80</span>, <span class="fl">2</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.10</span>, <span class="fl">0.01</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.001</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"US adult human height distribution"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">'(approx normal w/ mean 65.8", SD 3.98"; SDs shown in dashed)'</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"height (inches)"</span>, y <span class="op">=</span> <span class="st">"probability density"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-3-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>You can easily see the density is non-negative, and with some careful math the area can be shown to be 1. Thus it satisfies the probability axioms.</p>
<p>Remember the density at <span class="math inline">\(x\)</span> is NOT the probability of <span class="math inline">\(x\)</span>. Again, probabilities of events correspond to areas under the curve. For example, one can show that for a normal distribution:</p>
<ul>
<li>Approx. 68% of outcomes are between ±1 standard deviation,</li>
<li>Approx. 95% of outcomes are between ±2 standard deviations,</li>
<li>Approx. 99.7% of outcomes are between ±3 standard deviations.</li>
</ul>
<p>This rule is called the <strong>empirical rule</strong>. For our distribution of heights, this means about 68% of people are between 62 and 70 inches, about 95% are between 58 and 74 inches, etc.</p>
</div>
<div class="eg">
<p>For another example, consider the <strong>uniform distribution</strong> on <span class="math inline">\((0,1)\)</span>. This distribution generalizes rolling a fair die to drawing a number from an interval, where every value inside the interval is equally likely to be selected. Below is a plot of the distribution:</p>
<div class="fold s">
<div class="sourceCode" id="cb830"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use geom_function to plot dunif (the uniform PDF function)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dunif</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.5</span>, <span class="fl">1.5</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1e4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Uniform distribution between 0 and 1"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"probability density"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-4-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>One can also show percentiles are always uniformly distributed, so this is actually a very useful distribution (more on this in STAT 340).</p>
</div>
</div>
</div>
<div id="expectation-variance" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> Expectation &amp; Variance<a class="anchor" aria-label="anchor" href="#expectation-variance"><i class="fas fa-link"></i></a>
</h2>
<div id="expected-value" class="section level3" number="10.4.1">
<h3>
<span class="header-section-number">10.4.1</span> Expected value<a class="anchor" aria-label="anchor" href="#expected-value"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Expected value</strong> refers to the <strong>average value</strong> of some random variable (or function thereof). For a discrete random variable <span class="math inline">\(X\)</span>, the expected value of <span class="math inline">\(X\)</span>—also called <span class="math inline">\(\e(X)\)</span>, <span class="math inline">\(\mu\)</span>, or simply the mean of <span class="math inline">\(X\)</span>—is defined:</p>
<p><span class="math display">\[\mu=\e(X)=\sum_k\,k\cdot \p(X\! =\!k)\]</span></p>
<p>The summation is performed over all possible outcomes <span class="math inline">\(k\)</span> in the sample space. In plain words, the mean is the sum of the product of each outcome with its probability (i.e. a weighted sum using the probabilities as weights). The formula for a continuous variable is similar but with an integral instead of a summation.</p>
<p>The expected value of a function of a random variable <span class="math inline">\(f(X)\)</span> can also be defined, which represents the average value of <span class="math inline">\(f(X)\)</span> :</p>
<p><span class="math display">\[\e\big(f(X)\big)=\sum_k\,f(k)\cdot \p(X\! =\!k)\]</span></p>
<div id="single-die" class="eg">
<p>Again, as a simple example, consider <span class="math inline">\(X\)</span> being rolling a single fair, 6-sided die. Find <span class="math inline">\(\e(X)\)</span>.</p>
<p>If the die is fair, then <span class="math inline">\(\p(X\! =\!k)=1/6\)</span> for all <span class="math inline">\(k=1,2,\ldots,6\)</span>. Then, we get</p>
<p><span class="math display">\[\e(X)=\sum_{k=1}^6\,k\cdot(1/6)=\frac16(1+2+\cdots+6)=\frac{21}6=3.5\]</span></p>
<p>This means the average value of a die roll is 3.5. Note that <strong>the average does NOT need to be a possible observation</strong>! Even though it’s impossible to roll a 3.5, the average of each roll over many rolls is in fact 3.5.</p>
<p>Now consider <span class="math inline">\(f(x)=x^2\)</span>. What is <span class="math inline">\(\e\big(f(X)\big)\)</span>, i.e. the average value of <span class="math inline">\(X^2\)</span>?</p>
<p><span class="math display">\[\e(X^2)=\sum_{k=1}^6\,k^2\cdot(1/6)=\frac16(1+4+\cdots+36)=\frac{91}6\approx15.17\]</span></p>
<p>Thus, the average of the square of a 6-sided die is about 15.17.</p>
</div>
<div id="casino-game2" class="eg">
<p>Let’s reconsider the <a href="intro-to-probability.html#casino-example">casino game example</a> above, where <span class="math inline">\(X\)</span> is the average winnings per game. Find the expected value of <span class="math inline">\(X\)</span>.</p>
<p>Recall the outcomes <span class="math inline">\(0,1,2,3\)</span> have corresponding probabilities <span class="math inline">\(0.4,0.3,0.2,0.1\)</span>. Using the formula, we get</p>
<p><span class="math display">\[\e(X)=0\!\cdot\!(0.4)+1\!\cdot\!(0.3)+2\!\cdot\!(0.2)+3\!\cdot\!(0.1)=0.3+0.4+0.3=1\]</span></p>
<p>Thus, each play on average wins $1. This means if a casino wants to not lose money, they need to charge at least $1 per play.</p>
</div>
</div>
<div id="variance" class="section level3" number="10.4.2">
<h3>
<span class="header-section-number">10.4.2</span> Variance<a class="anchor" aria-label="anchor" href="#variance"><i class="fas fa-link"></i></a>
</h3>
<p>The <strong>variance</strong> of a random variable—also called <span class="math inline">\(\var(X)\)</span> or <span class="math inline">\(\sigma^2\)</span>—can be thought of as the <strong>average squared distance from the mean</strong> and is defined as:</p>
<p><span class="math display">\[\sigma^2=\var(X)=\e\big((X-\mu)^2\big)=\sum_k\,(k\!-\!\mu)^2\cdot \p(X\! =\!k)\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> represents <span class="math inline">\(\e(X)\)</span>. The variance is used as a measure of spread. The higher the variance, the more “spread out” a RV is.</p>
<p>The <strong>standard deviation</strong> of <span class="math inline">\(X\)</span>, often denoted <span class="math inline">\(\sigma\)</span>, is then defined as the <strong>square root of the variance</strong>. This is often more convenient to use in calculations instead of the variance since it has the same units as the data. It can be thought of as the average distance of an observation from the mean.</p>
<div class="eg">
<p>Consider again the previous <a href="intro-to-probability.html#single-die">single, fair 6-sided die example</a>. Find the variance and standard deviation of <span class="math inline">\(X\)</span>.</p>
<p>We found earlier that <span class="math inline">\(\mu=\e(X)=3.5\)</span>. Applying the variance formula gives:</p>
<p><span class="math display">\[\var(X)=\sum_{k=1}^6(k\!-\!3.5)^2\cdot(1/6)=\frac16\big((1\!-\!3.5)^2+\cdots+(6\!-\!3.5)^2\big)=\frac{35}{12}\approx2.92\]</span></p>
<p>So, we found the variance <span class="math inline">\(\sigma^2\approx2.92\)</span>, and thus the standard deviation <span class="math inline">\(\sigma\approx1.71\)</span>.</p>
</div>
<div class="eg">
<p>Let’s consider the <a href="intro-to-probability.html#casino-game2">casino game example</a> a final time. Find the variance and standard deviation of <span class="math inline">\(X\)</span>.</p>
<p>We found earlier <span class="math inline">\(\mu=\e(X)=1\)</span>. Applying the variance formula gives:</p>
<p><span class="math display">\[\var(X)=(0\!-\!1)^2\!\cdot\!(0.4)+(1\!-\!1)^2\!\cdot\!(0.3)+(2\!-\!1)^2\!\cdot\!(0.2)+(3\!-\!1)^2\!\cdot\!(0.1)=1\]</span></p>
<p>Thus, the variance is also <span class="math inline">\(\sigma^2=1\)</span>, and so is the standard deviation <span class="math inline">\(\sigma=1\)</span>.</p>
</div>
</div>
</div>
<div id="binomial-distribution" class="section level2" number="10.5">
<h2>
<span class="header-section-number">10.5</span> Binomial distribution<a class="anchor" aria-label="anchor" href="#binomial-distribution"><i class="fas fa-link"></i></a>
</h2>
<p>The <strong>binomial distribution</strong> is perhaps the most important example of a discrete random variable. It generalizes the idea of the <strong>sum of a sequence of independent, repeated, binary trials</strong>, e.g. the number of heads in a series of coin flips, or the number of patients who respond to an experimental treatment.</p>
<div id="definition" class="section level3" number="10.5.1">
<h3>
<span class="header-section-number">10.5.1</span> Definition<a class="anchor" aria-label="anchor" href="#definition"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose you have <span class="math inline">\(n\)</span> independent trials, each of which has <span class="math inline">\(p\)</span> probability of producing <span class="math inline">\(1\)</span> (called a “success”), and <span class="math inline">\(1-p\)</span> probability of producing <span class="math inline">\(0\)</span> (called a “failure”). Then, the sum of these trials <span class="math inline">\(X\)</span> follows a binomial distribution with parameters <span class="math inline">\(n,p\)</span> or in other words <span class="math inline">\(X\sim\bin(n,p)\)</span>.</p>
<div class="eg">
<p>Suppose we flip a fair coin 10 times and let <span class="math inline">\(X=\)</span> <strong>total number of heads</strong>. Then we can see <span class="math inline">\(X\sim\bin(10,0.5)\)</span>. Below shows a plot of this distribution:</p>
<div class="fold s">
<div class="sourceCode" id="cb831"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use dbinom (the binomial PMF function) to plot distribution</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">10</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">1</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.05</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>                     minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.01</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Binomial(10, 0.5) distribution (number of heads in 10 flips of a fair coin)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"k"</span>, y <span class="op">=</span> <span class="st">"probability"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-5-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<p>The following assumptions in the acronym <strong><em>BINS</em></strong> must hold for a binomial distribution to apply:</p>
<ul>
<li>
<strong><em>B</em></strong>inary outcomes: each individual trial must produce a 1 or 0</li>
<li>
<strong><em>I</em></strong>ndependence: each individual trial must be independent from others (i.e. neither affects nor affected by other trials)</li>
<li>
<strong><em>N</em></strong> fixed: the number of trials <span class="math inline">\(n\)</span> must be a fixed, predetermined quantity, NOT a variable/condition</li>
<li>
<strong><em>S</em></strong>ame probability: each trial must have the same probability <span class="math inline">\(p\)</span> of observing a 1</li>
</ul>
<p>If any of these criteria are not met, the resultant variable will NOT follow a binomial distribution.</p>
</div>
<div id="binom-pmf" class="section level3" number="10.5.2">
<h3>
<span class="header-section-number">10.5.2</span> PMF<a class="anchor" aria-label="anchor" href="#binom-pmf"><i class="fas fa-link"></i></a>
</h3>
<p>First, what is the formula for the PMF of <span class="math inline">\(X\sim\bin(n,p)\)</span>? It can be shown to be the following:</p>
<p><span class="math display">\[\p(X\!=\!k)={n\choose k}p^k(1\!-\!p)^{n-k}\quad\text{for outcomes $k=0,1,\ldots,n$}\]</span></p>
<p><span class="math display">\[\small\text{where}~~{n\choose k}=\dfrac{n!}{k!(n\!-\!k)!}~~~\text{and}~~n!=n\!\times\!(n\!-\!1)\!\times\cdots\!\times\!1\]</span></p>
<ul>
<li>
<span class="math inline">\(n!\)</span> is called “<span class="math inline">\(n\)</span> <a href="https://en.wikipedia.org/wiki/Factorial">factorial</a>” and counts the number of permutations (i.e. ways of ordering) of <span class="math inline">\(n\)</span> distinct objects
<ul>
<li>Note: <span class="math inline">\(0!=1\)</span> by definition</li>
</ul>
</li>
<li>
<span class="math inline">\(n\choose k\)</span> is called “<span class="math inline">\(n\)</span> <a href="https://en.wikipedia.org/wiki/Combination">choose</a> <span class="math inline">\(k\)</span>” and counts the number of ways of choosing <span class="math inline">\(k\)</span> objects from <span class="math inline">\(n\)</span> distinct objects (order of choice doesn’t matter)</li>
</ul>
<p>For example, if you have 5 objects, there are 5×4×3×2×1=120 ways to order them. If you want to choose 2 from the 5, there are 5 choose 2 or 10 different combinations possible.</p>
<div class="sourceCode" id="cb832"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># using R, we can find 5!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">factorial</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 120</code></pre>
<div class="sourceCode" id="cb834"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># as well as 5 choose 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 10</code></pre>
<p>This should help you understand the PMF shown above. The <span class="math inline">\(n\choose k\)</span> counts the number of ways those <span class="math inline">\(k\)</span> successes could have happened out of the <span class="math inline">\(n\)</span> total trials, whereas the <span class="math inline">\(p^k\)</span> and <span class="math inline">\((1-p)^{n-k}\)</span> are respectively the probabilities of having exactly <span class="math inline">\(k\)</span> successes and <span class="math inline">\(n-k\)</span> failures.</p>
<div class="eg">
<p>Let <span class="math inline">\(X\sim\bin(10,0.5)\)</span> again. What is <span class="math inline">\(\p(X=4)\)</span>, i.e. the probability of observing exactly 4 total heads?</p>
<p><span class="math display">\[P(X=4)={10\choose4}0.5^4(1\!-\!0.5)^{10-4}=\frac{10\cdot9\cdot8\cdot7}{4\cdot3\cdot2}\cdot\frac1{2^{10}}=\frac{210}{1024}\approx20.5\%\]</span></p>
<p>We can also use R to help us compute this:</p>
<div class="sourceCode" id="cb836"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># apply the formula</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.5</span><span class="op">^</span><span class="fl">4</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">^</span><span class="fl">6</span></span></code></pre></div>
<pre><code>[1] 0.2050781</code></pre>
<p>This is consistent with the plot of the PMF we previously made. We could also ask what’s the probability of getting 3 or fewer heads total, i.e. <span class="math inline">\(\p(X\le3)\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
P(X\le3)&amp;=P(X\!=\!0)+P(X\!=\!1)+P(X\!=\!2)+P(X\!=\!3)\\
&amp;={\small{10\choose0}0.5^0(1\!-\!0.5)^{10-0}+\cdots+{10\choose3}0.5^3(1\!-\!0.5)^{10-3}}\\
&amp;=\frac{176}{1024}\\
&amp;\approx17.2%
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb838"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute P(X≤3) with vectorization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Special.html">choose</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.5</span><span class="op">^</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">10</span><span class="op">-</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.171875</code></pre>
</div>
</div>
<div id="e-var" class="section level3" number="10.5.3">
<h3>
<span class="header-section-number">10.5.3</span> E &amp; Var<a class="anchor" aria-label="anchor" href="#e-var"><i class="fas fa-link"></i></a>
</h3>
<p>Recall the general expectation and variance definitions from before:</p>
<p><span class="math display">\[
\begin{aligned}
\e(X)&amp;=\sum_k\,k\cdot \p(X\! =\!k)\\
\var(X)&amp;=\sum_k\,(k\!-\!\mu)^2\cdot \p(X\! =\!k)
\end{aligned}
\]</span></p>
<p>You can plug in the binomial PMF for <span class="math inline">\(\p(X\! =\!k)\)</span> and <a href="https://www.probabilisticworld.com/binomial-distribution-mean-variance-formulas-proof">derive</a> the following identities for the binomial distribution:</p>
<p><span class="math display">\[
\text{for binomial,}\quad
\begin{aligned}
\e(X)&amp;=np\\
\var(X)&amp;=np(1\!-\!p)\\
\sd(X)&amp;=\sqrt{\var(X)}=\sqrt{np(1\!-\!p)}
\end{aligned}
\]</span></p>
<div class="eg">
<p>Consider <span class="math inline">\(X\sim\bin(10,0.5)\)</span> again. Compute the expectation &amp; variance using thetheir definitions and check they agree with the identities given above.</p>
<div class="sourceCode" id="cb840"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute expectation using definition</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 5</code></pre>
<div class="sourceCode" id="cb842"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compare with identity E=np</span></span>
<span><span class="fl">10</span> <span class="op">*</span> <span class="fl">0.5</span></span></code></pre></div>
<pre><code>[1] 5</code></pre>
<div class="sourceCode" id="cb844"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute variance using definition</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 2.5</code></pre>
<div class="sourceCode" id="cb846"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compare with identity Var=np(1-p)</span></span>
<span><span class="fl">10</span> <span class="op">*</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 2.5</code></pre>
</div>
</div>
<div id="binom-functions" class="section level3" number="10.5.4">
<h3>
<span class="header-section-number">10.5.4</span> <code>*binom()</code> functions:<a class="anchor" aria-label="anchor" href="#binom-functions"><i class="fas fa-link"></i></a>
</h3>
<p>There are 4 main R functions for working with binomial distributions, <code><a href="https://rdrr.io/r/stats/Binomial.html">dbinom()</a></code>, <code><a href="https://rdrr.io/r/stats/Binomial.html">pbinom()</a></code>, <code><a href="https://rdrr.io/r/stats/Binomial.html">qbinom()</a></code>, and <code><a href="https://rdrr.io/r/stats/Binomial.html">rbinom()</a></code>. We will go over each below.</p>
</div>
<div id="dbinom-pmf" class="section level3" number="10.5.5">
<h3>
<span class="header-section-number">10.5.5</span> <code>dbinom()</code> (PMF)<a class="anchor" aria-label="anchor" href="#dbinom-pmf"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://rdrr.io/r/stats/Binomial.html">dbinom()</a></code> simply implements the PMF equation shown in section <a href="intro-to-probability.html#binom-pmf">10.5.2</a>. In order to compute <span class="math inline">\(\p(X=k)\)</span> for <span class="math inline">\(X\sim\bin(n,p)\)</span>, simply do <code>dbinom(k, n, p)</code>.</p>
<div class="sourceCode" id="cb848"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check the computation earlier for P(X=4) where X~Bin(10,0.5)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.2050781</code></pre>
<div class="sourceCode" id="cb850"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># show the probability of every possible outcome</span></span>
<span><span class="co"># (this is how the PMF was plotted earlier)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code> [1] 0.001 0.010 0.044 0.117 0.205 0.246 0.205 0.117 0.044 0.010 0.001</code></pre>
<p>Here’s the plot of the PMF again for <span class="math inline">\(n=10\)</span>, <span class="math inline">\(p=0.5\)</span>.</p>
<div class="sourceCode" id="cb852"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use dbinom (the binomial PMF function) to plot distribution</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">10</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.05</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>                     minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.01</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Binomial(10, 0.5) PMF"</span>, x <span class="op">=</span> <span class="st">"k"</span>, y <span class="op">=</span> <span class="st">"probability"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-11-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="pbinom-cdf" class="section level3" number="10.5.6">
<h3>
<span class="header-section-number">10.5.6</span> <code>pbinom()</code> (CDF)<a class="anchor" aria-label="anchor" href="#pbinom-cdf"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://rdrr.io/r/stats/Binomial.html">pbinom()</a></code> is what’s called the binomial’s <strong>cumulative distribution function</strong> or <strong>CDF</strong>, which finds the <strong>probability of getting less than or equal to a given input</strong>. To find <span class="math inline">\(\p(X\le k)\)</span> for <span class="math inline">\(X\sim\bin(n,p)\)</span>, you can do <code>pbinom(k, n, p)</code>.</p>
<div class="sourceCode" id="cb853"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check the computation earlier for P(X≤3) where X~Bin(10,0.5)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.171875</code></pre>
<div class="sourceCode" id="cb855"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># another way</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.171875</code></pre>
<p>Note that <code>1-pbinom(k, n, p)</code> can also give you <span class="math inline">\(\p(X&gt;k)\)</span>.</p>
<div class="sourceCode" id="cb857"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example: find P(X&gt;7) where X~Bin(10,0.5)</span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.0546875</code></pre>
<p>Here’s a plot of the binomial CDF for <span class="math inline">\(n=10\)</span>, <span class="math inline">\(p=0.5\)</span>. Note the stepwise nature of the function, since this is a discrete distribution and cumulative probabilities increase in discrete “steps” at the possible values of <span class="math inline">\(k\)</span>.</p>
<p>Also note the CDF always goes from 0 on the left to 1 on the right, and can never decrease as you move from left to right; it can only increase or stay the same.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;this property is called &lt;strong&gt;monotonically increasing&lt;/strong&gt;, see other properties of the CDF &lt;a href="https://www.geeksforgeeks.org/engineering-mathematics/cumulative-distribution-function/#properties-of-cumulative-distribution-function"&gt;here&lt;/a&gt; if you want to learn more.&lt;/p&gt;'><sup>37</sup></a></p>
<div class="fold s">
<div class="sourceCode" id="cb859"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1e4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.005</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Binomial(10, 0.5) CDF"</span>, x <span class="op">=</span> <span class="st">"k"</span>, y <span class="op">=</span> <span class="st">"probability"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-14-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="qbinom-inverse-cdf" class="section level3" number="10.5.7">
<h3>
<span class="header-section-number">10.5.7</span> <code>qbinom()</code> (inverse CDF)<a class="anchor" aria-label="anchor" href="#qbinom-inverse-cdf"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://rdrr.io/r/stats/Binomial.html">qbinom()</a></code> is the inverse function of the CDF, i.e. it does the opposite. For a given probability <span class="math inline">\(p\)</span>, it finds the <strong>smallest <span class="math inline">\(k\)</span></strong> such that <span class="math inline">\(\p(X\le k)\ge p\)</span>. It’s also called the <strong>quantile function</strong> since it is used to compute what observation <span class="math inline">\(k\)</span> is at a given percentile <span class="math inline">\(p\)</span>.</p>
<div class="sourceCode" id="cb860"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># what observation is at the 17.1%-ile of X~Bin(10,0.5)?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">qbinom</a></span><span class="op">(</span><span class="fl">0.171</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 3</code></pre>
<div class="sourceCode" id="cb862"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># what if we "cross" the value of P(X≤3) and ask for the 17.2%-ile?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">qbinom</a></span><span class="op">(</span><span class="fl">0.172</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 4</code></pre>
<p>Here’s a plot of the binomial inverse CDF for <span class="math inline">\(n=10\)</span>, <span class="math inline">\(p=0.5\)</span>, note it’s the reflection of the CDF across the <span class="math inline">\(y=x\)</span> diagonal line. For discrete distributions, like the binomial the inverse CDF is also a stepwise function.</p>
<div class="fold s">
<div class="sourceCode" id="cb864"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">qbinom</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1e4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.005</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Binomial(10, 0.5) inverse CDF"</span>, x <span class="op">=</span> <span class="st">"probability"</span>, y <span class="op">=</span> <span class="st">"k"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-16-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="rbinom-random-generator" class="section level3" number="10.5.8">
<h3>
<span class="header-section-number">10.5.8</span> <code>rbinom()</code> (random generator)<a class="anchor" aria-label="anchor" href="#rbinom-random-generator"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://rdrr.io/r/stats/Binomial.html">rbinom()</a></code> is the random generator function, which allows to simulate drawing random samples from a binomial distribution. This can be useful in simulation studies, empirical computations, etc.</p>
<div class="sourceCode" id="cb865"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># draw a sample of size 100 from Bin(10,0.5)</span></span>
<span><span class="va">samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">samp</span></span></code></pre></div>
<pre><code>  [1] 4 4 5 7 4 7 7 6 6 3 4 4 6 5 6 5 6 9 5 6 7 4 6 3 4 5 2 5 7 4 5 5 5 4 6 6 6 3 6 5
 [41] 6 6 6 5 5 6 2 5 6 6 5 7 5 4 3 3 4 5 6 5 7 4 5 4 6 4 5 6 3 7 4 7 4 4 5 7 7 5 6 8
 [81] 5 6 5 4 6 4 6 3 4 3 4 3 6 7 6 6 5 5 6 5</code></pre>
<div class="sourceCode" id="cb867"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># what are the mean and SD in our sample?</span></span>
<span><span class="co"># these should be close to the theoretical E &amp; SD</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 5.14</code></pre>
<div class="sourceCode" id="cb869"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 1.325888</code></pre>
<div class="sourceCode" id="cb871"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a histogram of our sample</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">samp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>, center <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span>, <span class="fl">5</span><span class="op">)</span>, minor_breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">30</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of 100 observations sampled from Bin(10,0.5)"</span>, x <span class="op">=</span> <span class="st">"k"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-17-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="normal-distribution" class="section level2" number="10.6">
<h2>
<span class="header-section-number">10.6</span> Normal distribution<a class="anchor" aria-label="anchor" href="#normal-distribution"><i class="fas fa-link"></i></a>
</h2>
<p>The <strong>normal distribution</strong> is definitely the most important of the continuous distributions, and perhaps the most important in all of statistics. It’s named “normal” due to it being ubiquitous throughout nature, showing up everywhere we look, hence it’s the “normal” distribution we encounter.</p>
<p>The specific circumstances which give rise to a normal distribution have to do with something called the <a href="https://en.wikipedia.org/wiki/Central_limit_theorem">Central Limit Theorem</a> which we will revisit later, but as an extremely oversimplified summary, normal distributions often appear when an observation can be viewed as the <strong>sum or average of many smaller, independent processes</strong>.</p>
<div id="definition-pdf" class="section level3" number="10.6.1">
<h3>
<span class="header-section-number">10.6.1</span> Definition &amp; PDF<a class="anchor" aria-label="anchor" href="#definition-pdf"><i class="fas fa-link"></i></a>
</h3>
<p>The normal distribution is <strong>parametrized</strong> (i.e. specified) by two parameters: <strong>the mean <span class="math inline">\(\mu\)</span> and the standard deviation <span class="math inline">\(\sigma\)</span></strong>, which are so named because they are the mean and SD of the population. If <span class="math inline">\(X\)</span> follows such a distribution, we also write <span class="math inline">\(X\sim\n(\mu,\sigma)\)</span>.</p>
<p>Given these parameters, the PDF of the normal is given by the following equation:</p>
<p><span class="math display">\[f(x) = \frac1{\sigma\sqrt{2\pi}}\,e^{-\frac12\left(\frac{x-\mu}\sigma\right)^2}\]</span></p>
<p>This expression produces the familiarly shaped “bell curve” distribution we all know and love. For example, IQ scores are standardized to have mean 100 and SD 15 in the general population. Below is shown the corresponding normal curve for this distribution:</p>
<div class="fold s">
<div class="sourceCode" id="cb872"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">55</span>, <span class="fl">145</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">SDs</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">SDs</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                        color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1e3</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">150</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">55</span>, <span class="fl">145</span>, <span class="fl">15</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span>, minor_breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.004</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"N(100, 15) distribution (standardized IQ scores)"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"(mean shown in blue, SDs shown in red)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"score"</span>, y <span class="op">=</span> <span class="st">"probability density"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-18-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>Recall from earlier that since this is a continuous random variable, the <strong>PDF does NOT plot the probability, but rather the probability <em>density</em></strong>! Probabilities of events should instead always be interpreted as corresponding areas under the curve!</p>
</div>
<div id="empirical-rule" class="section level3" number="10.6.2">
<h3>
<span class="header-section-number">10.6.2</span> Empirical rule<a class="anchor" aria-label="anchor" href="#empirical-rule"><i class="fas fa-link"></i></a>
</h3>
<p>For normal distributions, it can be shown that:</p>
<ul>
<li>About 68% of the values will be between ±1 SD of the mean,</li>
<li>About 95% of the values will be between ±2 SDs of the mean,</li>
<li>About 99.7% of the values will be between ±3 SDs of the mean.</li>
</ul>
<p>This is called the <strong>empirical rule</strong> of the normal and is useful for roughly approximating what you’d observe based on the parameters.</p>
<div class="eg">
<p>Using the <span class="math inline">\(X\sim\n(100,15)\)</span> model of IQ scores, approximately what percent of people would you expect to score in the following ranges?</p>
<ol style="list-style-type: decimal">
<li>85 to 115</li>
<li>70 to 130</li>
<li>85 to 130</li>
<li>Less than 70</li>
<li>Greater than 145</li>
</ol>
<p>Using the empirical rule, we know 68% would fall between 85 to 115 (±1 SD), and 95% would fall between 70 to 130 (±2 SDs).</p>
<p>Using symmetry, we know from 85-100 is 68%/2 or 34%, and 100-130 is 95%/2 or 47.5%. Thus, 85-130 covers about 81.5% of the distribution.</p>
<p>We know 70-130 covers about 95% from the empirical rule, which means &lt;70 or &gt;130 must be 5%. By symmetry, &lt;70 must be half that or 2.5%.</p>
<p>Again using the empirical rule, we know 55 to 145 covers about 99.7%, which means &lt;55 or &gt;145 makes up about 0.3%. By symmetry again, we know that &gt;145 must be around 0.15%.</p>
</div>
</div>
<div id="e-var-1" class="section level3" number="10.6.3">
<h3>
<span class="header-section-number">10.6.3</span> E &amp; Var<a class="anchor" aria-label="anchor" href="#e-var-1"><i class="fas fa-link"></i></a>
</h3>
<p>As you’d expect from definition, the expectation and variance are equal to <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span>.</p>
<p><span class="math display">\[
\text{for normal,}\quad
\begin{aligned}
\e(X)&amp;=\mu\\
\var(X)&amp;=\sigma^2\\
\sd(X)&amp;=\sqrt{\var(X)}=\sigma
\end{aligned}
\]</span></p>
</div>
<div id="norm-functions" class="section level3" number="10.6.4">
<h3>
<span class="header-section-number">10.6.4</span> <code>*norm()</code> functions:<a class="anchor" aria-label="anchor" href="#norm-functions"><i class="fas fa-link"></i></a>
</h3>
<p>There are also 4 main R functions for working with normal distributions, <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code>, <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code>, <code><a href="https://rdrr.io/r/stats/Normal.html">qnorm()</a></code>, and <code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code>. They are each the continuous analogs of the <code>*binom()</code> functions.</p>
</div>
<div id="dnorm-pdf" class="section level3" number="10.6.5">
<h3>
<span class="header-section-number">10.6.5</span> <code>dnorm()</code> (PDF)<a class="anchor" aria-label="anchor" href="#dnorm-pdf"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code> is the normal PDF (probability density function), which was plotted just above. Remember the PDF does NOT represent the probability of a certain outcome, but rather the <em>probability density</em>, which is akin to the rate of change of probability around that point. For us, the main use case of <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code> is to show a plot of the PDF.</p>
<div class="sourceCode" id="cb873"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># what's the density at the mean of N(100,15)?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.02659615</code></pre>
<div class="sourceCode" id="cb875"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># replot the N(100,15) PDF</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">150</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">55</span>, <span class="fl">145</span>, <span class="fl">15</span><span class="op">)</span>, minor_breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"N(100, 15) PDF"</span>, x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"probability density"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-19-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="pnorm-cdf" class="section level3" number="10.6.6">
<h3>
<span class="header-section-number">10.6.6</span> <code>pnorm()</code> (CDF)<a class="anchor" aria-label="anchor" href="#pnorm-cdf"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code> is the normal CDF (cumulative distribution function), which finds the <strong>probability less than or equal to a given input</strong>. This function is extremely useful for computing probabilities of ranges under the normal curve, e.g. to compute <span class="math inline">\(\p(X\le k)\)</span> when <span class="math inline">\(X\sim\n(\mu,\sigma)\)</span>, simply do <code>pnorm(k, µ, σ)</code>.</p>
<p>Note that to find the probability <span class="math inline">\(\p(a&lt;X\le b)\)</span>, we can do <code>pnorm(a, µ, σ) - pnorm(b, µ, σ)</code>. Together with remebering the area under the entire curve is 1 just like any other RV, we can check the probabilities of each range in the previous example:</p>
<div class="sourceCode" id="cb876"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>  <span class="co"># find the probability an observation from X~N(100,15) falls in each range:</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">115</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">85</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span>,   <span class="co"># between 85-115</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">130</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">70</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span>,   <span class="co"># between 70-130</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">130</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">85</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span>,   <span class="co"># between 85-130</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">70</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span>,                         <span class="co"># less than 70</span></span>
<span>  <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">145</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span>                     <span class="co"># greater than 145</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.6827 0.9545 0.8186 0.0228 0.0013</code></pre>
<div class="note">
<p>Due to the way probabilities work for continuous variables (they’re always areas of ranges under the curve), you can show the probability of observing a single number<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;or technically any other set with &lt;a href="https://en.wikipedia.org/wiki/Lebesgue_measure"&gt;measure&lt;/a&gt; 0, or in other words having 0-length&lt;/p&gt;'><sup>38</sup></a> has probability 0. More specifically, for any number <span class="math inline">\(a\)</span>, <span class="math inline">\(\p(X=a)=0\)</span>.</p>
<p>This may seem strange, but if you try to imagine the area the single number <span class="math inline">\(a\)</span> “bounds” under the curve, it makes a line, which has no area. This does not mean <span class="math inline">\(a\)</span> is impossible to observe as an outcome<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;technically, it’s only &lt;a href="https://en.wikipedia.org/wiki/Almost_surely"&gt;“almost impossible”&lt;/a&gt;&lt;/p&gt;'><sup>39</sup></a>, we just can’t meaningfully assign a probability to it due to the way probabilities have to be defined for continuous RVs.</p>
<p>A consequence of this is that for continuous variables, <span class="math inline">\(&lt;\)</span> and <span class="math inline">\(\le\)</span> are interchangeable, as well as <span class="math inline">\(&gt;\)</span> and <span class="math inline">\(\ge\)</span>. In other words, you don’t need to worry about counting or not counting “boundaries” of ranges when doing math with probabilities over different intervals.</p>
</div>
<p>Below is a plot of the normal CDF for <span class="math inline">\(\mu=100\)</span>, <span class="math inline">\(\sigma=15\)</span>. Again note as you move from left to right, the CDF goes from 0 to 1 and never decreases.</p>
<div class="fold s">
<div class="sourceCode" id="cb878"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">55</span>, <span class="fl">145</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1e3</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">55</span>, <span class="fl">145</span>, <span class="fl">15</span><span class="op">)</span>, minor_breaks <span class="op">=</span> <span class="cn">NULL</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.002</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"N(100, 15) CDF"</span>, x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"probability"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-21-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="qnorm-inverse-cdf" class="section level3" number="10.6.7">
<h3>
<span class="header-section-number">10.6.7</span> <code>qnorm()</code> (inverse CDF)<a class="anchor" aria-label="anchor" href="#qnorm-inverse-cdf"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://rdrr.io/r/stats/Normal.html">qnorm()</a></code> is the inverse CDF or the quantile function for the normal. Since the normal distribution is continuous (unlike the binomial), the inverse CDF here works a little simpler. For a given probability <span class="math inline">\(p\)</span>, it finds the <span class="math inline">\(k\)</span> such that <span class="math inline">\(\p(X\le k)=p\)</span>.</p>
<div class="sourceCode" id="cb879"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># what observation is at the 90%-ile of X~N(100,15)?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 119.2233</code></pre>
<div class="sourceCode" id="cb881"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we can also check that P(X≤119.2233) = 90% (up to rounding)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">119.2233</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.9000003</code></pre>
<p>Below is a plot of the normal inverse CDF for <span class="math inline">\(\mu=100\)</span>, <span class="math inline">\(\sigma=15\)</span>, again note it’s the reflection of the CDF across the <span class="math inline">\(y=x\)</span> diagonal line.</p>
<div class="fold s">
<div class="sourceCode" id="cb883"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1e3</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.002</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">55</span>, <span class="fl">145</span>, <span class="fl">15</span><span class="op">)</span>, minor_breaks <span class="op">=</span> <span class="cn">NULL</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"N(100, 15) inverse CDF"</span>, x <span class="op">=</span> <span class="st">"probability"</span>, y <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-23-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="rnorm-random-generator" class="section level3" number="10.6.8">
<h3>
<span class="header-section-number">10.6.8</span> <code>rnorm()</code> (random generator)<a class="anchor" aria-label="anchor" href="#rnorm-random-generator"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> is the normal random generator function, which simulates drawing random samples from a normal distribution.</p>
<div class="sourceCode" id="cb884"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># draw a sample of size 80 from N(100,15)</span></span>
<span><span class="va">samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">samp</span></span></code></pre></div>
<pre><code> [1] 105.97159  90.81960 105.11680  83.05955 121.49536 129.70600  94.49168  84.33798
 [9] 108.54579  97.97418 136.02427  99.41140 110.34609 100.42003  88.85090 102.83188
[17]  72.92562 121.98332 102.29880 132.58918 107.13264  89.35080 109.16090  85.98854
[25]  81.19550 104.37169  93.35062 100.01658 101.11512  91.15719  91.46997  97.97232
[33] 117.67130  77.14650 108.90919 104.99426 115.94650  95.43724 105.55028 104.00648
[41]  91.86220 118.11802 117.40604 110.50320 123.80250 108.37730  80.85112  91.40102
[49]  81.63081  92.89899  90.69450 100.63174  86.33618 102.37043  90.18123 126.50931
[57] 110.75061 113.65261 105.76278 125.23264  90.46395  93.07533 121.48423  90.23955
[65]  96.88929  94.10788  95.20011  95.81330 107.41282  97.34004  92.41064 120.14558
[73]  96.78131  97.30665  98.49714 110.68999  98.89653  99.43549  89.77509  95.13595</code></pre>
<div class="sourceCode" id="cb886"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># again, we can check our sample mean/sd are close to theory</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 101.5152</code></pre>
<div class="sourceCode" id="cb888"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 13.28363</code></pre>
<div class="sourceCode" id="cb890"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a histogram of our sample</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">samp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">5</span>, boundary <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of 80 observations sampled from N(100,15)"</span>, x <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-24-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="aside-normality-qq-plots" class="section level3" number="10.6.9">
<h3>
<span class="header-section-number">10.6.9</span> Aside: Normality &amp; QQ-plots<a class="anchor" aria-label="anchor" href="#aside-normality-qq-plots"><i class="fas fa-link"></i></a>
</h3>
<p>Sometimes you may wish to evalute the normality of a given sample, i.e. see if the normal distribution is a good “fit” for your data. A very common and easy way to do this is to make what’s called a quantile-quantile plot or <strong>QQ plot</strong>. Basically, you plot the quantiles in your sample vs theoretical normal quantiles<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;For more details, see &lt;a href="https://www.r-bloggers.com/2020/08/q-q-plots-and-worm-plots-from-scratch"&gt;this page&lt;/a&gt;&lt;/p&gt;'><sup>40</sup></a>. This is one of the few plots I prefer to make using base R, since it’s significantly easier.</p>
<div class="i6">
<div class="sourceCode" id="cb891"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pch=20 is the dumb base R way of using dots as point markers,</span></span>
<span><span class="co"># see https://r-charts.com/base-r/pch-symbols for more info</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">samp</span>,pch<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-26-1.svg" width="480" style="display: block; margin: auto;"></div>
</div>
<p>The interpretation is also simple: <strong>the more linear the QQ plot, the more normal the sample</strong>. With smaller samples, you of course expect more variation than larger samples. Often you can even tell in what way is the sample non-normal, see <a href="https://stats.stackexchange.com/a/101290">this post</a> for a more in-depth discussion on how to read QQ plots.</p>
</div>
</div>
<div id="standard-normal-n01" class="section level2" number="10.7">
<h2>
<span class="header-section-number">10.7</span> Standard Normal <span class="math inline">\(\n(0,1)\)</span><a class="anchor" aria-label="anchor" href="#standard-normal-n01"><i class="fas fa-link"></i></a>
</h2>
<p>An important member of the normal family is the <strong>standard normal</strong>, which is usually denoted <span class="math inline">\(Z\)</span> and has mean <span class="math inline">\(\mu=0\)</span> and SD <span class="math inline">\(\sigma=1\)</span>. In other words, <span class="math inline">\(Z\sim\n(0,1)\)</span>.</p>
<p>The standard normal is important because it serves as a <strong>reference</strong> distribution, to which all other normal distributions can be compared. This is because it turns out <strong>every normal distribution is <em>similar</em> to each other</strong>, i.e. has the same shape, up to axes scaling. For example, in the plot below, the 3 distributions appear to have different shapes:</p>
<div class="fold s">
<div class="sourceCode" id="cb892"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normals_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, n <span class="op">=</span> <span class="fl">1e3</span>, color <span class="op">=</span> <span class="st">"red3"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">0.5</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1e3</span>, color <span class="op">=</span> <span class="st">"seagreen"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1e3</span>, color <span class="op">=</span> <span class="st">"navy"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="op">-</span><span class="fl">5</span><span class="op">:</span><span class="fl">10</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Plot of 3 normals: N(0,1), N(-3,0.5), N(5,2)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"probability density"</span><span class="op">)</span></span>
<span><span class="va">normals_plot</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-27-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>However, if you take the exact same plot and simply zoom in to each curve, you can see in fact they are all the exact same shape, up to axes scaling.</p>
<div class="i96 fold s">
<div class="sourceCode" id="cb893"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">normals_plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4.5</span>, <span class="op">-</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Same plot, zoomed to N(-3,0.5)"</span>, y <span class="op">=</span> <span class="cn">NULL</span>, x <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">normals_plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Same plot, zoomed to N(0,1)"</span>, y <span class="op">=</span> <span class="cn">NULL</span>, x <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="va">normals_plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">11</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Same plot, zoomed to N(5,2)"</span>, y <span class="op">=</span> <span class="cn">NULL</span>, x <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-28-1.svg" width="864" style="display: block; margin: auto;"></div>
</div>
<p>A consequence of this is that <strong>any problem involving an arbitrary normal distribution <span class="math inline">\(X\sim\n(\mu,\sigma)\)</span> can be turned into an <em>equivalent</em> problem for the standard normal <span class="math inline">\(Z\sim\n(0,1)\)</span></strong> by simply applying a transformation that converts <span class="math inline">\(X\)</span> into <span class="math inline">\(Z\)</span>. This is called <strong>standardization</strong>, or computing a <strong>Z-score</strong>.</p>
<div id="z-score" class="section level3" number="10.7.1">
<h3>
<span class="header-section-number">10.7.1</span> Z-score<a class="anchor" aria-label="anchor" href="#z-score"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose you draw an observation <span class="math inline">\(x\)</span> from a normal population with mean <span class="math inline">\(\mu\)</span> and SD <span class="math inline">\(\sigma\)</span>. The Z-score of <span class="math inline">\(x\)</span> is defined as:</p>
<p><span class="math display">\[z=\frac{x-\mu}\sigma\]</span></p>
<p>Then, solving the same problem but using <span class="math inline">\(z\)</span> and the standard normal is equivalent to solving the original problem.</p>
<div class="eg">
<p>Continuing with the IQ example, suppose you’re asked to find the percent of the population with IQ score less than 115. In other words, you want to find <span class="math inline">\(\p(X&lt;115)\)</span> where <span class="math inline">\(X\sim\n(100,15)\)</span>. We can do the following:</p>
<div class="i6">
<div class="sourceCode" id="cb894"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use pnorm() to get area to the left of 115</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">115</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.8413447</code></pre>
<div class="sourceCode" id="cb896"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># showing this area on a quick plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">55</span>, <span class="fl">145</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">100</span>, <span class="fl">15</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">55</span>, <span class="fl">115</span><span class="op">)</span>,</span>
<span>                geom <span class="op">=</span> <span class="st">"area"</span>, fill <span class="op">=</span> <span class="st">"red4"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Plot showing P(X&lt;115) where X~N(100,15)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-29-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>Using the Z-score approach, we have</p>
<p><span class="math display">\[z=\frac{x-\mu}\sigma=\frac{115-100}{15}=1\]</span></p>
<p>Thus, this problem is equivalent to asking what’s <span class="math inline">\(\p(Z&lt;1)\)</span> where again <span class="math inline">\(Z\sim\n(0,1)\)</span> is the standard normal:</p>
<div class="i6">
<div class="sourceCode" id="cb897"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pnorm() defaults to mean 0 SD 1, i.e. standard normal, if not specified</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.8413447</code></pre>
<div class="sourceCode" id="cb899"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># showing the same equivalent area on a plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">dnorm</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, geom <span class="op">=</span> <span class="st">"area"</span>, fill <span class="op">=</span> <span class="st">"red4"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Plot showing P(Z&lt;1) where Z~N(0,1)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-30-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>Note how these two areas exactly correspond, so solving one solves the other.</p>
</div>
<p>Since we have R, we won’t need to rely on Z-scores as much, however it’s an important concept to normal curves, and also shows up later when discussing inference, e.g. test statistics during hypothesis testing.</p>
</div>
</div>
<div id="normal-approx.-of-binomial" class="section level2" number="10.8">
<h2>
<span class="header-section-number">10.8</span> Normal approx. of binomial<a class="anchor" aria-label="anchor" href="#normal-approx.-of-binomial"><i class="fas fa-link"></i></a>
</h2>
<p>One more topic before chapter end; <strong>under certain circumstances, the binomial distribution is well-approximated by the normal</strong>. Before computers, this was extremely useful since areas under the normal curve are much easier to find with a normal table than summing many bars on a binomial ditribution, especially for large <span class="math inline">\(n\)</span>. These days, it’s still useful as a teaching exercise as well as an example of the <a href="https://en.wikipedia.org/wiki/Central_limit_theorem">central limit theorem</a>.</p>
<p>Usually, the condition for this approximation to be considered good enough is that <strong>both <span class="math inline">\(np\)</span> and <span class="math inline">\(n(1\!-\!p)\)</span> must be <span class="math inline">\(&gt;5\)</span></strong>. Note this necessarily implies <span class="math inline">\(n&gt;10\)</span>, otherwise it’s impossible for both to be true.</p>
<p>If the condition is satisfied, we approximate <span class="math inline">\(X\sim\bin(n,p)\)</span> by picking a normal with the same <span class="math inline">\(\mu=np\)</span> and <span class="math inline">\(\sigma=\sqrt{np(1\!-\!p)}\)</span>.</p>
<p>For example, suppose <span class="math inline">\(n=15\)</span>, <span class="math inline">\(p=0.4\)</span>. One can check <span class="math inline">\(np=6\)</span>, <span class="math inline">\(n(1\!-\!p)=9\)</span> so the approximation should hold well here. We pick a normal with <span class="math inline">\(\mu=6\)</span> and <span class="math inline">\(\sigma\approx1.9\)</span> to match the binomial:</p>
<div class="fold s">
<div class="sourceCode" id="cb900"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">15</span> ; <span class="va">p</span> <span class="op">=</span> <span class="fl">0.4</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">15</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">n</span>,<span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">1</span>, fill<span class="op">=</span><span class="cn">NA</span>, color<span class="op">=</span><span class="st">"black"</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">n</span><span class="op">*</span><span class="va">p</span>,<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span>, linewidth<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Approximation of Bin(15,0.4) using N(6,1.9) which has same µ,σ"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-31-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>This approximation only gets better and better the higher <span class="math inline">\(n\)</span> is (assuming <span class="math inline">\(p\)</span> isn’t extremely close to 0 or 1). For another example, suppose <span class="math inline">\(n=150\)</span>, <span class="math inline">\(p=0.75\)</span>. It should be obvious the condition is more than satisfied here. We pick a normal with <span class="math inline">\(\mu=105\)</span> and <span class="math inline">\(\sigma=5.6\)</span> to match the binomial and observe this approximation is an even better fit than the previous example:</p>
<div class="fold s">
<div class="sourceCode" id="cb901"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">150</span> ; <span class="va">p</span> <span class="op">=</span> <span class="fl">0.7</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">80</span><span class="op">:</span><span class="fl">130</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">n</span>,<span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">1</span>, fill<span class="op">=</span><span class="cn">NA</span>, color<span class="op">=</span><span class="st">"black"</span>, linewidth<span class="op">=</span><span class="fl">.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">n</span><span class="op">*</span><span class="va">p</span>,<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Approximation of Bin(150,0.7) using N(105,5.6) which has same µ,σ"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-32-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="continuity-correction" class="section level3" number="10.8.1">
<h3>
<span class="header-section-number">10.8.1</span> Continuity correction<a class="anchor" aria-label="anchor" href="#continuity-correction"><i class="fas fa-link"></i></a>
</h3>
<p>Again, before computers, the normal approximation was extremely useful here for computing areas under the binomial distribution. Suppose we consider again <span class="math inline">\(X\sim\bin(15,0.4)\)</span> and suppose we’re interested in computing <span class="math inline">\(\p(X\le5)\)</span> using our normal approximation <span class="math inline">\(X\;\approx\;Y\!\sim\!\n(6,1.9)\)</span>. In other words, we’re interested in finding the light blue area:</p>
<div class="fold s">
<div class="sourceCode" id="cb902"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">15</span> ; <span class="va">p</span> <span class="op">=</span> <span class="fl">0.4</span> ; <span class="va">mu</span> <span class="op">=</span> <span class="va">n</span><span class="op">*</span><span class="va">p</span> ; <span class="va">sigma</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">15</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">n</span>,<span class="va">p</span><span class="op">)</span>, c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">F</span>,<span class="cn">T</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">c</span><span class="op">)</span>, width<span class="op">=</span><span class="fl">1</span>, color<span class="op">=</span><span class="st">"black"</span>, linewidth<span class="op">=</span><span class="fl">1</span>, alpha<span class="op">=</span><span class="fl">.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"white"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span>, linewidth<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"P(X≤5) where X~Bin(15,0.4), i.e. probability of 5 or fewer successes"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-33-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>Note that in order to approximate this light blue area well, we should actually find <span class="math inline">\(\p(Y&lt;5.5)\)</span> i.e. this light red area:</p>
<div class="fold s">
<div class="sourceCode" id="cb903"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">15</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">n</span>,<span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">1</span>, fill<span class="op">=</span><span class="cn">NA</span>, color<span class="op">=</span><span class="st">"black"</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span>, linewidth<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span>, geom<span class="op">=</span><span class="st">"area"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5.5</span><span class="op">)</span>, fill<span class="op">=</span><span class="st">"red"</span>, alpha<span class="op">=</span><span class="fl">.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Approximate P(X≤5) where X~Bin(15,0.4) with P(Y&lt;5.5) where Y~N(6,1.9)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-34-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>This is called the <strong>continuity correction</strong>, where we adjust our evaluation region under the normal by <span class="math inline">\(\pm0.5\)</span> based on if we’re counting the bars towards the left or right side (if we’re starting somewhere and counting bars towards the left, we <span class="math inline">\(+0.5\)</span> to our bound; otherwise if we’re starting somewhere and counting bars towards the right, we <span class="math inline">\(-0.5\)</span> to our bound, e.g. for <span class="math inline">\(\p(X\ge5)\)</span>, we’d find <span class="math inline">\(\p(Y&gt;4.5)\)</span>).</p>
<p>We can easily check this correction significantly improves our approximation:</p>
<div class="sourceCode" id="cb904"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define parameters and mu,sigma</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">15</span> ; <span class="va">p</span> <span class="op">=</span> <span class="fl">0.4</span> ; <span class="va">mu</span> <span class="op">=</span> <span class="va">n</span><span class="op">*</span><span class="va">p</span> ; <span class="va">sigma</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># exact area P(X≤5)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">5</span>,<span class="va">n</span>,<span class="va">p</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.4032156</code></pre>
<div class="sourceCode" id="cb906"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># normal approx P(Y&lt;5) without continuity correction (~26% error)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">5</span>,<span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.2990807</code></pre>
<div class="sourceCode" id="cb908"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># normal approx P(Y&lt;5.5) with continuity correction (~2% error)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">5.5</span>,<span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.3960737</code></pre>
<p>As a final example, keeping the same <span class="math inline">\(X,Y\)</span>, suppose we wish to find <span class="math inline">\(\p(5\le X\le9)\)</span>, i.e. this blue area:</p>
<div class="fold s">
<div class="sourceCode" id="cb910"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">15</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">n</span>,<span class="va">p</span><span class="op">)</span>, c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">T</span>,<span class="cn">F</span>,<span class="cn">T</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">c</span><span class="op">)</span>, width<span class="op">=</span><span class="fl">1</span>, color<span class="op">=</span><span class="st">"black"</span>, linewidth<span class="op">=</span><span class="fl">1</span>, alpha<span class="op">=</span><span class="fl">.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"white"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span>, linewidth<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"P(5≤X≤9) where X~Bin(15,0.4)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-36-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>Applying the continuity correction on either side, we see we need <span class="math inline">\(\p(4.5&lt;Y&lt;9.5)\)</span>, i.e. this red area:</p>
<div class="fold s">
<div class="sourceCode" id="cb911"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">15</span> ; <span class="va">p</span> <span class="op">=</span> <span class="fl">0.4</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">15</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">n</span>,<span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">1</span>, fill<span class="op">=</span><span class="cn">NA</span>, color<span class="op">=</span><span class="st">"black"</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span>, linewidth<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span>, geom<span class="op">=</span><span class="st">"area"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.5</span>,<span class="fl">9.5</span><span class="op">)</span>, fill<span class="op">=</span><span class="st">"red"</span>, alpha<span class="op">=</span><span class="fl">.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Approx. P(5≤X≤9) where X~Bin(15,0.4) with P(4.5&lt;Y&lt;9.5) where Y~N(6,1.9)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-probability_files/figure-html/unnamed-chunk-37-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<div class="sourceCode" id="cb912"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># exact area P(5≤X≤9) = P(X≤9)-P(X≤4)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">9</span>,<span class="va">n</span>,<span class="va">p</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">4</span>,<span class="va">n</span>,<span class="va">p</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.748889</code></pre>
<div class="sourceCode" id="cb914"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># normal approx P(5&lt;Y&lt;9) without continuity correction (~14% error)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">9</span>,<span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">5</span>,<span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.6439961</code></pre>
<div class="sourceCode" id="cb916"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># normal approx P(4.5&lt;Y&lt;9.5) with continuity correction (~0.5% error)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">9.5</span>,<span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">4.5</span>,<span class="va">mu</span>,<span class="va">sigma</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.752859</code></pre>
<!--

future ideas: add

 - brief CLT??

-->

</div>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@xiee/utils/js/external-link.min.js" defer></script><script>
  $(function(){
    $(".note").addClass("alert alert-warning");
  });
  $(function(){
    $(".tip").addClass("alert alert-success");
  });
  $(function(){
    $(".def").addClass("alert alert-info");
  });
  $(function(){
    $(".eg").addClass("alert alert-secondary");
  });
  $(function(){
    $(".col-lg-3").addClass("col-lg-2").removeClass("col-lg-3");
  });
  $(function(){
    $(".col-lg-7").addClass("col-lg-8").removeClass("col-lg-7");
  });
</script><!-- https://stackoverflow.com/a/37839683/25278020 --><script>
  $(document).ready(function() {

  $chunks = $('.fold');

  $chunks.each(function () {

    // add button to source code chunks
    if ( $(this).hasClass('s') ) {
      $('pre.r', this).prepend("<div class=\"showopt\">Show Source</div><br style=\"line-height:22px;\"/>");
      $('pre.r', this).children('code').attr('class', 'folded');
    }

    // add button to output chunks
    if ( $(this).hasClass('o') ) {
      $('pre:not(.r)', this).has('code').prepend("<div class=\"showopt\">Show Output</div><br style=\"line-height:22px;\"/>");
      $('pre:not(.r)', this).children('code:not(r)').addClass('folded');

      // add button to plots
      $(this).find('img').wrap('<pre class=\"plot\"></pre>');
      $('pre.plot', this).prepend("<div class=\"showopt\">Show Plot</div><br style=\"line-height:22px;\"/>");
      $('pre.plot', this).children('img').addClass('folded');

    }
  });

  // hide all chunks when document is loaded
  $('.folded').css('display', 'none')

  // function to toggle the visibility
  $('.showopt').click(function() {
    var label = $(this).html();
    if (label.indexOf("Show") >= 0) {
      $(this).html(label.replace("Show", "Hide"));
    } else {
      $(this).html(label.replace("Hide", "Show"));
    }
    $(this).siblings('code, img').slideToggle('fast', 'swing');
  });
});

</script><!-- https://www.tutorialrepublic.com/faq/how-to-change-href-attribute-of-a-hyperlink-using-jquery.php--><script>
  $(document).ready(function(){
    $("a.anchorjs-link").each(function(){
      var oldUrl = $(this).attr("href"); // Get current url
      var newUrl = oldUrl.replace(/^#(\d+-)+/,"#"); // Create new url
      $(this).attr("href", "#" + $(this).closest("div").attr("id"));  // Set href value
      $(this).attr("title", location.protocol + "//" + location.host + location.pathname + $(this).attr("href")); // Set title value
    });
  });
</script><!-- https://stackoverflow.com/a/10415599/25278020 --><script>
  var observer = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
        if (mutation.addedNodes && mutation.addedNodes.length > 0) {
            // element added to DOM
            var hasClass = [].some.call(mutation.addedNodes, function(el) {
                return el.classList.contains('bs-popover-top')
            });
            if (hasClass) {
              $("div.bs-popover-top a").each(function(){
                $(this).attr("target", "_blank");
              });
          }
        }
    });
});

var config = {
    attributes: true,
    childList: true,
    characterData: true
};

observer.observe(document.body, config);
</script><!--https://stackoverflow.com/a/49025957--><script>
  $(function() {
  $('a[class="footnote-ref"][data-toggle="popover"]').popover()
})

$('body')
  .on('mousedown', '.popover', function(e) {
    console.log("clicked inside popover")
    e.preventDefault()
  });
</script><div class="chapter-nav">
<div class="prev"><a href="overview.html"><span class="header-section-number">9</span> Overview</a></div>
<div class="next"><a href="sampling-inference.html"><span class="header-section-number">11</span> Sampling &amp; Inference</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#intro-to-probability"><span class="header-section-number">10</span> Intro to Probability</a></li>
<li><a class="nav-link" href="#random-variables-rvs"><span class="header-section-number">10.1</span> Random variables (RVs)</a></li>
<li>
<a class="nav-link" href="#axioms-of-probability"><span class="header-section-number">10.2</span> Axioms of probability</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#corollaries"><span class="header-section-number">10.2.1</span> Corollaries</a></li></ul>
</li>
<li>
<a class="nav-link" href="#discrete-vs-continuous-rvs"><span class="header-section-number">10.3</span> Discrete vs Continuous RVs</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#discrete-pmfs"><span class="header-section-number">10.3.1</span> Discrete (PMFs)</a></li>
<li><a class="nav-link" href="#continuous-pdfs"><span class="header-section-number">10.3.2</span> Continuous (PDFs)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#expectation-variance"><span class="header-section-number">10.4</span> Expectation &amp; Variance</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#expected-value"><span class="header-section-number">10.4.1</span> Expected value</a></li>
<li><a class="nav-link" href="#variance"><span class="header-section-number">10.4.2</span> Variance</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#binomial-distribution"><span class="header-section-number">10.5</span> Binomial distribution</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#definition"><span class="header-section-number">10.5.1</span> Definition</a></li>
<li><a class="nav-link" href="#binom-pmf"><span class="header-section-number">10.5.2</span> PMF</a></li>
<li><a class="nav-link" href="#e-var"><span class="header-section-number">10.5.3</span> E &amp; Var</a></li>
<li><a class="nav-link" href="#binom-functions"><span class="header-section-number">10.5.4</span> *binom() functions:</a></li>
<li><a class="nav-link" href="#dbinom-pmf"><span class="header-section-number">10.5.5</span> dbinom() (PMF)</a></li>
<li><a class="nav-link" href="#pbinom-cdf"><span class="header-section-number">10.5.6</span> pbinom() (CDF)</a></li>
<li><a class="nav-link" href="#qbinom-inverse-cdf"><span class="header-section-number">10.5.7</span> qbinom() (inverse CDF)</a></li>
<li><a class="nav-link" href="#rbinom-random-generator"><span class="header-section-number">10.5.8</span> rbinom() (random generator)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#normal-distribution"><span class="header-section-number">10.6</span> Normal distribution</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#definition-pdf"><span class="header-section-number">10.6.1</span> Definition &amp; PDF</a></li>
<li><a class="nav-link" href="#empirical-rule"><span class="header-section-number">10.6.2</span> Empirical rule</a></li>
<li><a class="nav-link" href="#e-var-1"><span class="header-section-number">10.6.3</span> E &amp; Var</a></li>
<li><a class="nav-link" href="#norm-functions"><span class="header-section-number">10.6.4</span> *norm() functions:</a></li>
<li><a class="nav-link" href="#dnorm-pdf"><span class="header-section-number">10.6.5</span> dnorm() (PDF)</a></li>
<li><a class="nav-link" href="#pnorm-cdf"><span class="header-section-number">10.6.6</span> pnorm() (CDF)</a></li>
<li><a class="nav-link" href="#qnorm-inverse-cdf"><span class="header-section-number">10.6.7</span> qnorm() (inverse CDF)</a></li>
<li><a class="nav-link" href="#rnorm-random-generator"><span class="header-section-number">10.6.8</span> rnorm() (random generator)</a></li>
<li><a class="nav-link" href="#aside-normality-qq-plots"><span class="header-section-number">10.6.9</span> Aside: Normality &amp; QQ-plots</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#standard-normal-n01"><span class="header-section-number">10.7</span> Standard Normal \(\n(0,1)\)</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#z-score"><span class="header-section-number">10.7.1</span> Z-score</a></li></ul>
</li>
<li>
<a class="nav-link" href="#normal-approx.-of-binomial"><span class="header-section-number">10.8</span> Normal approx. of binomial</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#continuity-correction"><span class="header-section-number">10.8.1</span> Continuity correction</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/bwu62/stat240-revamp/blob/master/10-probability.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/bwu62/stat240-revamp/edit/master/10-probability.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>STAT 240 Revamp</strong>" was written by Bi Cheng Wu, with help from Bret Larget and Cameron Jones. It was last built on 2025-11-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
