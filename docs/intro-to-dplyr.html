<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Intro to dplyr | STAT 240 Revamp</title>
<meta name="author" content="Bi Cheng Wu, with help from Bret Larget and Cameron Jones">
<meta name="description" content="dplyr is the core Tidyverse package for transforming and your raw datasets into a clean and usable format (link to cheat sheet). Its functions are versatile, performant, and have a consistent and...">
<meta name="generator" content="bookdown 0.40.1 with bs4_book()">
<meta property="og:title" content="Chapter 7 Intro to dplyr | STAT 240 Revamp">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bwu62.github.io/stat240-revamp/intro-to-dplyr.html">
<meta property="og:description" content="dplyr is the core Tidyverse package for transforming and your raw datasets into a clean and usable format (link to cheat sheet). Its functions are versatile, performant, and have a consistent and...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 Intro to dplyr | STAT 240 Revamp">
<meta name="twitter:description" content="dplyr is the core Tidyverse package for transforming and your raw datasets into a clean and usable format (link to cheat sheet). Its functions are versatile, performant, and have a consistent and...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Roboto_Mono-0.4.9/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.4/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-E0YDB40HWY"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-E0YDB40HWY');
    </script><link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
<link rel="manifest" href="icons/site.webmanifest">
<link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<!-- https://www.bryanbraun.com/anchorjs/ --><script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script><script>
      // Add anchors on DOMContentLoaded
    document.addEventListener('DOMContentLoaded', function(event) {
      anchors.add('h1');
      anchors.add();
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">STAT 240 Revamp</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome!</a></li>
<li><a class="" href="setup.html"><span class="header-section-number">1</span> Setup</a></li>
<li class="book-part">R crash course</li>
<li><a class="" href="rstudio-intro.html"><span class="header-section-number">2</span> Intro to R/Rstudio</a></li>
<li><a class="" href="data-vectors.html"><span class="header-section-number">3</span> Data Vectors</a></li>
<li><a class="" href="data-frames.html"><span class="header-section-number">4</span> Data Frames</a></li>
<li><a class="" href="data-exploration.html">Data Exploration</a></li>
<li><a class="" href="descriptive.html"><span class="header-section-number">5</span> Descriptive Statistics</a></li>
<li><a class="" href="data-visualization.html"><span class="header-section-number">6</span> Data Visualization</a></li>
<li><a class="" href="data-transformation.html">Data Transformation</a></li>
<li><a class="active" href="intro-to-dplyr.html"><span class="header-section-number">7</span> Intro to dplyr</a></li>
<li><a class="" href="advanced-operations.html"><span class="header-section-number">8</span> Advanced Operations</a></li>
<li><a class="" href="data-modeling.html">Data Modeling</a></li>
<li><a class="" href="overview.html"><span class="header-section-number">9</span> Overview</a></li>
<li><a class="" href="intro-to-probability.html"><span class="header-section-number">10</span> Intro to Probability</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="datasets.html"><span class="header-section-number">A</span> Datasets</a></li>
<li><a class="" href="cheat-sheets.html"><span class="header-section-number">B</span> Cheat Sheets</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/bwu62/stat240-revamp">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="intro-to-dplyr" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Intro to dplyr<a class="anchor" aria-label="anchor" href="#intro-to-dplyr"><i class="fas fa-link"></i></a>
</h1>
<p><a href="https://dplyr.tidyverse.org">dplyr</a> is the core Tidyverse package for transforming and your raw datasets into a clean and usable format (<a href="https://rstudio.github.io/cheatsheets/data-transformation.pdf">link to cheat sheet</a>). Its functions are versatile, performant, and have a consistent and user friendly syntax. These traits make it highly suitable for data science at all levels.</p>
<div class="sourceCode" id="cb587"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import all core tidyverse packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co"># optional: change default print to 5 rows to save vertical space, and</span></span>
<span><span class="co">#           disable showing col_types by default in readr import functions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>pillar.print_min <span class="op">=</span> <span class="fl">5</span>, readr.show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># optional: change default ggplot theme options (personal preference)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"https://bwu62.github.io/stat240-revamp/ggplot_theme_options.R"</span><span class="op">)</span></span></code></pre></div>
<div id="syntax-design" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Syntax design<a class="anchor" aria-label="anchor" href="#syntax-design"><i class="fas fa-link"></i></a>
</h2>
<p>First, I think it’s important to briefly comment on the syntax design of dplyr to avoid confusion later on. All functions covered in this chapter satisfy the following design principles:</p>
<ol style="list-style-type: decimal">
<li>Functions in dplyr are designed to <strong>only work on data frames</strong>, not other objects (e.g. vectors).
<ul>
<li>To run on a vector, it must first be wrapped inside a data frame (see section <a href="data-frames.html#creating-dfs">4.1</a>).</li>
</ul>
</li>
<li>Functions in dplyr are all <strong>able to be run with pipes</strong> like <code>%&gt;%</code> or <code>|&gt;</code> (more on this soon).</li>
<li>Functions in dplyr, <strong>do NOT modify the input</strong>, so you must always manually save the output.</li>
</ol>
</div>
<div id="pipes" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Pipes<a class="anchor" aria-label="anchor" href="#pipes"><i class="fas fa-link"></i></a>
</h2>
<p>All dplyr functions are setup so that <strong>the first argument is the input data frame</strong>. In other words, they’re always run like <code>f(df, ...)</code> where <code>f</code> is some dplyr function, <code>df</code> is the data frame you wish to operate on, and <code>...</code> can be further arguments. This also applies to most other Tidyverse functions, e.g. recall the first argument to <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> must also be a data frame.</p>
<p>This design makes it easy to <strong>chain many functions together with pipes</strong> <code>%&gt;%</code> and <code>|&gt;</code>, which are <a href="https://www.tidyverse.org/blog/2023/04/base-vs-magrittr-pipe">basically the same</a> and both used to <strong>pass the left-side expression as the first argument to a function</strong>. In this class, we will stick to <code>%&gt;%</code> for consistency, but you can use <code>|&gt;</code> if you prefer. For example,</p>
<ul>
<li>
<code>x %&gt;% f</code> is equivalent to <code>f(x)</code>
</li>
<li>
<code>x %&gt;% f(y)</code> is equivalent to <code>f(x, y)</code><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;These examples come from the &lt;a href="https://magrittr.tidyverse.org/index.html#usage"&gt;magrittr help page&lt;/a&gt;.&lt;/p&gt;'><sup>26</sup></a>
</li>
</ul>
<p>Why is this useful? Suppose you start with a data frame <code>df</code> and want to run the functions <code>f</code>, <code>g</code>, and <code>h</code> on it in order. You can of course do the following:</p>
<pre><code>h(g(f(df)))</code></pre>
<p>but this quickly becomes awkward, due to the many nested parentheticals. A much cleaner syntax is to use <code>%&gt;%</code> to pipe <code>df</code> from one function to the next, resulting in this much cleaner equivalent syntax:</p>
<pre><code>df %&gt;% f %&gt;% g %&gt;% h</code></pre>
<p>This is not only much neater but also significantly easier to modify and debug. You can also easily specify additional arguments. For example, suppose <code>f</code>, <code>g</code>, and <code>h</code> need the additional arguments <code>a = 1</code>, <code>b = 2</code>, and <code>c = 3</code> in order. Compare these two equivalent syntax options:</p>
<pre><code>h(g(f(df, a = 1), b = 2), c = 3)</code></pre>
<pre><code>df %&gt;% f(a = 1) %&gt;% g(b = 2) %&gt;% g(c = 3)</code></pre>
<p>As long as each function in the chain accepts a data frame as the first argument AND outputs a data frame as the result, you can string together as many functions as you need to perform several data operations in a single step.</p>
<div class="tip">
<p>The <a href="https://magrittr.tidyverse.org/index.html#usage">magrittr help page</a> has some additional usage tips for <code>%&gt;%</code>, such as how to pass the left side to a different argument position, using <code>%&gt;%</code> to create simple functions, and other <a href="https://magrittr.tidyverse.org/articles/magrittr.html#additional-pipe-operators">advanced pipes</a>. These are outside the scope of this course, so read at your own discretion!</p>
</div>
</div>
<div id="data-example" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Data example<a class="anchor" aria-label="anchor" href="#data-example"><i class="fas fa-link"></i></a>
</h2>
<p>For now, we’re going to continue using the Palmer penguins dataset <a href="https://bwu62.github.io/stat240-revamp/data/penguins.csv"><code>penguins.csv</code></a> as an example data frame. Let’s load the data in:</p>
<div class="sourceCode" id="cb592"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load in the familiar penguins dataset</span></span>
<span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://bwu62.github.io/stat240-revamp/data/penguins.csv"</span><span class="op">)</span></span>
<span><span class="co"># print the first few rows of the data frame to check</span></span>
<span><span class="co"># again this data frame is too wide, and some columns are cut off</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">penguins</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 8
  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Adelie  Torgersen           39.1          18.7               181        3750 male  
2 Adelie  Torgersen           39.5          17.4               186        3800 female
3 Adelie  Torgersen           40.3          18                 195        3250 female
4 Adelie  Torgersen           36.7          19.3               193        3450 female
5 Adelie  Torgersen           39.3          20.6               190        3650 male  
# ℹ 328 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
</div>
<div id="column-wise-functions" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Column-wise functions<a class="anchor" aria-label="anchor" href="#column-wise-functions"><i class="fas fa-link"></i></a>
</h2>
<p>We begin with the column-wise dplyr functions, i.e. the functions that primarily focus on manipulating columns in certain ways. There are many of these, but 4 of the most important are the following:</p>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> for selecting a subset of columns to work with,</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> for renaming columns,</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> for both editing and adding columns, <strong>without reducing the number of rows</strong>,</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> for computing data summaries, often using <strong>statistical functions</strong> like mean, median, sd, etc. and results in <strong>reducing the number of rows</strong>.</li>
</ul>
<div id="select" class="section level3" number="7.4.1">
<h3>
<span class="header-section-number">7.4.1</span> <code>select()</code><a class="anchor" aria-label="anchor" href="#select"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> is used to subset columns in a data frame and is often one of the first operations used after loading in a dataset (to remove columns unnecessary for your analysis).</p>
<p>It has a very flexible syntax: you can use subset either by numeric position, by name, by ranges, by exclusion, or even using special <a href="https://tidyselect.r-lib.org/reference/starts_with.html">selector functions</a>. It can also be used to reorder columns. Here are a few examples:</p>
<div class="sourceCode" id="cb594"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select just species, sex, flipper length, and body mass</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">sex</span>, <span class="va">flipper_length_mm</span>, <span class="va">body_mass_g</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 4
  species sex    flipper_length_mm body_mass_g
  &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;       &lt;dbl&gt;
1 Adelie  male                 181        3750
2 Adelie  female               186        3800
3 Adelie  female               195        3250
4 Adelie  female               193        3450
5 Adelie  male                 190        3650
# ℹ 328 more rows</code></pre>
<div class="sourceCode" id="cb596"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># note this is syntactically equivalent to the following:</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="va">species</span>, <span class="va">sex</span>, <span class="va">flipper_length_mm</span>, <span class="va">body_mass_g</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 4
  species sex    flipper_length_mm body_mass_g
  &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;       &lt;dbl&gt;
1 Adelie  male                 181        3750
2 Adelie  female               186        3800
3 Adelie  female               195        3250
4 Adelie  female               193        3450
5 Adelie  male                 190        3650
# ℹ 328 more rows</code></pre>
<div class="sourceCode" id="cb598"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># you can also select by position, or with a range, or both</span></span>
<span><span class="co"># e.g. we can select the 1st, 3rd to 5th, and year columns:</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, <span class="va">year</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 5
  species bill_length_mm bill_depth_mm flipper_length_mm  year
  &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt; &lt;dbl&gt;
1 Adelie            39.1          18.7               181  2007
2 Adelie            39.5          17.4               186  2007
3 Adelie            40.3          18                 195  2007
4 Adelie            36.7          19.3               193  2007
5 Adelie            39.3          20.6               190  2007
# ℹ 328 more rows</code></pre>
<div class="sourceCode" id="cb600"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># you can also use ranges with names</span></span>
<span><span class="co"># e.g. select from 1st to island, then body mass to last col</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">island</span>, <span class="va">body_mass_g</span><span class="op">:</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 5
  species island    body_mass_g sex     year
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 Adelie  Torgersen        3750 male    2007
2 Adelie  Torgersen        3800 female  2007
3 Adelie  Torgersen        3250 female  2007
4 Adelie  Torgersen        3450 female  2007
5 Adelie  Torgersen        3650 male    2007
# ℹ 328 more rows</code></pre>
<div class="sourceCode" id="cb602"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># you can also select by excluding specific columns with !</span></span>
<span><span class="co"># e.g. select everything except island and everything after body mass</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">island</span>, <span class="op">-</span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">:</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="va">body_mass_g</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 5
  species bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
  &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt;
1 Adelie            39.1          18.7               181        3750
2 Adelie            39.5          17.4               186        3800
3 Adelie            40.3          18                 195        3250
4 Adelie            36.7          19.3               193        3450
5 Adelie            39.3          20.6               190        3650
# ℹ 328 more rows</code></pre>
<div class="sourceCode" id="cb604"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select with selector functions, see ?starts_with help page for details,</span></span>
<span><span class="co"># you can also use &amp; as AND, | as OR, ! as NOT during selection</span></span>
<span><span class="co"># e.g. get cols that start with "s", or end with "mm" or "g",</span></span>
<span><span class="co">#      but do NOT contain "length" anywhere in the name</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"s"</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">ends_with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mm"</span>, <span class="st">"g"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"length"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 4
  species sex    bill_depth_mm body_mass_g
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;       &lt;dbl&gt;
1 Adelie  male            18.7        3750
2 Adelie  female          17.4        3800
3 Adelie  female          18          3250
4 Adelie  female          19.3        3450
5 Adelie  male            20.6        3650
# ℹ 328 more rows</code></pre>
<div class="sourceCode" id="cb606"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># notice in all examples above, columns are always returned in order</span></span>
<span><span class="co"># select() can therefore also be used to reorder columns</span></span>
<span><span class="co"># e.g. move year, island, species, sex cols in front of everything else</span></span>
<span><span class="co">#      (here, everything() selects all the other cols in original order)</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">island</span>, <span class="va">species</span>, <span class="va">sex</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 8
   year island    species sex    bill_length_mm bill_depth_mm flipper_length_mm
  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;
1  2007 Torgersen Adelie  male             39.1          18.7               181
2  2007 Torgersen Adelie  female           39.5          17.4               186
3  2007 Torgersen Adelie  female           40.3          18                 195
4  2007 Torgersen Adelie  female           36.7          19.3               193
5  2007 Torgersen Adelie  male             39.3          20.6               190
# ℹ 328 more rows
# ℹ 1 more variable: body_mass_g &lt;dbl&gt;</code></pre>
<div class="note">
<p>Here it’s worth reminding that <code>df %&gt;% select(...)</code> <strong>does NOT modify the original input <code>df</code></strong>, instead it effectively makes a copy of <code>df</code> and runs on that instead. Example:</p>
<div class="sourceCode" id="cb608"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># show starting data frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 8
  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Adelie  Torgersen           39.1          18.7               181        3750 male  
2 Adelie  Torgersen           39.5          17.4               186        3800 female
3 Adelie  Torgersen           40.3          18                 195        3250 female
4 Adelie  Torgersen           36.7          19.3               193        3450 female
5 Adelie  Torgersen           39.3          20.6               190        3650 male  
# ℹ 328 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb610"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select a subset of columns</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">flipper_length_mm</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 2
  species flipper_length_mm
  &lt;chr&gt;               &lt;dbl&gt;
1 Adelie                181
2 Adelie                186
3 Adelie                195
4 Adelie                193
5 Adelie                190
# ℹ 328 more rows</code></pre>
<div class="sourceCode" id="cb612"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check original input is unchanged</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 8
  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Adelie  Torgersen           39.1          18.7               181        3750 male  
2 Adelie  Torgersen           39.5          17.4               186        3800 female
3 Adelie  Torgersen           40.3          18                 195        3250 female
4 Adelie  Torgersen           36.7          19.3               193        3450 female
5 Adelie  Torgersen           39.3          20.6               190        3650 male  
# ℹ 328 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<p>If you want to save the result of <code>df %&gt;% select(...)</code> you must <strong>manually save the output with <code>&lt;-</code></strong>. In general, we always recommend saving to a NEW object instead of overwriting the original object because this is non-destructive (i.e. does not lose any data) and less likely to create code errors later on. It’s also easier to debug.</p>
<div class="sourceCode" id="cb614"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># saving to a new object with a descriptive name is ALWAYS recommended!</span></span>
<span><span class="va">penguins_fewcols</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">flipper_length_mm</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">penguins_fewcols</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 2
  species flipper_length_mm
  &lt;chr&gt;               &lt;dbl&gt;
1 Adelie                181
2 Adelie                186
3 Adelie                195
4 Adelie                193
5 Adelie                190
# ℹ 328 more rows</code></pre>
<div class="sourceCode" id="cb616"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># overwriting the original input is STRONGLY discouraged</span></span>
<span><span class="co"># because it's destructive and often causes problems later</span></span>
<span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">flipper_length_mm</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 2
  species flipper_length_mm
  &lt;chr&gt;               &lt;dbl&gt;
1 Adelie                181
2 Adelie                186
3 Adelie                195
4 Adelie                193
5 Adelie                190
# ℹ 328 more rows</code></pre>
<div class="sourceCode" id="cb618"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># reload data frame since we need it for other examples</span></span>
<span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://bwu62.github.io/stat240-revamp/data/penguins.csv"</span><span class="op">)</span></span></code></pre></div>
<p><strong>This note applies to all functions on this page</strong>, i.e. all of them do NOT modify the input, so desired <strong>changes must always be manually saved</strong>!</p>
</div>
</div>
<div id="rename" class="section level3" number="7.4.2">
<h3>
<span class="header-section-number">7.4.2</span> <code>rename()</code><a class="anchor" aria-label="anchor" href="#rename"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> is used to rename columns. This is another common operation right after loading a dataset. Examples:</p>
<div class="sourceCode" id="cb619"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># rename species as species_name, and island as island_name</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>species_name <span class="op">=</span> <span class="va">species</span>, island_name <span class="op">=</span> <span class="va">island</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 8
  species_name island_name bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
  &lt;chr&gt;        &lt;chr&gt;                &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt;
1 Adelie       Torgersen             39.1          18.7               181        3750
2 Adelie       Torgersen             39.5          17.4               186        3800
3 Adelie       Torgersen             40.3          18                 195        3250
4 Adelie       Torgersen             36.7          19.3               193        3450
5 Adelie       Torgersen             39.3          20.6               190        3650
# ℹ 328 more rows
# ℹ 2 more variables: sex &lt;chr&gt;, year &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb621"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if you want to use irregular names, i.e. names with spaces or symbols,</span></span>
<span><span class="co"># you must surround them with " " quotes</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"Bill Length (mm)"</span> <span class="op">=</span> <span class="va">bill_length_mm</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 8
  species island `Bill Length (mm)` bill_depth_mm flipper_length_mm body_mass_g sex  
  &lt;chr&gt;   &lt;chr&gt;               &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;
1 Adelie  Torge…               39.1          18.7               181        3750 male 
2 Adelie  Torge…               39.5          17.4               186        3800 fema…
3 Adelie  Torge…               40.3          18                 195        3250 fema…
4 Adelie  Torge…               36.7          19.3               193        3450 fema…
5 Adelie  Torge…               39.3          20.6               190        3650 male 
# ℹ 328 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb623"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if you have a data frame with an extremely long and awkward name,</span></span>
<span><span class="co"># you can also use selector functions to help you rename it</span></span>
<span><span class="co"># (see ?starts_with help page for more details/examples)</span></span>
<span><span class="va">df_badname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>  <span class="st">"Really long (and awkward) name with !@#$% symbols"</span> <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">6</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df_badname</span></span></code></pre></div>
<pre><code># A tibble: 3 × 2
      x `Really long (and awkward) name with !@#$% symbols`
  &lt;int&gt;                                               &lt;int&gt;
1     1                                                   4
2     2                                                   5
3     3                                                   6</code></pre>
<div class="sourceCode" id="cb625"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_badname</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"Really"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">ends_with</a></span><span class="op">(</span><span class="st">"symbols"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 3 × 2
      x     y
  &lt;int&gt; &lt;int&gt;
1     1     4
2     2     5
3     3     6</code></pre>
<p>This is outside our scope, but you can also apply a function to many/all columns using <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with()</a></code>. For example:</p>
<div class="sourceCode" id="cb627"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span><span class="va">toupper</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 8
  SPECIES ISLAND    BILL_LENGTH_MM BILL_DEPTH_MM FLIPPER_LENGTH_MM BODY_MASS_G SEX   
  &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Adelie  Torgersen           39.1          18.7               181        3750 male  
2 Adelie  Torgersen           39.5          17.4               186        3800 female
3 Adelie  Torgersen           40.3          18                 195        3250 female
4 Adelie  Torgersen           36.7          19.3               193        3450 female
5 Adelie  Torgersen           39.3          20.6               190        3650 male  
# ℹ 328 more rows
# ℹ 1 more variable: YEAR &lt;dbl&gt;</code></pre>
</div>
<div id="mutate" class="section level3" number="7.4.3">
<h3>
<span class="header-section-number">7.4.3</span> <code>mutate()</code><a class="anchor" aria-label="anchor" href="#mutate"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> is used to either change an existing column, or add new columns. It’s an easy function to introduce but a tough one to master. The basic syntax is <code>df %&gt;% mutate(col1 = expr1, col2 = expr2, ...)</code> where <code>col1</code>, <code>col2</code>, … are the columns being changed/added (depending on if it already exists) and <code>expr1</code>, <code>expr2</code>, … are some R expressions.</p>
<p>The key thing to remember is the expressions can be <strong>any vector computation using one or more columns in the data frame that produces a vector of the same length OR a single value</strong> (which gets recycled).</p>
<p>For convenience, let’s select just a few columns to continue with the demonstration:</p>
<div class="sourceCode" id="cb629"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins2</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">sex</span>, <span class="va">bill_length_mm</span>, <span class="va">bill_depth_mm</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">penguins2</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 4
  species sex    bill_length_mm bill_depth_mm
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;
1 Adelie  male             39.1          18.7
2 Adelie  female           39.5          17.4
3 Adelie  female           40.3          18  
4 Adelie  female           36.7          19.3
5 Adelie  male             39.3          20.6
# ℹ 328 more rows</code></pre>
<p>Now, here’s a few example applications of <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> using <code>penguins2</code></p>
<div class="sourceCode" id="cb631"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we can easily add columns of constants</span></span>
<span><span class="va">penguins2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>study <span class="op">=</span> <span class="st">"Palmer"</span>, century <span class="op">=</span> <span class="fl">21</span>, true <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 7
  species sex    bill_length_mm bill_depth_mm study  century true 
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;lgl&gt;
1 Adelie  male             39.1          18.7 Palmer      21 TRUE 
2 Adelie  female           39.5          17.4 Palmer      21 TRUE 
3 Adelie  female           40.3          18   Palmer      21 TRUE 
4 Adelie  female           36.7          19.3 Palmer      21 TRUE 
5 Adelie  male             39.3          20.6 Palmer      21 TRUE 
# ℹ 328 more rows</code></pre>
<div class="sourceCode" id="cb633"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we can also change existing columns using the same syntax,</span></span>
<span><span class="co"># e.g. we can capitalize and abbreviate sex to M and F</span></span>
<span><span class="va">penguins2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 4
  species sex   bill_length_mm bill_depth_mm
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;         &lt;dbl&gt;
1 Adelie  M               39.1          18.7
2 Adelie  F               39.5          17.4
3 Adelie  F               40.3          18  
4 Adelie  F               36.7          19.3
5 Adelie  M               39.3          20.6
# ℹ 328 more rows</code></pre>
<div class="sourceCode" id="cb635"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we can also use multiple columns in expressions</span></span>
<span><span class="co"># e.g. we can roughly estimate the volume of each bill,</span></span>
<span><span class="co"># see: https://allisonhorst.github.io/palmerpenguins/#bill-dimensions</span></span>
<span><span class="va">penguins2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>bill_vol_mm3 <span class="op">=</span> <span class="va">pi</span> <span class="op">*</span> <span class="op">(</span><span class="va">bill_depth_mm</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">bill_length_mm</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 5
  species sex    bill_length_mm bill_depth_mm bill_vol_mm3
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;
1 Adelie  male             39.1          18.7       10739.
2 Adelie  female           39.5          17.4        9393.
3 Adelie  female           40.3          18         10255.
4 Adelie  female           36.7          19.3       10737.
5 Adelie  male             39.3          20.6       13098.
# ℹ 328 more rows</code></pre>
<div class="sourceCode" id="cb637"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># you can also break this into steps, using intermediate variables</span></span>
<span><span class="co"># note intermediate variables can be used immediately in the same mutate() call</span></span>
<span><span class="va">penguins2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>  bill_cross_section_mm2 <span class="op">=</span> <span class="va">pi</span> <span class="op">*</span> <span class="op">(</span><span class="va">bill_depth_mm</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>  bill_vol_mm3           <span class="op">=</span> <span class="va">bill_cross_section_mm2</span> <span class="op">*</span> <span class="va">bill_length_mm</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 6
  species sex    bill_length_mm bill_depth_mm bill_cross_section_mm2 bill_vol_mm3
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;                  &lt;dbl&gt;        &lt;dbl&gt;
1 Adelie  male             39.1          18.7                   275.       10739.
2 Adelie  female           39.5          17.4                   238.        9393.
3 Adelie  female           40.3          18                     254.       10255.
4 Adelie  female           36.7          19.3                   293.       10737.
5 Adelie  male             39.3          20.6                   333.       13098.
# ℹ 328 more rows</code></pre>
<div class="sourceCode" id="cb639"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># you can even mix summary functions into your expression</span></span>
<span><span class="co"># e.g. standardize bill length and depth by subtracting mean and dividing by sd</span></span>
<span><span class="va">penguins2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>  bill_length_std <span class="op">=</span> <span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span>,</span>
<span>  bill_depth_std  <span class="op">=</span> <span class="op">(</span><span class="va">bill_depth_mm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">bill_depth_mm</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 6
  species sex    bill_length_mm bill_depth_mm bill_length_std bill_depth_std
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;
1 Adelie  male             39.1          18.7          -0.895          0.780
2 Adelie  female           39.5          17.4          -0.822          0.119
3 Adelie  female           40.3          18            -0.675          0.424
4 Adelie  female           36.7          19.3          -1.33           1.08 
5 Adelie  male             39.3          20.6          -0.858          1.74 
# ℹ 328 more rows</code></pre>
<div class="sourceCode" id="cb641"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># you can of course create columns of other data types</span></span>
<span><span class="va">penguins2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>  small_bill <span class="op">=</span> <span class="va">bill_length_mm</span> <span class="op">&lt;</span> <span class="fl">39</span> <span class="op">|</span> <span class="va">bill_depth_mm</span> <span class="op">&lt;</span> <span class="fl">18</span>,</span>
<span>  fake_dates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">today</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">today</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 6
  species sex    bill_length_mm bill_depth_mm small_bill fake_dates
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt; &lt;lgl&gt;      &lt;date&gt;    
1 Adelie  male             39.1          18.7 FALSE      2024-09-28
2 Adelie  female           39.5          17.4 TRUE       2024-09-29
3 Adelie  female           40.3          18   FALSE      2024-09-30
4 Adelie  female           36.7          19.3 TRUE       2024-10-01
5 Adelie  male             39.3          20.6 FALSE      2024-10-02
# ℹ 328 more rows</code></pre>
<p>A notable function that is extremely useful inside <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> is <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> which can calculate different values depending on certain conditions.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;It’s similar to a switch function in other languages.&lt;/p&gt;"><sup>27</sup></a> The basic syntax is <code>df %&gt;% mutate(new_col = case_when(cond1 ~ expr1, cond2 ~ expr2, ...))</code> where <code>cond1</code>, <code>cond2</code>, … are logical condition vectors checked one by one in the given order, and <code>expr1</code>, <code>expr2</code>, … are R expressions that are activated when a condition matches.</p>
<p>For example, suppose we want to create some new column differently depending on sex and bill depth:</p>
<div class="sourceCode" id="cb643"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use case_when() inside a mutate() depending on some conditions</span></span>
<span><span class="co"># .default sets the "default" result, when no conditions match OR when we have NAs</span></span>
<span><span class="va">penguins2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>  new_col <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">sex</span> <span class="op">==</span> <span class="st">"male"</span> <span class="op">&amp;</span> <span class="va">bill_depth_mm</span> <span class="op">&lt;=</span> <span class="fl">19</span> <span class="op">~</span> <span class="va">bill_length_mm</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    <span class="va">sex</span> <span class="op">==</span> <span class="st">"male"</span> <span class="op">&amp;</span> <span class="va">bill_depth_mm</span> <span class="op">&gt;</span> <span class="fl">19</span> <span class="op">~</span> <span class="va">bill_length_mm</span> <span class="op">*</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>    <span class="va">sex</span> <span class="op">==</span> <span class="st">"female"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">/</span> <span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    .default <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 5
  species sex    bill_length_mm bill_depth_mm new_col
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;   &lt;dbl&gt;
1 Adelie  male             39.1          18.7 3910   
2 Adelie  female           39.5          17.4    1.64
3 Adelie  female           40.3          18      1.61
4 Adelie  female           36.7          19.3    1.29
5 Adelie  male             39.3          20.6  -39.3 
# ℹ 328 more rows</code></pre>
<p>It’s worth restating that <strong>ANY vectorized operation of the columns can be used inside <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code></strong>, as long as the result is a same-length vector (or single value to be recycled). This includes essentially every function from chapter <a href="data-vectors.html#data-vectors">3</a>!</p>
<p>The <a href="https://rstudio.github.io/cheatsheets/data-transformation.pdf">dplyr cheat sheet</a> has on page 2 a small list of some other functions that may be useful inside <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> for more advanced situations, such as <code><a href="https://rdrr.io/r/base/cumsum.html">cumsum()</a></code> for finding cumulative sums of columns (i.e. “running” sum), <code><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lead()</a></code> for creating a lagged or leading vector useful for computing changes in time series data, <code><a href="https://dplyr.tidyverse.org/reference/na_if.html">na_if()</a></code> for selectively replacing specific values with NA, several ranking functions like <code><a href="https://dplyr.tidyverse.org/reference/row_number.html">dense_rank()</a></code> or <code><a href="https://dplyr.tidyverse.org/reference/row_number.html">min_rank()</a></code>, and many more.</p>
</div>
<div id="summarize" class="section level3" number="7.4.4">
<h3>
<span class="header-section-number">7.4.4</span> <code>summarize()</code><a class="anchor" aria-label="anchor" href="#summarize"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> is similar to <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> except you <strong>MUST use summary functions</strong>, i.e. function that always <strong>reduce a vector down to a single value</strong>. Again, you can again use any arbitrary function or combination of functions of any columns in the data frame, and the result can be any type (e.g. numeric, character, logical, date, etc.), as long as the result is singular.</p>
<p>The basic syntax is <code>df %&gt;% summarize(col1 = expr1, col2 = expr2, ...)</code> where again <code>col1</code>, <code>col2</code>, … are names of new summary columns, and <code>expr1</code>, <code>expr2</code>, … are R expressions that reduce to a single value. Example:</p>
<div class="sourceCode" id="cb645"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># let's compute several summary statistics of bill length</span></span>
<span><span class="va">penguins2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>  mean_length   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span>,</span>
<span>  median_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span>,</span>
<span>  sd_length     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span>,</span>
<span>  iqr_length    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span>,</span>
<span>  max_length    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span>,</span>
<span>  min_length    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span>,</span>
<span>  n             <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 7
  mean_length median_length sd_length iqr_length max_length min_length     n
        &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt;
1        44.0          44.5      5.47        9.1       59.6       32.1   333</code></pre>
<p>The last function in the chunk above <code><a href="https://dplyr.tidyverse.org/reference/context.html">n()</a></code> is a special function that <strong>takes NO arguments and returns the number of rows</strong>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;This is an example of what’s called a &lt;a href="https://en.wikipedia.org/wiki/Arity"&gt;nullary function&lt;/a&gt;&lt;/p&gt;'><sup>28</sup></a></p>
<p>A few other common applications of <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> in data exploration:</p>
<div class="sourceCode" id="cb647"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute a few other summaries to explore the data</span></span>
<span><span class="co"># note similar to mutate, we can immediately use a summarized column</span></span>
<span><span class="va">penguins2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>  n            <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  n_male       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"male"</span><span class="op">)</span>,</span>
<span>  pct_male     <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">n_male</span> <span class="op">/</span> <span class="va">n</span>,</span>
<span>  n_female     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"female"</span><span class="op">)</span>,</span>
<span>  pct_female   <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">n_female</span> <span class="op">/</span> <span class="va">n</span>,</span>
<span>  pct_NA       <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">bill_depth_mm</span><span class="op">)</span></span>
<span>  <span class="op">)</span>, <span class="co"># get proportion of rows with NA (mean of logicals gives proportion of TRUEs)</span></span>
<span>  q90_len      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">bill_length_mm</span>, <span class="fl">0.90</span><span class="op">)</span>,</span>
<span>  pmed_len     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  correlation  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">bill_length_mm</span>, <span class="va">bill_depth_mm</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 9
      n n_male pct_male n_female pct_female pct_NA q90_len pmed_len correlation
  &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;    &lt;int&gt;      &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;
1   333    168     50.5      165       49.5      0    50.8    0.502      -0.229</code></pre>
<p>It’s also common to use <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> to compute statistical results. For example we can calculate the 95% confidence intervals for the mean bill length and depth (ignoring species/sex) which is something we will cover in more detail later in the course:</p>
<div class="sourceCode" id="cb649"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we first compute some intermediate statistics,</span></span>
<span><span class="co"># then use those to compute the intervals</span></span>
<span><span class="va">penguins2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>  n            <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  mean_length  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span>,</span>
<span>  sd_length    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span>,</span>
<span>  mean_depth   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bill_depth_mm</span><span class="op">)</span>,</span>
<span>  sd_depth     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">bill_depth_mm</span><span class="op">)</span>,</span>
<span>  length_95_ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mean_length</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">sd_length</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    collapse <span class="op">=</span> <span class="st">","</span></span>
<span>  <span class="op">)</span>,</span>
<span>  depth_95_ci  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mean_depth</span>  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">sd_depth</span>  <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    collapse <span class="op">=</span> <span class="st">","</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 7
      n mean_length sd_length mean_depth sd_depth length_95_ci depth_95_ci
  &lt;int&gt;       &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;      
1   333        44.0      5.47       17.2     1.97 43.41,44.58  16.95,17.38</code></pre>
<p>Again, I think it’s important to stress <strong>ANY expression involving columns that results in a single value</strong> can be used inside <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>. The <a href="https://rstudio.github.io/cheatsheets/data-transformation.pdf">dplyr cheat sheet</a> has on page 2 some more examples of useful summarizing functions such as <code><a href="https://dplyr.tidyverse.org/reference/nth.html">first()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/nth.html">last()</a></code>, and <code><a href="https://dplyr.tidyverse.org/reference/nth.html">nth()</a></code> for getting the first, last, and n-th observations in a group respectively. Feel free to read more on your own.</p>
</div>
</div>
<div id="row-wise-functions" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Row-wise functions<a class="anchor" aria-label="anchor" href="#row-wise-functions"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s move on now to the row-wise functions, i.e. the functions that primarily focus on manipulating rows in certain ways. Again, there are many of these too, but here are 3 of the most important:</p>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> for filtering which rows to keep,</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice()</a></code> (plus some other sibling functions) for slicing out specific rows,</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> for sorting rows.</li>
</ul>
<div id="filter" class="section level3" number="7.5.1">
<h3>
<span class="header-section-number">7.5.1</span> <code>filter()</code><a class="anchor" aria-label="anchor" href="#filter"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> is used to filter which rows to keep. Note the wording here; <strong>rows that meet the conditions are KEPT, not dropped</strong>. This is a frequent point of confusion for beginners.</p>
<p>Similar to <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>, you can filter by <strong>constructing a logical expression using ANY combination of columns</strong>, as long as the result is a vector of TRUE/FALSE values, one for each row. In the end, only rows with TRUE will be returned as output.</p>
<p>Let’s return to using our original <code>penguins</code> data frame. Here’s a few filtering examples:</p>
<div class="sourceCode" id="cb651"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filter to get penguins &gt;=6kg</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">body_mass_g</span> <span class="op">&gt;=</span> <span class="fl">6000</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 4 × 8
  species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex  
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;
1 Gentoo  Biscoe           49.2          15.2               221        6300 male 
2 Gentoo  Biscoe           59.6          17                 230        6050 male 
3 Gentoo  Biscoe           51.1          16.3               220        6000 male 
4 Gentoo  Biscoe           48.8          16.2               222        6000 male 
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb653"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># combining multiple filtering conditions using &amp; and |</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>  <span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Adelie"</span> <span class="op">|</span> <span class="va">species</span> <span class="op">==</span> <span class="st">"Gentoo"</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>    <span class="va">island</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Biscoe"</span>, <span class="st">"Dream"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op">&lt;</span> <span class="fl">2008</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 62 × 8
  species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Adelie  Biscoe           37.8          18.3               174        3400 female
2 Adelie  Biscoe           37.7          18.7               180        3600 male  
3 Adelie  Biscoe           35.9          19.2               189        3800 female
4 Adelie  Biscoe           38.2          18.1               185        3950 male  
5 Adelie  Biscoe           38.8          17.2               180        3800 male  
# ℹ 57 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb655"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># you can of course use more complex functions and expressions,</span></span>
<span><span class="co"># you can also use , to separate multiple conditions in filter() instead of &amp;</span></span>
<span><span class="co"># e.g. this code gets rows with no "e" in the species name, and also</span></span>
<span><span class="co"># bill depth is higher than median but flipper length is lower than median</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>  <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"e"</span>, <span class="va">species</span><span class="op">)</span>,</span>
<span>  <span class="va">bill_depth_mm</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">bill_depth_mm</span><span class="op">)</span>,</span>
<span>  <span class="va">flipper_length_mm</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">flipper_length_mm</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 24 × 8
  species   island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Chinstrap Dream            46.5          17.9               192        3500 female
2 Chinstrap Dream            50            19.5               196        3900 male  
3 Chinstrap Dream            51.3          19.2               193        3650 male  
4 Chinstrap Dream            45.4          18.7               188        3525 female
5 Chinstrap Dream            46.1          18.2               178        3250 female
# ℹ 19 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb657"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># an example of an even more complicated expression,</span></span>
<span><span class="co"># this line gets penguins with body mass and bill length</span></span>
<span><span class="co"># within a 1 SD circle centered around the mean of both,</span></span>
<span><span class="co"># then plots the result to visually inspect</span></span>
<span><span class="co"># note the result df can be directly piped into ggplot()</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="op">(</span><span class="op">(</span><span class="va">body_mass_g</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>      <span class="op">(</span><span class="op">(</span><span class="va">bill_length_mm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">bill_length_mm</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">&lt;=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Filter demo (points in a 1-SD circle around mean of x,y)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Bill length (mm)"</span>, y <span class="op">=</span> <span class="st">"Body mass (g)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="fl">.0067</span><span class="op">)</span> <span class="co"># make the plot window a square</span></span></code></pre></div>
<div class="inline-figure"><img src="07-intro-dplyr_files/figure-html/filter2-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="slice" class="section level3" number="7.5.2">
<h3>
<span class="header-section-number">7.5.2</span> <code>slice()</code><a class="anchor" aria-label="anchor" href="#slice"><i class="fas fa-link"></i></a>
</h3>
<p>There are several <a href="https://dplyr.tidyverse.org/reference/slice.html"><code class="sourceCode r"><span class="kw">slice...</span>()</code></a> functions in dplyr for slicing out specific rows, similar to <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> but more specialized. The main one <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice()</a></code> is used to select by position (i.e. by row number). Examples:</p>
<div class="sourceCode" id="cb658"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># slice rows 11-15</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 5 × 8
  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Adelie  Torgersen           36.6          17.8               185        3700 female
2 Adelie  Torgersen           38.7          19                 195        3450 female
3 Adelie  Torgersen           42.5          20.7               197        4500 male  
4 Adelie  Torgersen           34.4          18.4               184        3325 female
5 Adelie  Torgersen           46            21.5               194        4200 male  
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb660"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># slice every 10th row</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 33 × 8
  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Adelie  Torgersen           34.6          21.1               198        4400 male  
2 Adelie  Biscoe              38.8          17.2               180        3800 male  
3 Adelie  Dream               36.4          17                 195        3325 female
4 Adelie  Dream               37            16.9               185        3000 female
5 Adelie  Biscoe              41.4          18.6               191        3700 male  
# ℹ 28 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb662"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remove the first 200 rows</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 133 × 8
  species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Gentoo  Biscoe           45            15.4               220        5050 male  
2 Gentoo  Biscoe           43.8          13.9               208        4300 female
3 Gentoo  Biscoe           45.5          15                 220        5000 male  
4 Gentoo  Biscoe           43.2          14.5               208        4450 female
5 Gentoo  Biscoe           50.4          15.3               224        5550 male  
# ℹ 128 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<p><code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_tail()</a></code> specifically slice out rows at the top or bottom, by either number <code>n</code> or proportion <code>prop</code>. Examples:</p>
<div class="sourceCode" id="cb664"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the first 25 rows</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 25 × 8
  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Adelie  Torgersen           39.1          18.7               181        3750 male  
2 Adelie  Torgersen           39.5          17.4               186        3800 female
3 Adelie  Torgersen           40.3          18                 195        3250 female
4 Adelie  Torgersen           36.7          19.3               193        3450 female
5 Adelie  Torgersen           39.3          20.6               190        3650 male  
# ℹ 20 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb666"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the last 10% of rows</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_tail</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 33 × 8
  species   island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Chinstrap Dream            47.5          16.8               199        3900 female
2 Chinstrap Dream            47.6          18.3               195        3850 female
3 Chinstrap Dream            52            20.7               210        4800 male  
4 Chinstrap Dream            46.9          16.6               192        2700 female
5 Chinstrap Dream            53.5          19.9               205        4500 male  
# ℹ 28 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<p><code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_min()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max()</a></code> are used to slice rows which contain the min/max values for a specific variable. For example, suppose we want to get the penguin with the smallest body mass:</p>
<div class="sourceCode" id="cb668"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get smallest penguin by mass</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_min</a></span><span class="op">(</span><span class="va">body_mass_g</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 8
  species   island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Chinstrap Dream            46.9          16.6               192        2700 female
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<p>If there are ties, by default <strong>all tied rows are printed</strong>, e.g. suppose we want the 3 penguins with the longest flipper lengths:</p>
<div class="sourceCode" id="cb670"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get 3 penguins with longest flippers</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="va">flipper_length_mm</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 8 × 8
  species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex  
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;
1 Gentoo  Biscoe           54.3          15.7               231        5650 male 
2 Gentoo  Biscoe           50            16.3               230        5700 male 
3 Gentoo  Biscoe           59.6          17                 230        6050 male 
4 Gentoo  Biscoe           49.8          16.8               230        5700 male 
5 Gentoo  Biscoe           48.6          16                 230        5800 male 
6 Gentoo  Biscoe           52.1          17                 230        5550 male 
7 Gentoo  Biscoe           51.5          16.3               230        5500 male 
8 Gentoo  Biscoe           55.1          16                 230        5850 male 
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<p>It looks like 7 different Gentoo penguins are all tied for 2nd place, so they are ALL returned! You can disable this with an argument, but it’s recommended to keep the default behavior here.</p>
<p>You can also set <code>prop</code> instead of <code>n</code> to return by percent. E.g. let’s get the top 1% of penguins by bill length:</p>
<div class="sourceCode" id="cb672"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get top 1% of penguins by bill length</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span><span class="va">bill_length_mm</span>, prop <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 3 × 8
  species   island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Gentoo    Biscoe           59.6          17                 230        6050 male  
2 Chinstrap Dream            58            17.8               181        3700 female
3 Gentoo    Biscoe           55.9          17                 228        5600 male  
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
</div>
<div id="arrange" class="section level3" number="7.5.3">
<h3>
<span class="header-section-number">7.5.3</span> <code>arrange()</code><a class="anchor" aria-label="anchor" href="#arrange"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> is used to sort rows. Note that since it only sorts rows, it does NOT change the data frame in any “meaningful” way (generally, order of rows/columns is not considered a “meaningful” change). It’s primarily used for visual appeal, i.e. for neater presentation of a dataset.</p>
<p>The syntax is <code>df %&gt;% arrange(expr1, expr2, ...)</code> where <code>expr1</code>, <code>expr2</code>, … can be simply <strong>a column, or some vector expression using columns in the data frame</strong> (similar to <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> or <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>) whose resultant values are used for sorting the rows. A few important notes:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Each next expression is ONLY used to break ties in the previous expressions</strong>, otherwise it’s ignored! E.g. if two rows can be sorted by <code>expr1</code>, only that is used. However if two rows are tied for <code>expr1</code>, then <code>expr2</code> (if it exists) will be used to try to break the tie, and so on. This is also a frequent point of confusion for beginners.</li>
<li>Default order is always <strong>ascending</strong>, i.e. small to large, A to Z, earlier to later, FALSE to TRUE. For descending order, wrap your expression in <code><a href="https://dplyr.tidyverse.org/reference/desc.html">desc()</a></code>.</li>
<li>Rows that are completely tied may be returned in any order.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;For the CS folks again, this means &lt;code&gt;arrange()&lt;/code&gt; does not guarantee a &lt;a href="https://en.wikipedia.org/wiki/Sorting_algorithm#Stability"&gt;stable sort&lt;/a&gt;. It seems like this generally isn’t a huge concern or priority for the Tidyverse developers, which is fair enough.&lt;/p&gt;'><sup>29</sup></a>
</li>
</ol>
<p>Examples of <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code>:</p>
<div class="sourceCode" id="cb674"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sort penguins by ascending flipper length</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">flipper_length_mm</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 8
  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Adelie  Biscoe              37.9          18.6               172        3150 female
2 Adelie  Biscoe              37.8          18.3               174        3400 female
3 Adelie  Torgersen           40.2          17                 176        3450 female
4 Adelie  Dream               39.5          16.7               178        3250 female
5 Adelie  Dream               37.2          18.1               178        3900 male  
# ℹ 328 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb676"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sort penguins by descending flipper length</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 8
  species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex  
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;
1 Gentoo  Biscoe           54.3          15.7               231        5650 male 
2 Gentoo  Biscoe           50            16.3               230        5700 male 
3 Gentoo  Biscoe           59.6          17                 230        6050 male 
4 Gentoo  Biscoe           49.8          16.8               230        5700 male 
5 Gentoo  Biscoe           48.6          16                 230        5800 male 
# ℹ 328 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb678"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># since mathematical expressions are allowed, this is also equivalent</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="op">-</span><span class="va">flipper_length_mm</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 8
  species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex  
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;
1 Gentoo  Biscoe           54.3          15.7               231        5650 male 
2 Gentoo  Biscoe           50            16.3               230        5700 male 
3 Gentoo  Biscoe           59.6          17                 230        6050 male 
4 Gentoo  Biscoe           49.8          16.8               230        5700 male 
5 Gentoo  Biscoe           48.6          16                 230        5800 male 
# ℹ 328 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb680"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sort first by island, then by descending species (if there are ties)</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">island</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 8
  species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Gentoo  Biscoe           46.1          13.2               211        4500 female
2 Gentoo  Biscoe           50            16.3               230        5700 male  
3 Gentoo  Biscoe           48.7          14.1               210        4450 female
4 Gentoo  Biscoe           50            15.2               218        5700 male  
5 Gentoo  Biscoe           47.6          14.5               215        5400 male  
# ℹ 328 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb682"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># again, any expression is possible,</span></span>
<span><span class="co"># let's sort first by number of SDs away from mean body mass,</span></span>
<span><span class="co"># then by descending last letter of species name for ties,</span></span>
<span><span class="co"># then by ascending approximate bill volume if there are further ties</span></span>
<span><span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">body_mass_g</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">species</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">pi</span> <span class="op">*</span> <span class="op">(</span><span class="va">bill_depth_mm</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">bill_length_mm</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 333 × 8
  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex   
  &lt;chr&gt;   &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt; 
1 Gentoo  Biscoe              45.3          13.8               208        4200 female
2 Gentoo  Biscoe              45.5          13.9               210        4200 female
3 Gentoo  Biscoe              45.8          14.6               210        4200 female
4 Adelie  Torgersen           35.1          19.4               193        4200 male  
5 Adelie  Torgersen           46            21.5               194        4200 male  
# ℹ 328 more rows
# ℹ 1 more variable: year &lt;dbl&gt;</code></pre>
</div>
<div id="other-row-functions" class="section level3" number="7.5.4">
<h3>
<span class="header-section-number">7.5.4</span> Other row functions<a class="anchor" aria-label="anchor" href="#other-row-functions"><i class="fas fa-link"></i></a>
</h3>
<p>Besides these, there’s a few other row operations that you may sometimes need, such as <code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code> for removing duplicates or <code><a href="https://tibble.tidyverse.org/reference/add_row.html">add_row()</a></code> for manually adding new observations. These may occasionally show up in later contexts, but for now please feel free to explore these on your own.</p>
</div>
</div>
<div id="missing-values" class="section level2" number="7.6">
<h2>
<span class="header-section-number">7.6</span> Missing values<a class="anchor" aria-label="anchor" href="#missing-values"><i class="fas fa-link"></i></a>
</h2>
<p>Before ending this chapter, let’s briefly discuss handling missing values, i.e. NAs in R. Missing values are unfortunately very common in data science and are usually tricky to handle well due to many associated pitfalls. We will <em>briefly</em> discuss missing values both from a theoretical perspective, and a practical R handling perspective.</p>
<div id="why-missing" class="section level3" number="7.6.1">
<h3>
<span class="header-section-number">7.6.1</span> Why missing?<a class="anchor" aria-label="anchor" href="#why-missing"><i class="fas fa-link"></i></a>
</h3>
<p>When working with missing values, it’s important to ask yourself this: “<strong>why is this data missing</strong>?” Usually, this is impossible to answer definitively, and different observations may be missing for different reasons.</p>
<p>Without getting too out of scope, broadly speaking data can be missing either FOR a relevant reason or NOT FOR a relevant reason.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;This is a &lt;strong&gt;massive oversimplification&lt;/strong&gt; here but unfortunately, we don’t have time to address the buried nuances. See &lt;a href="https://www.ncbi.nlm.nih.gov/books/NBK493614"&gt;this summary&lt;/a&gt; or &lt;a href="https://www.jstor.org/stable/2335739"&gt;this article&lt;/a&gt; for the nitty gritty.&lt;/p&gt;'><sup>30</sup></a></p>
<p>For example, suppose I’m setting up a weather station with several sensors, but I have a small budget, so I buy a cheap pressure sensor that isn’t properly weather-proofed and is more prone to producing NAs when it rains. These NAs are missing for a relevant reason; there’s a systematic pattern behind the missingness. Since rain and pressure are closely related, this means the pattern of missingness is meaningful, so removing NAs will add significant bias to the data.</p>
<p>Now, suppose I replace it with a different cheap pressure sensor that is weather-proof but just slightly buggy overall, and every hour there’s independently a 1% chance it will just randomly read NA. This data is NOT missing for a relevant reason, i.e. the pattern of missingness is not meaningful, and you can simply remove the NAs.</p>
<p>When working with data you should ALWAYS <strong>look for a pattern in the NAs</strong> and ask yourself if there’s evidence of a relevant reason for the missingness. You should <strong>ONLY remove NAs with NO clear pattern</strong>, otherwise you risk introducing further systematic biases in your analysis and results.</p>
<p>Again, this is <em>extremely</em> simplified, but sufficient for now. In general, for STAT 240 we will only encounter datasets where it’s probably ok to drop NA values, but do NOT assume this for all datasets in the real world.</p>
</div>
<div id="nas-in-r" class="section level3" number="7.6.2">
<h3>
<span class="header-section-number">7.6.2</span> NAs in R<a class="anchor" aria-label="anchor" href="#nas-in-r"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s now briefly discuss R techniques for handling NAs. First it’s important to review the difference between <code>NA</code> and <code>NaN</code> in R:</p>
<ul>
<li>
<code>NA</code> means the absence of an observation, i.e. a data point was not recorded.</li>
<li>
<code>NaN</code> is usually the result of a mathematically invalid operation, like <code>0/0</code>, <code>0*Inf</code>, or <code>Inf-Inf</code>.
<ul>
<li>Note that <code>sqrt(-1)</code> and <code>log(-1)</code> also return <code>NaN</code> since the input type is of real type. Replace <code>-1</code> with <code>0-1i</code> to trigger complex evaluation.</li>
</ul>
</li>
</ul>
<p>Even though they’re not the exact same, both <code>NA</code> and <code>NaN</code> are considered missing in R and can be handled together using the operations covered below. It’s also worth noting <code>NA</code> is NOT the same as <code>"NA"</code>, i.e. a string made of the letters <code>"N"</code> and <code>"A"</code></p>
<div class="sourceCode" id="cb684"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check if two objects are the exact same</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb686"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NaN</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode" id="cb688"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"NA"</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] FALSE</code></pre>
<p>In general expressions involving an NA will result in an NA output (though there are some notable exceptions, particularly with character types).</p>
</div>
<div id="identifying-nas" class="section level3" number="7.6.3">
<h3>
<span class="header-section-number">7.6.3</span> Identifying NAs<a class="anchor" aria-label="anchor" href="#identifying-nas"><i class="fas fa-link"></i></a>
</h3>
<p>NAs (and also NaNs) in a vector can be identified using <code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code> which produces a TRUE/FALSE vector corresponding to if a value is NA or not:</p>
<div class="sourceCode" id="cb690"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># demo missing vector, note both NA/NaN count as missing</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">8</span>, <span class="cn">NA</span>, <span class="fl">2</span>, <span class="cn">NaN</span><span class="op">)</span></span>
<span><span class="co"># which values are NA?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] FALSE FALSE  TRUE FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb692"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get only non-NA values</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>[1] 3 8 2</code></pre>
<p>Since this is an ordinary vectorized function, it can be used inside any compatible dplyr function above, such as <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>, and <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code>. To demonstrate these, let’s create a demo data frame with a mix of data types as well as some missing values.</p>
<div class="sourceCode" id="cb694"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># demo data frame with missing values</span></span>
<span><span class="va">df.demo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"24.1.1"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="cn">NA</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df.demo</span></span></code></pre></div>
<pre><code># A tibble: 5 × 4
  date       x         y z    
  &lt;date&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
1 2024-01-01 &lt;NA&gt;     NA NA   
2 2024-01-02 A         1 TRUE 
3 2024-01-03 B         2 FALSE
4 2024-01-04 A        NA NA   
5 2024-01-06 B         3 NA   </code></pre>
<p>A common rudimentary of checking missingness is with the aforementioned <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function from section <a href="data-frames.html#basic-df">4.3.1</a>. Note this is the base R <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>, NOT the Tidyverse <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> we just covered above. Note however it only reports NAs for some columns, depending on type.</p>
<div class="sourceCode" id="cb696"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df.demo</span><span class="op">)</span></span></code></pre></div>
<pre><code>      date                 x                   y           z          
 Min.   :2024-01-01   Length:5           Min.   :1.0   Mode :logical  
 1st Qu.:2024-01-02   Class :character   1st Qu.:1.5   FALSE:1        
 Median :2024-01-03   Mode  :character   Median :2.0   TRUE :1        
 Mean   :2024-01-03                      Mean   :2.0   NA's :3        
 3rd Qu.:2024-01-04                      3rd Qu.:2.5                  
 Max.   :2024-01-06                      Max.   :3.0                  
                                         NA's   :2                    </code></pre>
<p>A better way is to pipe into <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> and use <code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code> with either <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> for count or <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> for proportion of missing values. You can also add <code>!</code> in front of <code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code> to get the count/proportion of non-missing values. All 4 combinations are shown below:</p>
<div class="sourceCode" id="cb698"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the count/proportion of missing/non-missing values</span></span>
<span><span class="va">df.demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>  num_date_na   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prop_x_na     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  num_y_not_na  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prop_z_not_na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  nrows         <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># add number of rows for convenience</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 5
  num_date_na prop_x_na num_y_not_na prop_z_not_na nrows
        &lt;int&gt;     &lt;dbl&gt;        &lt;int&gt;         &lt;dbl&gt; &lt;int&gt;
1           0       0.2            3           0.4     5</code></pre>
<p>If you just want to apply one function to all columns, you can use <code><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarize_all()</a></code> which is a shortcut for exactly this. For example, we can apply the function <code>\(x) mean(is.na(x))*100</code> to get the percent missing in each column:</p>
<div class="sourceCode" id="cb700"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get percent missing in each column</span></span>
<span><span class="va">df.demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarize_all</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 4
   date     x     y     z
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0    20    40    60</code></pre>
<div class="note">
<p>If you check the help page of <code><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarize_all()</a></code> you’ll notice this function is tagged with <img src="https://dplyr.tidyverse.org/reference/figures/lifecycle-superseded.svg" style="width:115px!important;margin:0!important"> which basically means you can keep using it, but there’s a new recommended alternative syntax.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;See this &lt;a href="https://lifecycle.r-lib.org/articles/stages.html"&gt;page on lifecycles&lt;/a&gt;.&lt;/p&gt;'><sup>31</sup></a> For this function, the new recommendation is to use <code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code> instead, but this is a bit outside our scope, so read at your own discretion.</p>
</div>
<p>Of course you can also use <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> to inspect rows with missing values in some (or all) columns. Examples:</p>
<div class="sourceCode" id="cb702"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get rows with missing x</span></span>
<span><span class="va">df.demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 4
  date       x         y z    
  &lt;date&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
1 2024-01-01 &lt;NA&gt;     NA NA   </code></pre>
<div class="sourceCode" id="cb704"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get rows with missing x or y</span></span>
<span><span class="va">df.demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 2 × 4
  date       x         y z    
  &lt;date&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
1 2024-01-01 &lt;NA&gt;     NA NA   
2 2024-01-04 A        NA NA   </code></pre>
<div class="sourceCode" id="cb706"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get rows where y is missing but x is NOT missing</span></span>
<span><span class="va">df.demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 4
  date       x         y z    
  &lt;date&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
1 2024-01-04 A        NA NA   </code></pre>
<div class="sourceCode" id="cb708"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get rows where ANY variable is missing</span></span>
<span><span class="co"># this uses if_any() which checks if any given cols satisfy a condition</span></span>
<span><span class="va">df.demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">if_any</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">is.na</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 3 × 4
  date       x         y z    
  &lt;date&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
1 2024-01-01 &lt;NA&gt;     NA NA   
2 2024-01-04 A        NA NA   
3 2024-01-06 B         3 NA   </code></pre>
<p>One more thing, did you notice there’s actually another form of missingness in <code>df.demo</code>? This data frame appears to contain daily observations, but <code>"2024-01-05"</code> appears to be missing completely from the data frame. This sneaky situation of data missing by not existing in the data frame completely is surprisingly common and can sometimes be hard to identify (since there’s no NAs in the date column to detect).</p>
<p>One easy way to fix this is to use <code><a href="https://tidyr.tidyverse.org/reference/complete.html">complete()</a></code> and <code><a href="https://tidyr.tidyverse.org/reference/full_seq.html">full_seq()</a></code> from <a href="https://tidyr.tidyverse.org">tidyr</a>, yet another core Tidyverse package. This combination can be used to generate a <code><a href="https://tidyr.tidyverse.org/reference/complete.html">complete()</a></code> data frame by generating a <code><a href="https://tidyr.tidyverse.org/reference/full_seq.html">full_seq()</a></code>–uence of values for some specified column. Other columns are filled with NAs by default. Example:</p>
<div class="sourceCode" id="cb710"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this generates a full sequence of dates</span></span>
<span><span class="co"># the argument 1 indicates the sequence increases by 1 each observation</span></span>
<span><span class="va">df.demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/complete.html">complete</a></span><span class="op">(</span>date <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/full_seq.html">full_seq</a></span><span class="op">(</span><span class="va">date</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 6 × 4
  date       x         y z    
  &lt;date&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
1 2024-01-01 &lt;NA&gt;     NA NA   
2 2024-01-02 A         1 TRUE 
3 2024-01-03 B         2 FALSE
4 2024-01-04 A        NA NA   
5 2024-01-05 &lt;NA&gt;     NA NA   
6 2024-01-06 B         3 NA   </code></pre>
<div class="sourceCode" id="cb712"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to show ONLY rows that were added using this operation,</span></span>
<span><span class="co"># we can first create a dummy column filled with some value,</span></span>
<span><span class="co"># complete the data frame, then filter to where the dummy column is NA</span></span>
<span><span class="va">df.demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>preexisting <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/complete.html">complete</a></span><span class="op">(</span>date <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/full_seq.html">full_seq</a></span><span class="op">(</span><span class="va">date</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">preexisting</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 5
  date       x         y z     preexisting
  &lt;date&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;lgl&gt;      
1 2024-01-05 &lt;NA&gt;     NA NA    NA         </code></pre>
</div>
<div id="dropping-nas" class="section level3" number="7.6.4">
<h3>
<span class="header-section-number">7.6.4</span> Dropping NAs<a class="anchor" aria-label="anchor" href="#dropping-nas"><i class="fas fa-link"></i></a>
</h3>
<p>As mentioned before, for the limited scope of this class, usually rows with NAs can just be dropped for simplicity. The easiest way is to use <code>drop_na(col1, col2, ...)</code> where <code>col1</code>, <code>col2</code>, … are the columns we care about dropping NAs in. If left empty, <code><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na()</a></code> will drop rows where ANY column contains NA. Examples:</p>
<div class="sourceCode" id="cb714"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># drop only rows where x is missing</span></span>
<span><span class="va">df.demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 4 × 4
  date       x         y z    
  &lt;date&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
1 2024-01-02 A         1 TRUE 
2 2024-01-03 B         2 FALSE
3 2024-01-04 A        NA NA   
4 2024-01-06 B         3 NA   </code></pre>
<div class="sourceCode" id="cb716"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># drop rows where x and y are missing</span></span>
<span><span class="va">df.demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 3 × 4
  date       x         y z    
  &lt;date&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
1 2024-01-02 A         1 TRUE 
2 2024-01-03 B         2 FALSE
3 2024-01-06 B         3 NA   </code></pre>
<div class="sourceCode" id="cb718"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># drop rows where ANY values are missing</span></span>
<span><span class="va">df.demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 2 × 4
  date       x         y z    
  &lt;date&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
1 2024-01-02 A         1 TRUE 
2 2024-01-03 B         2 FALSE</code></pre>
<div class="note">
<p>Make sure to <strong>only drop NAs where absolutely necessary</strong>; avoid over-dropping! E.g. suppose you want to use only <code>x</code> and <code>y</code> for your analysis. You should not drop rows where <code>z</code> is missing since it probably won’t impede your work.</p>
<p>This is another VERY common pitfall for students. In general you should be extremely “lazy” about dropping, i.e. only use <code><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na()</a></code> when and where it is absolutely necessary to do so.</p>
</div>
</div>
<div id="replacing-nas" class="section level3" number="7.6.5">
<h3>
<span class="header-section-number">7.6.5</span> Replacing NAs<a class="anchor" aria-label="anchor" href="#replacing-nas"><i class="fas fa-link"></i></a>
</h3>
<p>In some <em>rare</em> circumstances, you may want to replace NAs with other values. Of course you can do any kind of conditional replacement using <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code>, but you can also use <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> and the specialized tidyr function <code><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na()</a></code>. Examples of both:</p>
<div class="sourceCode" id="cb720"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># suppose we need to replace NAs in y column with 0</span></span>
<span><span class="co"># using mutate and case_when:</span></span>
<span><span class="va">df.demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="fl">0</span>,</span>
<span>    .default <span class="op">=</span> <span class="va">y</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 5 × 4
  date       x         y z    
  &lt;date&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
1 2024-01-01 &lt;NA&gt;      0 NA   
2 2024-01-02 A         1 TRUE 
3 2024-01-03 B         2 FALSE
4 2024-01-04 A         0 NA   
5 2024-01-06 B         3 NA   </code></pre>
<div class="sourceCode" id="cb722"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># same thing but using replace_na instead of case_when:</span></span>
<span><span class="va">df.demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 5 × 4
  date       x         y z    
  &lt;date&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt;
1 2024-01-01 &lt;NA&gt;      0 NA   
2 2024-01-02 A         1 TRUE 
3 2024-01-03 B         2 FALSE
4 2024-01-04 A         0 NA   
5 2024-01-06 B         3 NA   </code></pre>
<p>In some datasets, NAs may be coded using certain obviously invalid values, e.g. -9999. These can of course also be mutated using <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code>, but there’s a special function <code><a href="https://dplyr.tidyverse.org/reference/na_if.html">na_if()</a></code> for just this purpose:</p>
<div class="sourceCode" id="cb724"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df.demo</span> <span class="op">&lt;-</span> <span class="va">df.demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">9999</span>, <span class="op">-</span><span class="fl">9999</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="op">-</span><span class="fl">9999</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df.demo</span></span></code></pre></div>
<pre><code># A tibble: 5 × 5
  date       x         y z         w
  &lt;date&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;dbl&gt;
1 2024-01-01 &lt;NA&gt;     NA NA    -9999
2 2024-01-02 A         1 TRUE  -9999
3 2024-01-03 B         2 FALSE    20
4 2024-01-04 A        NA NA       30
5 2024-01-06 B         3 NA    -9999</code></pre>
<div class="sourceCode" id="cb726"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df.demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html">na_if</a></span><span class="op">(</span><span class="va">w</span>, <span class="op">-</span><span class="fl">9999</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 5 × 5
  date       x         y z         w
  &lt;date&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;dbl&gt;
1 2024-01-01 &lt;NA&gt;     NA NA       NA
2 2024-01-02 A         1 TRUE     NA
3 2024-01-03 B         2 FALSE    20
4 2024-01-04 A        NA NA       30
5 2024-01-06 B         3 NA       NA</code></pre>

</div>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@xiee/utils/js/external-link.min.js" defer></script><script>
  $(function(){
    $(".note").addClass("alert alert-warning");
  });
  $(function(){
    $(".tip").addClass("alert alert-success");
  });
  $(function(){
    $(".def").addClass("alert alert-info");
  });
  $(function(){
    $(".eg").addClass("alert alert-secondary");
  });
  $(function(){
    $(".col-lg-3").addClass("col-lg-2").removeClass("col-lg-3");
  });
  $(function(){
    $(".col-lg-7").addClass("col-lg-8").removeClass("col-lg-7");
  });
</script><!-- https://stackoverflow.com/a/37839683/25278020 --><script>
  $(document).ready(function() {

  $chunks = $('.fold');

  $chunks.each(function () {

    // add button to source code chunks
    if ( $(this).hasClass('s') ) {
      $('pre.r', this).prepend("<div class=\"showopt\">Show Source</div><br style=\"line-height:22px;\"/>");
      $('pre.r', this).children('code').attr('class', 'folded');
    }

    // add button to output chunks
    if ( $(this).hasClass('o') ) {
      $('pre:not(.r)', this).has('code').prepend("<div class=\"showopt\">Show Output</div><br style=\"line-height:22px;\"/>");
      $('pre:not(.r)', this).children('code:not(r)').addClass('folded');

      // add button to plots
      $(this).find('img').wrap('<pre class=\"plot\"></pre>');
      $('pre.plot', this).prepend("<div class=\"showopt\">Show Plot</div><br style=\"line-height:22px;\"/>");
      $('pre.plot', this).children('img').addClass('folded');

    }
  });

  // hide all chunks when document is loaded
  $('.folded').css('display', 'none')

  // function to toggle the visibility
  $('.showopt').click(function() {
    var label = $(this).html();
    if (label.indexOf("Show") >= 0) {
      $(this).html(label.replace("Show", "Hide"));
    } else {
      $(this).html(label.replace("Hide", "Show"));
    }
    $(this).siblings('code, img').slideToggle('fast', 'swing');
  });
});

</script><!-- https://www.tutorialrepublic.com/faq/how-to-change-href-attribute-of-a-hyperlink-using-jquery.php--><script>
  $(document).ready(function(){
    $("a.anchorjs-link").each(function(){
      var oldUrl = $(this).attr("href"); // Get current url
      var newUrl = oldUrl.replace(/^#(\d+-)+/,"#"); // Create new url
      $(this).attr("href", "#" + $(this).closest("div").attr("id"));  // Set href value
      $(this).attr("title", location.protocol + "//" + location.host + location.pathname + $(this).attr("href")); // Set title value
    });
  });
</script><!-- https://stackoverflow.com/a/10415599/25278020 --><script>
  var observer = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
        if (mutation.addedNodes && mutation.addedNodes.length > 0) {
            // element added to DOM
            var hasClass = [].some.call(mutation.addedNodes, function(el) {
                return el.classList.contains('bs-popover-top')
            });
            if (hasClass) {
              $("div.bs-popover-top a").each(function(){
                $(this).attr("target", "_blank");
              });
          }
        }
    });
});

var config = {
    attributes: true,
    childList: true,
    characterData: true
};

observer.observe(document.body, config);
</script><div class="chapter-nav">
<div class="prev"><a href="data-transformation.html">Data Transformation</a></div>
<div class="next"><a href="advanced-operations.html"><span class="header-section-number">8</span> Advanced Operations</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#intro-to-dplyr"><span class="header-section-number">7</span> Intro to dplyr</a></li>
<li><a class="nav-link" href="#syntax-design"><span class="header-section-number">7.1</span> Syntax design</a></li>
<li><a class="nav-link" href="#pipes"><span class="header-section-number">7.2</span> Pipes</a></li>
<li><a class="nav-link" href="#data-example"><span class="header-section-number">7.3</span> Data example</a></li>
<li>
<a class="nav-link" href="#column-wise-functions"><span class="header-section-number">7.4</span> Column-wise functions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#select"><span class="header-section-number">7.4.1</span> select()</a></li>
<li><a class="nav-link" href="#rename"><span class="header-section-number">7.4.2</span> rename()</a></li>
<li><a class="nav-link" href="#mutate"><span class="header-section-number">7.4.3</span> mutate()</a></li>
<li><a class="nav-link" href="#summarize"><span class="header-section-number">7.4.4</span> summarize()</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#row-wise-functions"><span class="header-section-number">7.5</span> Row-wise functions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#filter"><span class="header-section-number">7.5.1</span> filter()</a></li>
<li><a class="nav-link" href="#slice"><span class="header-section-number">7.5.2</span> slice()</a></li>
<li><a class="nav-link" href="#arrange"><span class="header-section-number">7.5.3</span> arrange()</a></li>
<li><a class="nav-link" href="#other-row-functions"><span class="header-section-number">7.5.4</span> Other row functions</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#missing-values"><span class="header-section-number">7.6</span> Missing values</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#why-missing"><span class="header-section-number">7.6.1</span> Why missing?</a></li>
<li><a class="nav-link" href="#nas-in-r"><span class="header-section-number">7.6.2</span> NAs in R</a></li>
<li><a class="nav-link" href="#identifying-nas"><span class="header-section-number">7.6.3</span> Identifying NAs</a></li>
<li><a class="nav-link" href="#dropping-nas"><span class="header-section-number">7.6.4</span> Dropping NAs</a></li>
<li><a class="nav-link" href="#replacing-nas"><span class="header-section-number">7.6.5</span> Replacing NAs</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/bwu62/stat240-revamp/blob/master/07-intro-dplyr.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/bwu62/stat240-revamp/edit/master/07-intro-dplyr.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>STAT 240 Revamp</strong>" was written by Bi Cheng Wu, with help from Bret Larget and Cameron Jones. It was last built on 2024-09-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
