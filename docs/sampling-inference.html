<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 11 Sampling &amp; Inference | STAT 240 Revamp</title>
<meta name="author" content="Bi Cheng Wu, with help from Bret Larget and Cameron Jones">
<meta name="description" content="\(   \def\e{\operatorname{E}}   \def\p{\operatorname{P}}   \def\var{\operatorname{Var}}   \def\sd{\operatorname{SD}}   \def\bin{\operatorname{Bin}}   \def\n{\operatorname{N}}  \)  In the previous...">
<meta name="generator" content="bookdown 0.45 with bs4_book()">
<meta property="og:title" content="Chapter 11 Sampling &amp; Inference | STAT 240 Revamp">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bwu62.github.io/stat240-revamp/sampling-inference.html">
<meta property="og:description" content="\(   \def\e{\operatorname{E}}   \def\p{\operatorname{P}}   \def\var{\operatorname{Var}}   \def\sd{\operatorname{SD}}   \def\bin{\operatorname{Bin}}   \def\n{\operatorname{N}}  \)  In the previous...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 11 Sampling &amp; Inference | STAT 240 Revamp">
<meta name="twitter:description" content="\(   \def\e{\operatorname{E}}   \def\p{\operatorname{P}}   \def\var{\operatorname{Var}}   \def\sd{\operatorname{SD}}   \def\bin{\operatorname{Bin}}   \def\n{\operatorname{N}}  \)  In the previous...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Roboto_Mono-0.4.10/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.11.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.2/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-E0YDB40HWY"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-E0YDB40HWY');
    </script><link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
<link rel="manifest" href="icons/site.webmanifest">
<link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<!-- https://www.bryanbraun.com/anchorjs/ --><script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script><script>
      // Add anchors on DOMContentLoaded
    document.addEventListener('DOMContentLoaded', function(event) {
      anchors.add('h1');
      anchors.add();
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">STAT 240 Revamp</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome!</a></li>
<li><a class="" href="setup.html"><span class="header-section-number">1</span> Setup</a></li>
<li class="book-part">R Crash Course</li>
<li><a class="" href="rstudio-intro.html"><span class="header-section-number">2</span> Intro to R/Rstudio</a></li>
<li><a class="" href="data-vectors.html"><span class="header-section-number">3</span> Data Vectors</a></li>
<li><a class="" href="data-frames.html"><span class="header-section-number">4</span> Data Frames</a></li>
<li><a class="" href="data-exploration.html">Data Exploration</a></li>
<li><a class="" href="descriptive.html"><span class="header-section-number">5</span> Descriptive Statistics</a></li>
<li><a class="" href="data-visualization.html"><span class="header-section-number">6</span> Data Visualization</a></li>
<li><a class="" href="data-transformation.html">Data Transformation</a></li>
<li><a class="" href="intro-to-dplyr.html"><span class="header-section-number">7</span> Intro to dplyr</a></li>
<li><a class="" href="advanced-operations.html"><span class="header-section-number">8</span> Advanced Operations</a></li>
<li><a class="" href="data-modeling.html">Data Modeling</a></li>
<li><a class="" href="overview.html"><span class="header-section-number">9</span> Overview</a></li>
<li><a class="" href="intro-to-probability.html"><span class="header-section-number">10</span> Intro to Probability</a></li>
<li><a class="active" href="sampling-inference.html"><span class="header-section-number">11</span> Sampling &amp; Inference</a></li>
<li><a class="" href="inference-types.html">Inference Types</a></li>
<li><a class="" href="proportions.html"><span class="header-section-number">12</span> Proportions</a></li>
<li><a class="" href="means.html"><span class="header-section-number">13</span> Means</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">14</span> Regression</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="datasets.html"><span class="header-section-number">A</span> Datasets</a></li>
<li><a class="" href="cheat-sheets.html"><span class="header-section-number">B</span> Cheat Sheets</a></li>
<li><a class="" href="additional-resources.html"><span class="header-section-number">C</span> Additional Resources</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/bwu62/stat240-revamp">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><span style="display:none">
  \(
    \def\e{\operatorname{E}}
    \def\p{\operatorname{P}}
    \def\var{\operatorname{Var}}
    \def\sd{\operatorname{SD}}
    \def\bin{\operatorname{Bin}}
    \def\n{\operatorname{N}}
  \)
</span>
<div id="sampling-inference" class="section level1" number="11">
<h1>
<span class="header-section-number">11</span> Sampling &amp; Inference<a class="anchor" aria-label="anchor" href="#sampling-inference"><i class="fas fa-link"></i></a>
</h1>
<p>In the previous chapter, we introduced the basics of probability theory and discussed some basic random variable models. These form the basis of our inference techniques in the rest of the notes.</p>
<p>In this chapter we’ll discuss the concept of <strong>inference</strong>, where you use your observations in a sample to try to infer underlying facts about the broader population. In the process, we will make extensive use of our probability concepts and random variable models from the previous chapter.</p>
<div id="population-vs-sample-1" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Population vs sample<a class="anchor" aria-label="anchor" href="#population-vs-sample-1"><i class="fas fa-link"></i></a>
</h2>
<p>Recall the idea of population vs sample. Usually we imagine that the <strong>population has some fixed distribution with unknown but constant parameters</strong>. We draw some sample from the population and <strong>observe some sample statistics</strong>. Based on our sample as well as possibly some other <strong>reasonable assumptions we can make</strong>, we identify a potential model that can be applied to the population.</p>
<p>Once we have our sample and our intended model, there are two common methods of inference that we can pursue; they are conceptually related, but have subtle differences:</p>
<ul>
<li>We can run a <strong>hypothesis test</strong>, where we test models against the data to determine which explains the results better.</li>
<li>Or we can find <strong>confidence intervals</strong> for the underlying parameters of interest in the model, producing a range in which we are quite certain the true value lies.</li>
</ul>
<p>These methods are not mutually exclusive and you can certainly do both, but most problems only call for one method. We will discuss both shortly, but first let’s briefly discuss sampling distributions.</p>
</div>
<div id="sampling-distributions" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Sampling distributions<a class="anchor" aria-label="anchor" href="#sampling-distributions"><i class="fas fa-link"></i></a>
</h2>
<p>Why is inference even necessary in the first place? The main reason is this: <strong>samples are random</strong>! This may sound trivially obvious, but the implications are worth examining more closely.</p>
<div id="example-coin-flips" class="section level3" number="11.2.1">
<h3>
<span class="header-section-number">11.2.1</span> Example: Coin flips<a class="anchor" aria-label="anchor" href="#example-coin-flips"><i class="fas fa-link"></i></a>
</h3>
<p>Imagine we have a <strong>perfectly fair coin</strong>, i.e. Heads (H) and Tails (T) have the exact same probability (and you can’t land on the edge). Also assume you have good throwing technique and flip the coin a good many times in the air, so that past throws don’t affect subsequent throws, i.e. the <strong>throws are all mutually independent</strong>. This is of course an idealized model, but it usually turns out to be quite practical.</p>
</div>
<div id="heads-v.-n" class="section level3" number="11.2.2">
<h3>
<span class="header-section-number">11.2.2</span> # Heads v. <span class="math inline">\(n\)</span><a class="anchor" aria-label="anchor" href="#heads-v.-n"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose you flip the coin 10 times and define <span class="math inline">\(X\)</span> as the number of total heads. Note that we can model <span class="math inline">\(X\sim\bin(10,0.5)\)</span>. What is the probably of getting exactly 5? Or how about some other number? In fact we’ve already seen this exact distribution function last chapter:</p>
<div class="fold s">
<div class="sourceCode" id="cb918"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remember to import tidyverse (and optionally, update theme options)</span></span>
<span><span class="co"># also importing latex2exp to write math in plot annotations</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stefanom.io/latex2exp/">latex2exp</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">10</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.05</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>                     minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.01</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"Binomial(10, 0.5) PMF    [ $\\mu=(10)(0.5)=5$,  $\\sigma</span></span>
<span><span class="st">                   =\\sqrt{(10)(0.5)(1-0.5)}\\approx 1.58$ ]"</span><span class="op">)</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"k"</span>, y <span class="op">=</span> <span class="st">"probability"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-inference_files/figure-html/unnamed-chunk-1-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>You can see that even though 5 is more likely than any other outcome, there’s actually over 75% chance that you’d observe something else entirely.</p>
<p>Now suppose you keep going until you get to 100 flips, and again consider the total number of heads <span class="math inline">\(X\sim\bin(100,0.5)\)</span>. Here’s the distribution:</p>
<div class="fold s">
<div class="sourceCode" id="cb919"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">100</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.08</span>, <span class="fl">0.01</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.08</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"Binomial(100, 0.5) PMF    [ $\\mu=(100)(0.5)=50$,  $</span></span>
<span><span class="st">                   \\sigma=\\sqrt{(100)(0.5)(1-0.5)}=5$ ]"</span><span class="op">)</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"k"</span>, y <span class="op">=</span> <span class="st">"probability"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-inference_files/figure-html/unnamed-chunk-2-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>One thing is immediately apparent: even though the raw SD has increased from 1.58 to 5, the <strong>range of likely outcomes has narrowed compared to <span class="math inline">\(\Omega\)</span></strong>, i.e. compared to <span class="math inline">\(n\)</span>, you’re unlikely to deviate by as much when the total number of flips is higher. If we continue on to 1000 flips, this becomes even more evident:</p>
<div class="fold s">
<div class="sourceCode" id="cb920"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1000</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">1000</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">k</span>, y <span class="op">=</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"gray35"</span>, fill<span class="op">=</span><span class="st">"gray35"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span>, <span class="fl">100</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.025</span>, <span class="fl">0.005</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                       minor_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.025</span>, <span class="fl">0.001</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"Binomial(1000, 0.5) PMF    [ $\\mu=(1000)(0.5)=500$,  $</span></span>
<span><span class="st">                   \\sigma=\\sqrt{(1000)(0.5)(1-0.5)}\\approx 15.8$ ]"</span><span class="op">)</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"k"</span>, y <span class="op">=</span> <span class="st">"probability"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,</span>
<span>                                           plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">10</span>,<span class="fl">6</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-inference_files/figure-html/unnamed-chunk-3-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="heads-v.-n-1" class="section level3" number="11.2.3">
<h3>
<span class="header-section-number">11.2.3</span> % Heads v. <span class="math inline">\(n\)</span><a class="anchor" aria-label="anchor" href="#heads-v.-n-1"><i class="fas fa-link"></i></a>
</h3>
<p>We’ve just seen that as <span class="math inline">\(n\)</span> increases, the range of values for <span class="math inline">\(X\)</span> (number of heads) we are likely to observe <strong>narrows with respect to the total range</strong> of 0 to <span class="math inline">\(n\)</span>.</p>
<p>Let’s see this fact in a different way. Let’s <strong>actually simulate a sequence of 1000 flips</strong> according to this model, then make a plot showing the <strong>proportion of heads as we go along</strong> after each flip.</p>
<div class="fold s">
<div class="sourceCode" id="cb921"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use rbinom to explicitly generate 1000 individual flips</span></span>
<span><span class="co"># enframe wraps the vector in a data frame for ggplot</span></span>
<span><span class="co"># cumsum computes the cumulative sum, i.e. "how many heads so far"</span></span>
<span><span class="va">samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">samp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html">enframe</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"x"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Running proportion of heads vs n"</span>, y <span class="op">=</span> <span class="st">"proportion"</span>,</span>
<span>                     subtitle <span class="op">=</span> <span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"(blue dashed line shows theoretical $p=0.5$)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-inference_files/figure-html/unnamed-chunk-4-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>Let’s increase the sample size to <span class="math inline">\(n=10^{5}\)</span> and show <span class="math inline">\(n\)</span> on a logarithmic scale, which improves readability (generally whenever a column is <em>always positive</em> and <em>covers several orders of magnitude</em>, this can significantly help improve readability).</p>
<div class="fold s">
<div class="sourceCode" id="cb922"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extend experiment out to 1e5 flips</span></span>
<span><span class="co"># log.indices used to slice out indices evenly spaced on a log scale,</span></span>
<span><span class="co"># which significantly improves performance at no cost to visual fidelity</span></span>
<span><span class="co"># scales::comma suppresses scientific notation</span></span>
<span><span class="va">samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">samp</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1e5</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">log.indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,length.out<span class="op">=</span><span class="fl">1e3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">samp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html">enframe</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"x"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="va">n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="va">log.indices</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Running proportion of heads vs n"</span>, y <span class="op">=</span> <span class="st">"proportion"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"(blue dashed line shows theoretical $p=0.5$)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-inference_files/figure-html/unnamed-chunk-5-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>Let’s make a final addition to our plot and add 2 additional runs where the entire experiment is repeated, as well as 2 pairs of dashed gray curves showing the ±1 and ±2 SD for each <span class="math inline">\(n\)</span>.</p>
<div class="i96 fold s">
<div class="sourceCode" id="cb923"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1e5</span>, run1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span><span class="op">/</span><span class="va">n</span>,</span>
<span>            run2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1e5</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">n</span>,</span>
<span>            run3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1e5</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="va">log.indices</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"run"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"Run"</span>, values_to <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">x</span>, color <span class="op">=</span> <span class="va">Run</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="op">-</span><span class="fl">2</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span>, <span class="va">i</span><span class="op">)</span> <span class="fl">0.5</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">i</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                      args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>i <span class="op">=</span> <span class="va">i</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>                                      linetype <span class="op">=</span> <span class="st">"dashed"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Running proportion of heads vs n  (3 runs)"</span>, y <span class="op">=</span> <span class="st">"proportion"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"(dashed lines show theoretical $p=0.5$ and ±1, ±2 SD curves)"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="inline-figure"><img src="11-inference_files/figure-html/unnamed-chunk-6-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>Now we see a remarkable phenomenon: not only do the runs all converge to the true value of <span class="math inline">\(p=0.5\)</span>, but their rates of convergence all fall reasonably within an “envelope” that’s proportional to the SD-vs-n curves.</p>
</div>
<div id="law-of-large-numbers-lln" class="section level3" number="11.2.4">
<h3>
<span class="header-section-number">11.2.4</span> Law of large numbers (LLN)<a class="anchor" aria-label="anchor" href="#law-of-large-numbers-lln"><i class="fas fa-link"></i></a>
</h3>
<p>The previous plots show a simulated demonstration of what’s called the <a href="https://en.wikipedia.org/wiki/Law_of_large_numbers"><strong>law of large numbers</strong></a> (LLN), which essentially states that certain statistics are guaranteed to converge to their true values as you increase your sample size.</p>
<p>Specifically, the LLN guarantees for a sample of independently drawn observations, <strong>as <span class="math inline">\(n\to\infty\)</span>, any statistic computed as an <em>average</em> of some expression <em>will</em> converge to the true theoretical average value as long as it exists</strong> (i.e. has a well-defined, finite value). This is an oversimplification of course, but it serves our purposes. Note however there’s no statement of the rate of convergence, i.e. how fast it converges, merely that it’s inevitable.</p>
<p>Examples of some statistics that will converge under the LLN:</p>
<p><span class="math display">\[
\begin{align}
\text{(sample mean)}&amp;&amp;\bar{x}=\frac1n\sum_{i=1}^nx_i~~&amp;\longrightarrow~\mu=\e(X)&amp;&amp;\text{(expected value)}\\
\text{(sample variance)}&amp;&amp;s^2=\frac{\sum_{i=1}^n(x_i-\bar{x})^2}{n-1}~~&amp;\longrightarrow~\sigma^2=\e\big((X-\mu)^2\big)&amp;&amp;\text{(variance)}
\end{align}
\]</span></p>
<p>where <span class="math inline">\(x_i\)</span> are a sample of <a href="https://en.wikipedia.org/wiki/Independent_and_identically_distributed_random_variables"><strong>independent and identically distributed</strong> (iid)</a> observations drawn from a population represented by the random variable <span class="math inline">\(X\)</span>.</p>
<p>There are many other statistics that also converge (e.g. correlation, skew, etc…) but these two are the most important to us right now. Note the <strong>sample variance also converges to the true variance</strong>, since it can be thought of as the <strong>average squared distance</strong> from the mean if you factor out a <span class="math inline">\(\frac{n}{n-1}\)</span> correction factor term (as long the <span class="math inline">\(\sigma^2\)</span> exists).</p>
<p>Also note the proportion of heads we saw in the last example can be thought of as the <strong>average of a sample of 1s and 0s</strong> where 1 denotes H and 0 denotes T, so it also <strong>converges to the true probability of heads</strong> by LLN.</p>
<p>The LLN forms the basis of the inference topics which we are about to embark on.</p>
</div>
</div>
<div id="confidence-intervals-ci" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> Confidence intervals (CI)<a class="anchor" aria-label="anchor" href="#confidence-intervals-ci"><i class="fas fa-link"></i></a>
</h2>
<p>If you look again at the last plot from the coin flips example but in a different way, since each run stays within a fairly predictable margin of the true probability, for any given sample size we can use our sample proportion to find a range of reasonable values for the true probability. This is what we call a <strong>confidence interval</strong>.</p>
<p>A confidence interval usually has the following form:</p>
<p><span class="math display">\[
\text{$C\%$ confidence interval}~=~(\text{estimate})~\pm~(\text{crit. value})\cdot(\text{std. error})
\]</span></p>
<ul>
<li>
<strong><span class="math inline">\(C\)</span></strong> is the <strong>level of confidence</strong> desired. Most commonly, a 95%-level confidence is reported by convention, but this can be any number betweeo 0-100% (not inclusive).</li>
<li>
<strong>Estimate</strong> is your best guess of the true value based on your sample. For example, if you’re trying to estimate the probability of heads, you’d use the proportion of heads in your sample.</li>
<li>
<strong>Critical value</strong> is a multiplier that depends on <span class="math inline">\(C\)</span>, the level of confidence. If you want higher confidence, you must cover more values. For a standard 95% CI, this value is usually approximately 2.</li>
<li>
<strong>Standard error</strong> is what we call an estimate of the true SD using our sample. In out last plot, this would be an estimate of how far the inner gray lines are from the true probability <span class="math inline">\(p=0.5\)</span>.</li>
</ul>
<p>We’ll cover in detail how to compute each of the above quantities for different experiments in the next few chapters, but for now let’s do a quick visual example to help build more intuition.</p>
<div class="eg">
<p>Using the last plot, give an approximate 95% confidence interval for the true probability of heads <span class="math inline">\(p\)</span> based on just the first <span class="math inline">\(n=10\)</span> flips from the “run1” experiment.</p>
<p>Looking at a vertical slice along <span class="math inline">\(n=10\)</span>, we can see that “run1” had a sample proportion of 0.6, which implies 6 of the first 10 flips were heads. Thus, our sample estimate is 0.6.</p>
<p>We can also see at that point, the 1-SD-above line is at approximately 0.65, which is 0.15 away from the true value, implying the standard error would be close to 0.15.</p>
<p>Using the approximate critical value of 2, our 95% confidence interval for <span class="math inline">\(p\)</span> is <span class="math inline">\(0.6\pm2\cdot0.15=(0.3,0.9)\)</span>.</p>
<p>Put it a different way, based on the sample thus far (6/10 heads), we are <strong>95% confident the true probability of heads <span class="math inline">\(p\)</span> is between 30-90%</strong>.</p>
</div>
<p>Below is a plot of how the 95% CI updates as the run1 experiment progresses one flip at a time. You can see at any given point in time, we usually do cover the true probability of heads <span class="math inline">\(p=0.5\)</span>, as we expect to.</p>
<div class="fold s">
<div class="sourceCode" id="cb924"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute and plot 95% CI as experiment progresses</span></span>
<span><span class="co"># this will be covered in detail later, but SE is computed by sqrt(p*(1-p)/n)</span></span>
<span><span class="co"># where here p refers to the running sample proportion of % of heads out of n</span></span>
<span><span class="co"># pmin &amp; pmax are used to ensure the CI bounds for the true p don't exceed [0,1]</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1e5</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">samp</span><span class="op">)</span><span class="op">/</span><span class="va">n</span>, se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">/</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="va">log.indices</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n</span>, y <span class="op">=</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">se</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmin</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">se</span><span class="op">)</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"run1"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span>, expand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pretty_breaks.html">pretty_breaks</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"95% confidence interval for p vs n for run1"</span>, y <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-inference_files/figure-html/unnamed-chunk-7-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="interpretation-of-ci" class="section level3" number="11.3.1">
<h3>
<span class="header-section-number">11.3.1</span> Interpretation of CI<a class="anchor" aria-label="anchor" href="#interpretation-of-ci"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s briefly examine the interpretation of CIs more closely. What does it mean exactly when we say “95% confidence”?</p>
<p>Briefly, a 95% CI means if we repeat the exact same experiment over and over again, each time performing the exact same 95% CI calculation, on average we would expect about 95% of the reps to result in a CI that does in fact contain the true <span class="math inline">\(p=0.5\)</span>. The plot below shows a simulation of this fact.</p>
<div class="fold s">
<div class="sourceCode" id="cb925"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">=</span> <span class="fl">20</span> ; <span class="va">n</span> <span class="op">=</span> <span class="fl">10</span>  <span class="co"># number of repetitions / number of flips in each rep</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>flips <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">N</span><span class="op">*</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>       run <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>,each<span class="op">=</span><span class="va">n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_pad.html">str_pad</a></span><span class="op">(</span><span class="fl">2</span>,pad<span class="op">=</span><span class="st">"0"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"run"</span>,<span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">run</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>heads <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">flips</span><span class="op">)</span>, flips <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_flatten.html">str_flatten</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">flips</span>,<span class="st">"H"</span>,<span class="st">"T"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">heads</span><span class="op">/</span><span class="va">n</span>, se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">/</span><span class="va">n</span><span class="op">)</span>, ci1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmax</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">p</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">se</span><span class="op">)</span>, ci2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">pmin</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">p</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">se</span><span class="op">)</span>,</span>
<span>         capture <span class="op">=</span> <span class="va">ci1</span><span class="op">&lt;=</span><span class="fl">0.5</span> <span class="op">&amp;</span> <span class="fl">0.5</span><span class="op">&lt;=</span><span class="va">ci2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">run</span>,<span class="va">flips</span><span class="op">)</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">p</span>, xmin <span class="op">=</span> <span class="va">ci1</span>, xmax <span class="op">=</span> <span class="va">ci2</span>, color <span class="op">=</span> <span class="va">capture</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_pointrange</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"mono"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span>, title <span class="op">=</span> <span class="st">"Repeated 95% CIs for p vs true p=0.5"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="11-inference_files/figure-html/unnamed-chunk-9-1.svg" width="672" style="display: block; margin: auto;"></div>
</div>
<p>Remember that in a real-world example, you don’t know what the true probability of heads is, and you only have data from a single experiment, so you don’t know if your interval captures the true value or not, but you can be 95% confident that it does.</p>
</div>
</div>
<div id="hypothesis-testing" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> Hypothesis testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"><i class="fas fa-link"></i></a>
</h2>
<p>If instead of estimating a parameter, your primary goal is to test if a certain parameter value agrees with the data, then you probably want to perform a <strong>hypothesis test</strong>.</p>
<p>A hypothesis test usually starts with specifying a pair of <strong>competing hypotheses</strong> of the following form:</p>
<p><span class="math display">\[
\begin{align}
H_0&amp;:\text{parameter}~\theta=\theta_0\\
H_a&amp;:\text{parameter}~\theta\left.\begin{cases}&amp;&lt;\theta_0\\\text{one of}\!\!&amp;\neq\theta_0\\&amp;&gt;\theta_0\end{cases}\right\rbrace
\end{align}
\]</span></p>
<ul>
<li>
<span class="math inline">\(H_0\)</span> is called the <strong>null hypothesis</strong> and represents your starting assumption, i.e. we begin by assuming <span class="math inline">\(H_0\)</span> to be true with the goal of rejecting it if it differs too much from the data.</li>
<li>
<span class="math inline">\(H_a\)</span> is called the <strong>alternative hypothesis</strong> and is exactly what it sounds like: the alternative explanation we settle on if we reject the null.</li>
<li>
<span class="math inline">\(\theta\)</span> here simply represents some parameter of the underlying distribution, e.g. the <span class="math inline">\(p\)</span> in a binomial, or the <span class="math inline">\(\mu\)</span> in a normal.</li>
<li>
<span class="math inline">\(\theta_0\)</span> is the value of interest for parameter <span class="math inline">\(\theta\)</span> that you are testing against the data.</li>
</ul>
<p>The actual decision of whether to reject the null is made by computing a <strong>p-value</strong>, which is simply the <strong>probability of observing our dataset <em>if the null was actually true</em></strong>, i.e. the likeliness of the data under <span class="math inline">\(H_0\)</span>. If this probability is small enough, it means our null doesn’t fit the data, leading to its rejection. The threshold we use for our p-value (i.e. where we begin to reject the null) is called the <strong>significance level <span class="math inline">\(\alpha\)</span></strong> and is commonly set to 0.05 by convention.</p>
<p>In summary, here are the steps involved for a typical hypothesis test:</p>
<ol style="list-style-type: decimal">
<li>Specify <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_a\)</span>, and set your desired significance level <span class="math inline">\(\alpha\)</span>.</li>
<li>Assuming <span class="math inline">\(H_0\)</span> is true, find the likeliness of your data, i.e. the p-value.</li>
<li>If p-value <span class="math inline">\(&lt;\alpha\)</span>, reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_a\)</span>. Otherwise, stay with <span class="math inline">\(H_0\)</span>.</li>
<li>Interpret the results clearly in the context of the original problem.</li>
</ol>
<p>This probably all feels very new and nebulous, so let’s ground ourselves with a concrete example.</p>
<div class="eg">
<p>You suspect a given coin is weighted to come up heads more often than not. You decide to flip it 10 times and observe a total of 7 heads. At the common <span class="math inline">\(\alpha=0.05\)</span>, can you conclude the coin is biased?</p>
<p>Let <span class="math inline">\(p\)</span> represent the true underlying probability of heads for this coin. Then our null <span class="math inline">\(H_0:p=0.5\)</span> (i.e. the coin is fair), and our alternative <span class="math inline">\(H_a:p&gt;0.5\)</span> (i.e. the coin is biasing heads).</p>
<p>Next, we assume the null to be true and compute our p-value. Note that under the null assumption, we can model the number of heads <span class="math inline">\(X\sim\bin(10,p\!=\!0.5)\)</span>. For reasons which will be explained soon, our “likeliness of data” for the p-value is actually defined as <span class="math inline">\(\p(X\ge7)\)</span>. We can find this using <code><a href="https://rdrr.io/r/stats/Binomial.html">pbinom()</a></code>.</p>
<div class="sourceCode" id="cb926"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># recall pbinom gives ≤ the input, so for ≥7, we need:</span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">pbinom</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.171875</code></pre>
<div class="sourceCode" id="cb928"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># another way using dbinom instead:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">dbinom</a></span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.171875</code></pre>
<p>Thus, our p-value is about 0.17, which does not pass our threshold of <span class="math inline">\(\alpha=0.05\)</span>, so we do not reject the null. In other words, <strong>our data is not strong enough to conclude the coin is biased</strong> for heads.</p>
</div>
<p>The result of the previous example may seem surprising, but is simply a reflection of that fact that 7/10 heads is not that unusual even for a perfectly fair coin, so the <strong>data did not exceed our threshold of disbelief <span class="math inline">\(\alpha\)</span></strong>. If instead of 7 we had observed 9/10 heads, you can check we would’ve rejected <span class="math inline">\(H_0\)</span> and be able to conclude bias in the coin.</p>
<div class="note">
<p>The interpretations in the previous example are very carefully worded. In hypothesis testing, the mental model you should always have is <strong>does the data disagree strongly enough with the null to reject it or not</strong>. In particular, the following are some common pitfalls of hypothesis testing:</p>
<ul>
<li>The choice is always to <strong>reject or not reject</strong> the null, never “accept” the null.</li>
<li>If you reject the null, it does not mean the null is in fact false (you could have made an incorrect rejection).</li>
<li>Similarly if you do not reject the null, it does not mean the null is true (your inability to reject could also have been incorrect).</li>
<li>Failing to reject the null should be thought of as the evidence not rising to a high enough standard to prefer the alternative.</li>
<li>The <strong>p-value is a true probability</strong> and obeys all the usual laws of probability.</li>
</ul>
</div>
<div id="h_a-directions" class="section level3" number="11.4.1">
<h3>
<span class="header-section-number">11.4.1</span> <span class="math inline">\(H_a\)</span> directions<a class="anchor" aria-label="anchor" href="#h_a-directions"><i class="fas fa-link"></i></a>
</h3>
<p>Why did we compute the p-value earlier as <span class="math inline">\(\p(X\ge7)\)</span>? One way of thinking about it is the “likeliness” of our dataset here must be found by comparing it with all other possible outcomes for our dataset and ranking it again them. Our p-value of 0.17 earlier basically means it ranks in the top 17% of possible datasets when using total number of heads as a statistic.</p>
<p>Here’s a follow-up question then, why do we want to find here the “top percentage” value here by number of heads? The reason for this is that our alternative <span class="math inline">\(H_a:p&gt;0.5\)</span>. In order to disprove <span class="math inline">\(H_0\)</span> and support <span class="math inline">\(H_a\)</span>, our dataset must get more heads than we would expect vs fair. If instead our alternative hypothesis had been <span class="math inline">\(H_a:p&lt;0.5\)</span>, we would’ve instead computed <span class="math inline">\(\p(X\le7)\)</span>, which would have been a much larger value (i.e. much closer to 1 than 0).</p>
<p>What if instead of suspecting the coin to be biasing heads, we only suspected it was unfair but were unsure of the direction (i.e. it could bias heads or tails)? In this case, we’d set <span class="math inline">\(H_a:p\ne0.5\)</span>. As for our p-value, we need to compute <span class="math inline">\(\p(X\ge7)+\p(X\le3)\)</span>. The first term represents the “top percentage” comparing to other possible outcomes with even more heads, and the second term represents if the situation had been reversed and we instead had 7 tails and 3 heads and the “likeliness” under that scenario or the “bottom percentage” there comparing to other possible outcomes with even fewer heads.</p>
<p>That might seem strange, but it’ll make sense if we think about test results in a different way.</p>
</div>
<div id="rejection-regions" class="section level3" number="11.4.2">
<h3>
<span class="header-section-number">11.4.2</span> Rejection regions<a class="anchor" aria-label="anchor" href="#rejection-regions"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s change to a different example for a fresh perspective (and to aid some upcoming diagrams). Suppose we know a certain population is distributed normally as <span class="math inline">\(X\sim\n(\mu,1)\)</span>, in other words we know the standard deviation <span class="math inline">\(\sigma=1\)</span> but we don’t know the mean <span class="math inline">\(\mu\)</span>. We would like to draw a sample and use it to test at <span class="math inline">\(\alpha=0.05\)</span> the null <span class="math inline">\(H_0:\mu=0\)</span> vs one of the possible alternatives <span class="math inline">\(H_a:\mu&lt;,\ne,\text{or}&gt;0\)</span>. Note that under <span class="math inline">\(H_0\)</span>, <span class="math inline">\(X\)</span> is standard normal.</p>
<p>This time, instead of simulating or specifying an actual sample, let’s just broadly consider what possible samples would result in which conclusions under each alternative.</p>
<ol style="list-style-type: decimal">
<li>
<p>If <span class="math inline">\(H_a:\mu&gt;0\)</span>, then in order to reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_a\)</span>, our sample would need to have a sample mean <span class="math inline">\(\bar{x}\)</span> so high that it lands in the top <span class="math inline">\(\alpha\)</span>, or top 5% of all possible datasets. If it does, we’d have p-value <span class="math inline">\(&lt;\alpha\)</span> and we’d reject <span class="math inline">\(H_0\)</span>. This forms the <strong>right-side one-tailed rejection region</strong>:</p>
<div class="fold s">
<div class="sourceCode" id="cb930"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">dnorm</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">dnorm</span>, geom<span class="op">=</span><span class="st">"area"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">.95</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span>, fill<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">:</span><span class="fl">4</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">.95</span><span class="op">)</span><span class="op">)</span>, labels<span class="op">=</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/base/formatc.html">prettyNum</a></span><span class="op">(</span><span class="va">x</span>,digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, expand<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"sample mean"</span>, y<span class="op">=</span><span class="st">"density"</span>,</span>
<span>    title<span class="op">=</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$H_a\\,:\\,\\mu&gt;0$ one-sided rejection region ($\\alpha=0.05$)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="11-inference_files/figure-html/unnamed-chunk-11-1.svg" width="672" style="display: block; margin: auto;">
</div>
</li>
<li>
<p>If <span class="math inline">\(H_a:\mu&lt;0\)</span>, then conversely in order to reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_a\)</span>, our sample would need to have a sample mean <span class="math inline">\(\bar{x}\)</span> so low that it lands in the bottom <span class="math inline">\(\alpha\)</span>, or bottom 5% of all possible datasets. If it does, we’d again have p-value <span class="math inline">\(&lt;\alpha\)</span> and we’d reject <span class="math inline">\(H_0\)</span>. This forms the <strong>left-side one-tailed rejection region</strong>:</p>
<div class="fold s">
<div class="sourceCode" id="cb931"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">dnorm</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">dnorm</span>, geom<span class="op">=</span><span class="st">"area"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">.05</span><span class="op">)</span><span class="op">)</span>, fill<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">:</span><span class="fl">4</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">.05</span><span class="op">)</span><span class="op">)</span>, labels<span class="op">=</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/base/formatc.html">prettyNum</a></span><span class="op">(</span><span class="va">x</span>,digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, expand<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"sample mean"</span>, y<span class="op">=</span><span class="st">"density"</span>,</span>
<span>    title<span class="op">=</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$H_a\\,:\\,\\mu&lt;0$ one-sided rejection region ($\\alpha=0.05$)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="11-inference_files/figure-html/unnamed-chunk-12-1.svg" width="672" style="display: block; margin: auto;">
</div>
</li>
<li>
<p>Finally, if <span class="math inline">\(H_a:\mu\ne0\)</span>, then a <strong>sample mean <span class="math inline">\(\bar{x}\)</span> either too high OR too low</strong> should result in rejecting <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_a\)</span>. Here, we’d need our rejection region to cover together the <span class="math inline">\(\alpha\)</span> or 5% <strong>most extreme possible datasets on either side</strong>. In other words, we want both the <span class="math inline">\(\alpha/2\)</span> or 2.5% top AND bottom corners. This forms the <strong>two-sided rejection region</strong>:</p>
<div class="fold s">
<div class="sourceCode" id="cb932"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">dnorm</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">dnorm</span>, geom<span class="op">=</span><span class="st">"area"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">.025</span><span class="op">)</span><span class="op">)</span>, fill<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function</a></span><span class="op">(</span>fun<span class="op">=</span><span class="va">dnorm</span>, geom<span class="op">=</span><span class="st">"area"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">.975</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span>, fill<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">:</span><span class="op">-</span><span class="fl">3</span>,<span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.025</span>,<span class="fl">.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, labels<span class="op">=</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/base/formatc.html">prettyNum</a></span><span class="op">(</span><span class="va">x</span>,digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, expand<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"sample mean"</span>, y<span class="op">=</span><span class="st">"density"</span>,</span>
<span>    title<span class="op">=</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$H_a\\,:\\,\\mu{\\ne}0$ two-sided rejection region ($\\alpha=0.05$)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<img src="11-inference_files/figure-html/unnamed-chunk-13-1.svg" width="672" style="display: block; margin: auto;">
</div>
</li>
</ol>
<p>Thus, in order to properly compute the p-value of a given sample, we need to evalute different “tail” areas depending on our <span class="math inline">\(H_a\)</span>. Suppose your parameter is <span class="math inline">\(\theta\)</span>, your hypothesized value under the null is <span class="math inline">\(\theta_0\)</span>, and your sample observed statistic is <span class="math inline">\(\theta_s\)</span>. Then:</p>
<ul>
<li>
<p>For one-sided hypotheses, simply take the corresponding “tail” area on that side,</p>
<ul>
<li><p>So if <span class="math inline">\(H_a:\theta&gt;\theta_0\)</span>, take the upper tail area, or <span class="math inline">\(\p(\theta\ge\theta_s)\)</span>,</p></li>
<li><p>Or if <span class="math inline">\(H_a:\theta&lt;\theta_0\)</span>, take the lower tail area, or <span class="math inline">\(\p(\theta\le\theta_s)\)</span>,</p></li>
</ul>
</li>
<li>
<p>For a two-sided hypothesis, take <em>both outer</em> “tails” on either side of the distribution beyond your statistic,</p>
<ul>
<li><p>So if <span class="math inline">\(H_a:\theta\ne\theta_0\)</span>, take <span class="math inline">\(\p(\theta\le\theta_{s\text{-lower}})+\p(\theta\ge\theta_{s\text{-upper}})\)</span> where <span class="math inline">\(\theta_{s\text{-lower}},\theta_{s\text{-upper}}\)</span> are the two opposite-tailed lower and upper statistics for your sample.</p></li>
<li><p>If the distribution under the null (which is what we’ve been plotting each time) is symmetric, you can just find one side and multiply it by 2 to get both sides.</p></li>
<li><p>Furthermore, if the distribution is not only symmetric but also centered around 0 (as in the example above), the two-sided p-value expression is often written <span class="math inline">\(\p(|\theta|\!\ge\!|\theta_s|)\)</span>.</p></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/@xiee/utils/js/external-link.min.js" defer></script><script>
  $(function(){
    $(".note").addClass("alert alert-warning");
  });
  $(function(){
    $(".tip").addClass("alert alert-success");
  });
  $(function(){
    $(".def").addClass("alert alert-info");
  });
  $(function(){
    $(".eg").addClass("alert alert-secondary");
  });
  $(function(){
    $(".col-lg-3").addClass("col-lg-2").removeClass("col-lg-3");
  });
  $(function(){
    $(".col-lg-7").addClass("col-lg-8").removeClass("col-lg-7");
  });
</script><!-- https://stackoverflow.com/a/37839683/25278020 --><script>
  $(document).ready(function() {

  $chunks = $('.fold');

  $chunks.each(function () {

    // add button to source code chunks
    if ( $(this).hasClass('s') ) {
      $('pre.r', this).prepend("<div class=\"showopt\">Show Source</div><br style=\"line-height:22px;\"/>");
      $('pre.r', this).children('code').attr('class', 'folded');
    }

    // add button to output chunks
    if ( $(this).hasClass('o') ) {
      $('pre:not(.r)', this).has('code').prepend("<div class=\"showopt\">Show Output</div><br style=\"line-height:22px;\"/>");
      $('pre:not(.r)', this).children('code:not(r)').addClass('folded');

      // add button to plots
      $(this).find('img').wrap('<pre class=\"plot\"></pre>');
      $('pre.plot', this).prepend("<div class=\"showopt\">Show Plot</div><br style=\"line-height:22px;\"/>");
      $('pre.plot', this).children('img').addClass('folded');

    }
  });

  // hide all chunks when document is loaded
  $('.folded').css('display', 'none')

  // function to toggle the visibility
  $('.showopt').click(function() {
    var label = $(this).html();
    if (label.indexOf("Show") >= 0) {
      $(this).html(label.replace("Show", "Hide"));
    } else {
      $(this).html(label.replace("Hide", "Show"));
    }
    $(this).siblings('code, img').slideToggle('fast', 'swing');
  });
});

</script><!-- https://www.tutorialrepublic.com/faq/how-to-change-href-attribute-of-a-hyperlink-using-jquery.php--><script>
  $(document).ready(function(){
    $("a.anchorjs-link").each(function(){
      var oldUrl = $(this).attr("href"); // Get current url
      var newUrl = oldUrl.replace(/^#(\d+-)+/,"#"); // Create new url
      $(this).attr("href", "#" + $(this).closest("div").attr("id"));  // Set href value
      $(this).attr("title", location.protocol + "//" + location.host + location.pathname + $(this).attr("href")); // Set title value
    });
  });
</script><!-- https://stackoverflow.com/a/10415599/25278020 --><script>
  var observer = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
        if (mutation.addedNodes && mutation.addedNodes.length > 0) {
            // element added to DOM
            var hasClass = [].some.call(mutation.addedNodes, function(el) {
                return el.classList.contains('bs-popover-top')
            });
            if (hasClass) {
              $("div.bs-popover-top a").each(function(){
                $(this).attr("target", "_blank");
              });
          }
        }
    });
});

var config = {
    attributes: true,
    childList: true,
    characterData: true
};

observer.observe(document.body, config);
</script><!--https://stackoverflow.com/a/49025957--><script>
  $(function() {
  $('a[class="footnote-ref"][data-toggle="popover"]').popover()
})

$('body')
  .on('mousedown', '.popover', function(e) {
    console.log("clicked inside popover")
    e.preventDefault()
  });
</script><div class="chapter-nav">
<div class="prev"><a href="intro-to-probability.html"><span class="header-section-number">10</span> Intro to Probability</a></div>
<div class="next"><a href="inference-types.html">Inference Types</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#sampling-inference"><span class="header-section-number">11</span> Sampling &amp; Inference</a></li>
<li><a class="nav-link" href="#population-vs-sample-1"><span class="header-section-number">11.1</span> Population vs sample</a></li>
<li>
<a class="nav-link" href="#sampling-distributions"><span class="header-section-number">11.2</span> Sampling distributions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#example-coin-flips"><span class="header-section-number">11.2.1</span> Example: Coin flips</a></li>
<li><a class="nav-link" href="#heads-v.-n"><span class="header-section-number">11.2.2</span> # Heads v. \(n\)</a></li>
<li><a class="nav-link" href="#heads-v.-n-1"><span class="header-section-number">11.2.3</span> % Heads v. \(n\)</a></li>
<li><a class="nav-link" href="#law-of-large-numbers-lln"><span class="header-section-number">11.2.4</span> Law of large numbers (LLN)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#confidence-intervals-ci"><span class="header-section-number">11.3</span> Confidence intervals (CI)</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#interpretation-of-ci"><span class="header-section-number">11.3.1</span> Interpretation of CI</a></li></ul>
</li>
<li>
<a class="nav-link" href="#hypothesis-testing"><span class="header-section-number">11.4</span> Hypothesis testing</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#h_a-directions"><span class="header-section-number">11.4.1</span> \(H_a\) directions</a></li>
<li><a class="nav-link" href="#rejection-regions"><span class="header-section-number">11.4.2</span> Rejection regions</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/bwu62/stat240-revamp/blob/master/11-inference.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/bwu62/stat240-revamp/edit/master/11-inference.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>STAT 240 Revamp</strong>" was written by Bi Cheng Wu, with help from Bret Larget and Cameron Jones. It was last built on 2025-10-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
